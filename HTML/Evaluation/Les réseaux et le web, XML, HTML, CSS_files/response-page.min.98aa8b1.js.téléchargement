!function(t){function e(e){for(var r,s,u=e[0],a=e[1],f=e[2],l=e[3]||[],h=0,m=[];h<u.length;h++)s=u[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&m.push(i[s][0]),i[s]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r]);for(d&&d(e),c.push.apply(c,l);m.length;)m.shift()();return o.push.apply(o,f||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,u=1;u<n.length;u++){var f=n[u];0!==i[f]&&(r=!1)}r&&(o.splice(e--,1),t=a(a.s=n[0]))}return 0===o.length&&(c.forEach((function(t){if(void 0===i[t]){i[t]=null;var e=document.createElement("link");a.nc&&e.setAttribute("nonce",a.nc),e.rel="prefetch",e.as="script",e.href=s(t),document.head.appendChild(e)}})),c.length=0),t}var r={},i={8:0},o=[],c=[];function s(t){return a.p+"response-page.chunk."+({1:"ir",2:"math",3:"multilingual",4:"phishing",5:"postsubmit",6:"question.datetime",7:"quiz",9:"shareform"}[t]||t)+"."+{1:"5c8e7fd",2:"04e93fb",3:"66a4351",4:"fb454f1",5:"2e2894c",6:"5031f46",7:"028ee91",9:"f2b2bc4"}[t]+".js"}if("function"==typeof s){var u=s;s=function(){try{if("function"!=typeof replaceChunkSrc)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");var t=replaceChunkSrc(u.apply(this,arguments));if(!t||"string"!=typeof t)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' does not return string. See https://github.com/agoldis/webpack-require-from#troubleshooting");return t}catch(t){return console.error(t),u.apply(this,arguments)}}}function a(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise((function(e,r){n=i[t]=[e,r]}));e.push(n[2]=r);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,a.nc&&c.setAttribute("nonce",a.nc),c.src=s(t);var u=new Error;o=function(e){c.onerror=c.onload=null,clearTimeout(f);var n=i[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",u.name="ChunkLoadError",u.type=r,u.request=o,n[1](u)}i[t]=void 0}};var f=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(e)},a.m=t,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a.oe=function(t){throw console.error(t),t},Object.defineProperty(a,"p",{get:function(){try{if("function"!=typeof setPublicPath)throw new Error("WebpackRequireFrom: 'setPublicPath' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return setPublicPath()}catch(t){return console.error(t),""}}});var f=window.webpackJsonp=window.webpackJsonp||[],l=f.push.bind(f);f.push=e,f=f.slice();for(var h=0;h<f.length;h++)e(f[h]);var d=l,m=(o.push([141,0]),n());e([[],{},0,[5,7]])}([function(t,e){t.exports=React},,function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"f",(function(){return a}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function c(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){return new(n||(n=Promise))((function(i,o){function c(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(c,s)}u((r=r.apply(t,e||[])).next())}))}function u(t,e){var n,r,i,o,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){c.label=o[1];break}if(6===o[0]&&c.label<i[1]){c.label=i[1],i=o;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(o);break}i[2]&&c.ops.pop(),c.trys.pop();continue}o=e.call(t,c)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],c=0,s=o.length;c<s;c++,i++)r[i]=o[c];return r}},function(t,e){t.exports=_},,function(t,e,n){"use strict";function r(){return window.OfficeFormServerInfo}function i(t){window.OfficeFormServerInfo=t}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"d",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return d}));var r,i,o=n(17),c=n(9),s=n(5),u=n(46),a={};function f(){return i}function l(t){i=t}function h(){return r||(r=$.Deferred(),Object(c.b)("MobilePrefetchResourceStrings")&&Object(s.a)().resourceStrings?(Object(o.a)({eventName:"MobilePrefetchResourceStrings",eventType:"engagement_event"}),i=Object(s.a)().resourceStrings,r.resolve(Object(s.a)().resourceStrings)):i?r.resolve(i):Object(u.b)((function(t){i=t,r.resolve(t)}),(function(t){return r.reject(t)}))),r.promise()}function d(t){var e=a[t];if(!e){var n=$.Deferred();e=n.promise(),a[t]=e,Object(u.a)(t,(function(t){return n.resolve(t)}),(function(t){h().done((function(t){return n.resolve(t)}))}))}return e}},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"a",(function(){return s}));n(8),n(9),n(5);function r(t,e){return t()}function i(t){return t()}function o(){}function c(){throw new Error("unreachable code")}FormsPro.initializeStyleBasis=o;var s={}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"h",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"f",(function(){return s})),n.d(e,"g",(function(){return a})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return l})),n.d(e,"c",(function(){return h}));var r=n(3);function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.map((function(t){return t&&t.trim()})).filter((function(t){return!!t})).join(" ");return n||t.some((function(t){return""===t}))||(n=void 0),n}function o(t,e,n,r,i){r=r||0,n=n||0;var o=e.height(),c=t.outerHeight();if(t.offset()&&e.offset()){var s=t.offset().top-e.offset().top;if(s<0)e.scrollTop(e.scrollTop()+s-(c+n>o?0:n));else{var u=Math.min(c,o),a=s+u-o;c+n+r<o?a=s+(u=c+r)-o:c+n<o&&(u=c+n,a=s-n),a>0&&(i?e.animate({scrollTop:e.scrollTop()+a},"fast"):e.scrollTop(e.scrollTop()+a))}}}function c(t,e){void 0===e&&(e=!0);var n=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");return e&&(n=n.replace(/'/g,"&apos;")),n}function s(t,e){var n=r.extend({},t);for(var o in e)switch(o){case"className":case"aria-labelledby":case"aria-describedby":n[o]=i(n[o],e[o]);break;case"children":case"defaultValue":case"value":e.hasOwnProperty(o)&&(null!=n[o]?n[o]=[].concat(n[o],e[o]):n[o]=e[o]);break;case"style":null!=n[o]?r.extend(n[o],e[o]):n[o]=e[o];break;case"onCopy":case"onCut":case"onPaste":case"onCompositionEnd":case"onCompositionStart":case"onCompositionUpdate":case"onFocus":case"onBlur":case"onChange":case"onInput":case"onSubmit":case"onLoad":case"onError":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onAbort":case"onCanPlay":case"onCanPlayThrough":case"onDurationChange":case"onEmptied":case"onEncrypted":case"onEnded":case"onLoadedData":case"onLoadedMetadata":case"onLoadStart":case"onPause":case"onPlay":case"onPlaying":case"onProgress":case"onRateChange":case"onSeeked":case"onSeeking":case"onStalled":case"onSuspend":case"onTimeUpdate":case"onVolumeChange":case"onWaiting":case"onClick":case"onContextMenu":case"onDoubleClick":case"onDrag":case"onDragEnd":case"onDragEnter":case"onDragExit":case"onDragLeave":case"onDragOver":case"onDragStart":case"onDrop":case"onMouseDown":case"onMouseEnter":case"onMouseLeave":case"onMouseMove":case"onMouseOut":case"onMouseOver":case"onMouseUp":case"onSelect":case"onTouchCancel":case"onTouchEnd":case"onTouchMove":case"onTouchStart":case"onScroll":case"onWheel":n[o]=u(n[o],e[o]);break;default:void 0!==e[o]&&(n[o]=e[o])}return n}function u(t,e){return function(n){t&&t(n),e&&e(n)}}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(n){(0===e.length||e.indexOf(n.keyCode)>=0)&&t(n)}}function f(t){var e=t.nativeEvent.explicitOriginalTarget;return t.relatedTarget||e||document.activeElement}function l(){return window.innerWidth}function h(t,e){if(t&&e)return t[e]||t[e.toLowerCase()]||void 0}},function(t,e,n){"use strict";n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return f}));var r,i=n(14),o=n(25),c=n(5);function s(t){r=t}function u(){return r===i.a.ResponseTimeForm&&f("IncrementalLoadForms")}function a(){return r===i.a.ResponseTimeForm&&!Object(c.a)().useDebugVersionScript&&f("DelayLoadThirdPartyJs")}function f(t){return Object(o.a)().Flighting.isEnabled(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"e",(function(){return f})),n.d(e,"m",(function(){return l})),n.d(e,"n",(function(){return h})),n.d(e,"o",(function(){return d})),n.d(e,"b",(function(){return m})),n.d(e,"t",(function(){return b})),n.d(e,"h",(function(){return v})),n.d(e,"g",(function(){return g})),n.d(e,"k",(function(){return p})),n.d(e,"l",(function(){return O})),n.d(e,"r",(function(){return j})),n.d(e,"i",(function(){return w})),n.d(e,"q",(function(){return S})),n.d(e,"f",(function(){return I})),n.d(e,"s",(function(){return F})),n.d(e,"j",(function(){return y})),n.d(e,"u",(function(){return N})),n.d(e,"c",(function(){return k})),n.d(e,"d",(function(){return T})),n.d(e,"p",(function(){return C}));var r=n(3),i=n(29),o=n(11),c=n(5),s=n(8),u=n(15);function a(t,e){if(!t&&!Object(o.s)()&&!Object(o.r)()){var n=(new Error).stack;console.assert(t,e,n)}}function f(){return r.omit(Object(u.c)(),"embed","oembedsso","themecolor","preview")}function l(){return!!Object(u.c)().embed}function h(){return Object(c.a)().isOembedSPO}function d(){return!!Object(u.c)().oembedsso&&!!Object(u.c)().preview}function m(){return!(!Object(i.h)()&&!function(){if(Object(i.l)()&&Object(o.s)()&&"Analyze"!==Object(o.n)())return!0;return!1}())}function b(){return-1!==navigator.userAgent.toLowerCase().search("windows nt 10.")}function v(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("msie")||-1!==t.indexOf("trident/")}function g(){return-1!==navigator.userAgent.toLowerCase().indexOf("edge/")}function p(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))}function O(){return p()&&Object(s.e)()<=640}function j(){return $(window).width()<=768}function w(){return/ip(hone|od|ad)/.test(navigator.userAgent.toLowerCase())&&!window.MSStream}function S(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("mac os x")&&-1!==t.indexOf("version/9")&&-1!==t.indexOf("safari")}function I(){return!!navigator.userAgent.match(/android/i)}function F(){return-1!==navigator.userAgent.toLowerCase().indexOf("tbs/")}function y(){return-1!==navigator.userAgent.toLowerCase().indexOf("micromessenger/")}function N(t){try{return JSON.parse(t)}catch(e){return t}}function k(t){return r.keys(t).filter($.isNumeric).map((function(e){return t[e]}))}function T(t){t+="=";var e=document.cookie.split(";").filter((function(e){return e.indexOf(t)>=0}));if(e.length>0){var n=e[0].trim();return n.substring(t.length,n.length)}return null}function C(){return document&&document.body&&"rtl"===document.body.getAttribute("dir")}},function(t,e,n){"use strict";var r,i=n(5),o={};!function(t){t[t.ApiFacadeEndPoint=0]="ApiFacadeEndPoint",t[t.FormsProUIHost=1]="FormsProUIHost",t[t.FormsHomeUrl=2]="FormsHomeUrl",t[t.FormsSingleSignOnHomeUrl=3]="FormsSingleSignOnHomeUrl",t[t.FormsProCdnHomeUrl=4]="FormsProCdnHomeUrl",t[t.PreviewSettingsDefaultDate=5]="PreviewSettingsDefaultDate",t[t.FormsProGeo=6]="FormsProGeo",t[t.FormsProLicensingServiceEndPoint=7]="FormsProLicensingServiceEndPoint",t[t.FormsProSampleFormTenantId=8]="FormsProSampleFormTenantId",t[t.FormsProMSRewardsAvailableCountryCodes=9]="FormsProMSRewardsAvailableCountryCodes",t[t.FormsProCSATEndpoint=10]="FormsProCSATEndpoint",t[t.FormsProCSATTenant=11]="FormsProCSATTenant",t[t.FormsProResponseLimit=12]="FormsProResponseLimit",t[t.UIFacadeEndPoint=13]="UIFacadeEndPoint",t[t.ChatDistributionEndpoint=14]="ChatDistributionEndpoint"}(r||(r={})),o[r.ApiFacadeEndPoint]="https://mfpapifacadefaint.azurewebsites.net/",o[r.UIFacadeEndPoint]="https://mfpuifacadeint.projectsshimlaint.com/",o[r.FormsProUIHost]="https://mfpuiwebappint.azurewebsites.net",o[r.FormsHomeUrl]="https://forms.office-int.com",o[r.FormsSingleSignOnHomeUrl]="https://forms.office-int.com/formspro",o[r.FormsProCdnHomeUrl]="https://mfpembedcdnint.azureedge.net/mfpembedcontint/",o[r.PreviewSettingsDefaultDate]="2019-02-08",o[r.FormsProGeo]="INT",o[r.FormsProLicensingServiceEndPoint]="https://mfplicensingservicefaint.azurewebsites.net/",o[r.FormsProSampleFormTenantId]="558a6a52-809d-4de8-8b01-01a51502c93f",o[r.FormsProMSRewardsAvailableCountryCodes]="US",o[r.FormsProCSATEndpoint]="https://nps-int.onyx.azure.net",o[r.FormsProCSATTenant]="azureportal",o[r.FormsProResponseLimit]="50000",o[r.ChatDistributionEndpoint]="https://mfpuifacadeint.projectsshimlaint.com/";var c=function(){function t(){}t.prototype;return t.getSetting=function(e){var n=t.webSettingsMap[r[e].toString()];if(!n){var i=o[e];n=i||t.defaultValue}return n},t.webSettingsJson=decodeURI(Object(i.a)().webSettings||"{}"),t.webSettingsMap=JSON.parse(t.webSettingsJson),t.defaultValue="",t}();FormsPro.WebSettings=c,FormsPro.WebSettingKeys=r;var s=n(7),u=n(42),a=n(15);n.d(e,"d",(function(){return l})),n.d(e,"u",(function(){return h})),n.d(e,"m",(function(){return m})),n.d(e,"n",(function(){return b})),n.d(e,"r",(function(){return v})),n.d(e,"s",(function(){return g})),n.d(e,"t",(function(){return p})),n.d(e,"x",(function(){return O})),n.d(e,"w",(function(){return j})),n.d(e,"v",(function(){return w})),n.d(e,"q",(function(){return S})),n.d(e,"p",(function(){return I})),n.d(e,"b",(function(){return F})),n.d(e,"j",(function(){return y})),n.d(e,"h",(function(){return N})),n.d(e,"a",(function(){return k})),n.d(e,"i",(function(){return T})),n.d(e,"c",(function(){return C})),n.d(e,"l",(function(){return P})),n.d(e,"k",(function(){return x})),n.d(e,"g",(function(){return M})),n.d(e,"f",(function(){return L})),n.d(e,"e",(function(){return D})),n.d(e,"o",(function(){return R}));var f;function l(){if(null==f){var t=A(),e=Object(i.a)().deployment.toLocaleLowerCase();e.indexOf("usgovdodproduction")>=0?f="USDoDProd":e.indexOf("usgovproduction")>=0?f="USGovProd":e.indexOf("usgovgccproduction")>=0?f="USGovGccProd":(t.indexOf("forms.office.com")>=0||t.indexOf("forms.osi.office.net")>=0)&&-1==t.indexOf("tip.forms.office.com")?f="WWProd":t.indexOf("forms.microsoft.com")>=0?f="MSProd":t.indexOf("forms.office-int.com")>=0||t.indexOf("forms.osi.office-int.net")>=0?f="Int":t.indexOf("formweekly")>=0?f="Weekly":t.indexOf("formhotfix")>=0?f="Hotfix":t.indexOf("formdaily")>=0?f="Daily":t.indexOf("formpilot")>=0?f="Pilot":t.indexOf("formtrial")>=0?f="Trial":t.indexOf("formdrill")>=0?f="Drill":t.indexOf("localhost")>=0?f="DevHost":t.indexOf("forms.microsoft-int.com")>=0?f="MSInt":t.indexOf("formspro-test-staging")>=0?f="ProDaily":t.indexOf("tip.forms.office.com")>=0&&(f="ProTip")}return f}function h(){var t=A();return t.indexOf("sea-000.forms.osi.office.net")>=0||t.indexOf("tip.forms.office.com")>=0}function d(){return!!window.location.pathname.toLocaleLowerCase().startsWith("/formspro")}function m(){switch(l()){case"WWProd":return"https://c.office.com";case"MSProd":return"https://c1.microsoft.com";case"Int":return"https://c.office-int.com";case"MSInt":default:return null}}function b(){var t=window.location.pathname.toLowerCase();switch(d()&&(t=t.substring("/formspro".length)),t){case"/pages/designpage.aspx":case"/pages/teamsdesignpage.aspx":case"/pages/onenoteaddinpage.aspx":case"/pages/delegatepage.aspx":return"Design";case"/pages/responsepage.aspx":case"/pages/teamsresponsepage.aspx":return"Response";case"/pages/analysispage.aspx":return"Analyze";case"/pages/teamsconfigpage.aspx":return"TeamsConfig";case"/pages/shareformpage.aspx":return"ShareForm";case"/adminsettings.aspx":return"AdminSettings";case"/pages/responsepreviewpage.aspx":return"ResponsePreviewPage";case"/pages/adminphishingreviewpage.aspx":return"AdminPhishingReviewPage";default:return"Unknown"}}function v(){return A().indexOf(".forms.osi.office.net")>0}function g(){var t=l();return"WWProd"===t||"MSProd"===t||"USGovProd"===t||"USDoDProd"===t||"USGovGccProd"===t}function p(){var t=l();return"USGovProd"===t||"USDoDProd"===t||"USGovGccProd"===t}function O(){return"USGovGccProd"===l()}function j(){return"USGovProd"===l()}function w(){return"USDoDProd"===l()}function S(){switch(l()){case"Int":case"WWProd":case"MSInt":case"MSProd":case"USGovProd":case"USDoDProd":case"USGovGccProd":case"ProTip":return!0;default:return!1}}function I(){switch(window.location.pathname.toLowerCase()){case"/pages/mobiledesignpage.aspx":return!0;default:return!1}}function F(){var t=Object(u.c)();return g()?t?"https://login.windows.net/":"https://login.microsoftonline.com/":"https://login.windows-ppe.net/"}function y(){return Object(s.c)((function(){return"USGovProd"===(t=l())||"USDoDProd"===t?"https://graph.microsoft.us/v1.0":function(){var t=l();return"WWProd"==t||"MSProd"==t}()||O()?"https://graph.microsoft.com/v1.0":"https://graph.microsoft-ppe.com/v1.0";var t}),s.e)}function N(){return c.getSetting(FormsPro.WebSettingKeys.ApiFacadeEndPoint)}function k(){return"USGovProd"===l()||"USDoDProd"===l()?"032e56fd-dfe5-4a50-8017-89692bcbcb0e":"038ed4f5-da78-47bc-8176-9153c79e0edb"}function T(){return"USGovProd"===l()||"USDoDProd"===l()?"153a74ba-783f-4394-bc9a-a109ef69f5c2":"c9a559d2-7aab-4f13-a6ed-e7e9c52aec87"}function C(t){return"lists."+E(t)}function P(){switch(l()){case"WWProd":case"MSProd":return"72f988bf-86f1-41af-91ab-2d7cd011db47";default:return"f686d426-8d16-42db-81b7-ab578e110ccd"}}function x(){switch(l()){case"WWProd":case"MSProd":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}}function M(){switch(l()){case"WWProd":case"MSProd":return["89d8a01e-e5db-493e-8720-b820d953ef20","b6338c92-533e-4f6d-a327-994263712399"];default:return["f686d426-8d16-42db-81b7-ab578e110ccd"]}}function L(){return Object(a.c)().lang||null}function D(){return"Int"}function R(){return A().indexOf("forms.microsoft")>=0}function E(t,e){switch(void 0===e&&(e=!1),null==t&&(t=l()),t){case"USDoDProd":return e?"apps.mil":"osi.apps.mil";case"USGovProd":return e?"office365.us":"osi.office365.us";case"USGovGccProd":return e?"office.com":"gcc.osi.office365.us";case"WWProd":case"MSProd":case"ProTip":return"office.com";case"Trial":return"officeppe.com";default:return"office-int.com"}}function A(){return window.location.host.toLocaleLowerCase()}},function(t,e,n){"use strict";var r,i=n(2),o=n(3),c=n(4),s=n(1),u=n(9),a=n(5),f=n(45),l=n(21),h=n(10),d=(n(7),n(22)),m=n(19),b=n(11);!function(t){t[t.Normal=0]="Normal",t[t.SoftDeleted=1]="SoftDeleted"}(r||(r={}));var v=n(14),g=n(23),p=function(){function t(t,e){if(this.O=t,this.I=Object(g.b)(t),this.I){var n=this.I.getDesignForm;switch(this.O.SyncContext){case v.a.SharedTimeForm:n=this.I.getSharedForm;break;case v.a.ResponseTimeForm:n=this.I.getRuntimeForm;break;case v.a.AnalysisTimeForm:n=this.I.getAnalysisTimeForm;break;case v.a.ResponseDetailTimeForm:n=this.I.getResponseDetailRuntimeForm;break;case v.a.AdminPhishingReviewForm:n=this.I.getAdminPhishingReviewForm}this.F=n.bind(this.I)}}var e=t.prototype;return e.add=function(t){return this.O.SyncContext===v.a.LocalForm?$.Deferred().promise():this.O.SyncContext===v.a.DesignTimeForm?this.I.createForm(t):void Object(m.b)("Trying to create a form without design type.")},e.delete=function(t){if(this.O.SyncContext===v.a.DesignTimeForm)return this.N(),this.I.deleteForm(this.O.Model.Id);Object(m.b)("Trying to delete a form without design type.")},e.query=function(t){if(!this.F){return $.Deferred().reject({innerCode:1001,type:"ExpectedFailure"}).promise()}var e=c.a.getFieldSchemaInfo(this.O.Schema.LocalizedResources).Attributes.SourceFieldName,n=t.filter((function(t){return t!==e})),r=[],s=$.Deferred();return this.F(this.O.Model.Id,n).then((function(t){return s.resolve(t)}),(function(t){return s.reject(t)})),r.push(s.promise()),o.find(t,(function(t){return t===e}))&&!Object(b.p)()&&r.push(this.O.getAllLocaleResources()),$.when.apply($,r).then((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.extend.apply(o,Object(i.f)([{}],t))}))},e.update=function(t){if(this.O.SyncContext===v.a.LocalForm)return $.Deferred().promise();if(this.O.SyncContext!==v.a.DesignTimeForm)return $.Deferred().resolve().promise();var e=c.a.getFieldSchemaInfo(X.Schema.SoftDeleted).Attributes.SourceFieldName;return e in t&&t[e]===r.SoftDeleted&&this.N(),this.I.updateForm(this.O.Model.Id,t)},e.N=function(){var t=this;return this.I.removeRecentForm(this.O.Model.Id).then((function(){var e=Forms.Mru.MruDocumentCollectionMaster.getInstance();e&&e.removeDocument(t.O.Model.Id)}))},t}(),O=n(49),j=function(){function t(t,e){this.T=t,this.C=e,this.I=Object(g.b)(this.T.Form)}var e=t.prototype;return e.P=function(){return this.T.FormId},e.L=function(){return this.T.ResponseId},e.add=function(t){return Object(m.b)("No scenario to call this method currently.")},e.delete=function(t){return this.I.deleteFormResponse(this.P(),t.id)},e.query=function(t){return Object(m.b)("No scenario to call this method currently.")},e.update=function(t,e){var n=t.releaseDate,r=this.T.Form.SyncContext;return r!==v.a.DesignTimeForm&&r!==v.a.AnalysisTimeForm?$.Deferred().promise():void 0!==n?this.I.setResponseReleaseDate(this.P(),this.L(),n):$.Deferred().resolve().promise()},t}(),w=n(44),S=n(35),I=function(){function t(t,e){this.D=t,this.I=Object(g.b)(this.D.Response.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.D.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ResponseId",{get:function(){return this.D.ResponseId},enumerable:!0,configurable:!0}),e.add=function(t,e,n){return this.I.addFormResponseComment(this.FormId,this.ResponseId,e.Snapshot)},e.delete=function(t){return $.Deferred().promise()},e.query=function(t){return Object(m.b)("No scenario to call this method currently.")},e.update=function(t,e){var n=this.D.Response.Form.SyncContext;return n!==v.a.DesignTimeForm&&n!==v.a.AnalysisTimeForm?$.Deferred().promise():this.add(t,e,!0)},t}(),F={QuestionId:s.a.string({IsKeyField:!0,SourceFieldName:"questionId"}),Id:s.a.number({SourceFieldName:"id"}),Feedback:s.a.string({SourceFieldName:"feedback"}),Score:s.a.number({SourceFieldName:"score"}),SavingState:s.a.reference({IsLocalField:!0})};var y=function(t){function e(e){var n=t.call(this,e,{Scheduler:new w.a})||this;return Object(O.b)(n),n.observe(N),n}Object(i.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Response",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Response.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ResponseId",{get:function(){return this.Response.ResponseId},enumerable:!0,configurable:!0}),e}(c.a.createObjectMasterClass("Comment",F,(function(t,e){return new I(t,e)})));function N(t){if(t.BeingDeleted&&t.Master.Synchronizer.Model.UpdateScheduled)try{throw Error("DeletingComment")}catch(t){S.a.logData({errorName:"ModelError",errorInfo:t.stack})}}var k={Id:s.a.number({IsKeyField:!0,SourceFieldName:"id"}),Comments:s.a.collectionOf((function(){return y}),{SourceFieldName:"comments"}),AnswersAsString:s.a.string({SourceFieldName:"answers"}),StartDateAsString:s.a.string({SourceFieldName:"startDate"}),SubmitDateAsString:s.a.string({SourceFieldName:"submitDate"}),Responder:s.a.string({SourceFieldName:"responder"}),ResponderName:s.a.string({SourceFieldName:"responderName"}),QuizResult:s.a.string({SourceFieldName:"quizResult"}),ReleaseDateAsString:s.a.string({SourceFieldName:"releaseDate"}),Answers:s.a.collectionOf({QuestionId:s.a.string({IsKeyField:!0,SourceFieldName:"questionId"}),Answer:s.a.reference({SourceFieldName:"answer1"}),Feedback:s.a.string({IsLocalField:!0}),Score:s.a.number({IsLocalField:!0}),IsAutoGraded:s.a.boolean({IsLocalField:!0}),IsMathAnswer:s.a.boolean({IsLocalField:!0})},{IsLocalField:!0}),StartDate:s.a.reference({IsLocalField:!0}),SubmitDate:s.a.reference({IsLocalField:!0}),ReleaseDate:s.a.reference({IsLocalField:!0}),Feedback:s.a.string({IsLocalField:!0}),TotalScore:s.a.number({IsLocalField:!0}),IntegratedSavingState:s.a.reference({IsLocalField:!0}),SavingState:s.a.reference({IsLocalField:!0}),EmailReceiptConsent:s.a.boolean({SourceFieldName:"emailReceiptConsent"}),SubmitLanguage:s.a.string({SourceFieldName:"submitLanguage"}),MSRewardsData:s.a.reference({SourceFieldName:"msRewardsData"})};k.Answers[0];var T=function(t){function e(n){var r=this,i=$.Deferred();return(r=t.call(this,n,{Scheduler:new w.a,MasterReady:i.promise()})||this).A(),e.Rules.forEach((function(t){return r.addRule(t)})),i.resolve(),r}Object(i.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ResponseId",{get:function(){return this.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Comment",{get:function(){return this.getCommentByQuestionId(null)},enumerable:!0,configurable:!0}),n.updateWithNormalizedResponse=function(t){var n=this;this.bulkEdit((function(){n.Synchronizer.onSourceDataReceived(c.a.convertToSourceData(t,e.Schema)),n.setData(t)}))},n.getAnswerByQuestionId=function(t){var e=c.a.Collection.getItemWithKeyFields(this.Model.Answers,{QuestionId:t});return e&&c.a.getObjectMasterFromModel(e)},n.getCommentByQuestionId=function(t){var e=c.a.Collection.getItemWithKeyFields(this.Model.Comments,{QuestionId:t});return e&&function(t){return c.a.getObjectMasterFromModel(t)}(e)},n.setAnswerGrading=function(t,e,n){var r=this.Form.getQuestionById(t);if(r){var i=r.SubQuestionMasters;i.length>0&&(t=i[i.length-1].Model.Id);var o=this.getCommentByQuestionId(t);if(o)o.bulkEdit((function(){o.Model.Score=e,o.Model.Feedback=n}));else{var s={QuestionId:t,Feedback:n,Score:e};c.a.Collection.addItems(this.Model.Comments,[s])}}},n.A=function(){var t=this;this._="Idle";var e=c.a.getCollectionMasterFromModel(this.Model.Comments);Object(O.c)(e,e.Schema[0].SavingState,(function(e){t._=e,t.U()})),Object(O.b)(this),this.U()},n.$=function(t){var e=this.getAnswerByQuestionId(t);if(e)return e;var n=c.a.Collection.addItems(this.Model.Answers,[{QuestionId:t}])[0];return c.a.getObjectMasterFromModel(n)},n.U=function(){this.Model.IntegratedSavingState=Object(O.a)([this.Model.SavingState,this._])},Object.defineProperty(e,"Rules",{get:function(){if(!e.rules){var t=e.Schema;e.rules=[{Name:"ResponseComment",InterestedFields:[t.Feedback,t.TotalScore],onChange:function(t){var e=t.Master,n=e.getCommentByQuestionId(null);n?n.bulkEdit((function(){n.Model.Feedback=e.Model.Feedback,n.Model.Score=e.Model.TotalScore})):c.a.Collection.addItems(e.Model.Comments,[{QuestionId:null,Feedback:e.Model.Feedback,Score:e.Model.TotalScore}])}},{Name:"AnswerComment",InterestedFields:[t.Answers[0].Feedback,t.Answers[0].Score,t.Answers[0].IsAutoGraded],onChange:function(t){var e=t.Master,n=e.Model.Answers,r=function(t){t.IsAutoGraded||e.setAnswerGrading(t.QuestionId,t.Score,t.Feedback)};t.SubChanges.filter((function(t){return t.Master.Model===n})).forEach((function(t){t.AddedModels.forEach(r),t.SubChanges.forEach((function(t){return r(t.Master.Model)}))}))}},{Name:"ApplyCommentChange",InterestedFields:[t.Comments],onChange:function(t){var e=t.Master,n=e.Model.Comments,r=function(t){var n=t.QuestionId;if(n){var r=e.$(n);r.bulkEdit((function(){r.Model.Feedback=t.Feedback,r.Model.Score=t.Score,r.Model.IsAutoGraded=!1}))}else e.bulkEdit((function(){e.Model.Feedback=t.Feedback,e.Model.TotalScore=t.Score}))};t.SubChanges.filter((function(t){return t.Master.Model===n})).forEach((function(t){t.AddedModels.forEach(r),t.SubChanges.forEach((function(t){return r(t.Master.Model)}))}))}}],e.rules=e.rules.concat(e.getRulesForSyncBetweenDateFields(t.StartDate,t.StartDateAsString),e.getRulesForSyncBetweenDateFields(t.SubmitDate,t.SubmitDateAsString),e.getRulesForSyncBetweenDateFields(t.ReleaseDate,t.ReleaseDateAsString))}return e.rules},enumerable:!0,configurable:!0}),e.getRulesForSyncBetweenDateFields=function(t,e){var n=c.a.getFieldSchemaInfo(t).Name,r=c.a.getFieldSchemaInfo(e).Name;return[{Name:"update "+n,InterestedFields:[e],onChange:function(t){var e=t.Master.Model;e[n]=new Date(e[r])}},{Name:"update "+r,InterestedFields:[t],onChange:function(t){var e=t.Master.Model;e[r]=e[n].toISOString()}}]},e}(c.a.createObjectMasterClass("Response",k,(function(t,e){return new j(t,e)})));function C(t){var e=c.a.convertFromSourceData(t,T.Schema);void 0!==e.StartDateAsString&&(e.StartDate=new Date(e.StartDateAsString)),void 0!==e.SubmitDateAsString&&(e.SubmitDate=new Date(e.SubmitDateAsString)),void 0!==e.ReleaseDateAsString&&(null===e.ReleaseDateAsString?e.ReleaseDate=new Date("0001-01-01T00:00:00Z"):e.ReleaseDate=new Date(e.ReleaseDateAsString));var n=[];if(e.AnswersAsString&&(n=JSON.parse(e.AnswersAsString).map((function(t){return{Answer:t.answer1,QuestionId:t.questionId}})),e.Answers=n),e.Comments){var r={},i=[];o.forEach(e.Comments,(function(t){var e=t.QuestionId||"___";r[e]&&i.push(r[e]),r[e]=t})),e.Comments=o.difference(e.Comments,i)}if(e.Comments){var s={};n.forEach((function(t){return s[t.QuestionId]=t})),o.forEach(e.Comments,(function(t){var r=t.QuestionId;if(r){var i=s[r];i||(i={Answer:null,QuestionId:r},n.push(i),s[r]=i),i.Feedback=t.Feedback,i.Score=t.Score}else e.Feedback=t.Feedback,e.TotalScore=t.Score}))}return e}var P=n(47),x=n(68),M=n(32),L=n(40),D=n(57),R=function(){function t(t){this.W=t,this.I=Object(g.b)(this.W.Form)}var e=t.prototype;return e.add=function(t){if(!t.localeId||!t.localeName||this.W.Form.SyncContext!==v.a.DesignTimeForm)return $.Deferred().resolve().promise();var e={elementKey:"localename",elementValue:t.localeName,locale:t.localeId,questionId:""};return this.I.createLocaleItem(this.W.FormId,e)},e.delete=function(t){return t.localeId&&this.W.Form.SyncContext===v.a.DesignTimeForm?this.I.deleteLocale(this.W.FormId,t.localeId):$.Deferred().resolve().promise()},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||!t.localeName||this.W.Form.SyncContext!==v.a.DesignTimeForm)return $.Deferred().resolve().promise();var n=null!==e.ValuesBefore.localeName,r={elementKey:"localename",elementValue:t.localeName,locale:this.W.Model.localeId,questionId:null};return n?this.I.updateLocaleItem(this.W.FormId,r):this.I.createLocaleItem(this.W.FormId,r)},t}(),E={localeId:s.a.string({IsKeyField:!0}),localeName:s.a.string()},A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),e}(c.a.createObjectMasterClass("LocaleInfoMaster",E,(function(t){return new R(t)}))),_=n(54),U=function(){function t(t,e){this.J=t,this.I=Object(g.b)(this.J.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.J.FormId},enumerable:!0,configurable:!0}),e.add=function(t){return this.J.Form.SyncContext===v.a.AdminPhishingReviewForm?this.I.createAdminPhishingReviewPermissionLink(this.FormId,t):this.I.createPermissionLink(this.FormId,t)},e.delete=function(t){return this.I.deletePermissionLink(this.FormId,t.principalId)},e.query=function(t){return Object(m.b)("No scenario to call this method currently.")},e.update=function(t,e){if("OrgLink"===e.Snapshot.type||"Link"===e.Snapshot.type||"ShareToPeople"===e.Snapshot.type){var n={permissionSet:e.Snapshot.permissionSet,type:e.Snapshot.type};return this.J.Form.SyncContext===v.a.AdminPhishingReviewForm?this.I.createAdminPhishingReviewPermissionLink(this.FormId,n):this.I.createPermissionLink(this.FormId,n)}return Object(m.b)("No scenario to call this method currently.")},t}(),B={PrincipalId:s.a.string({SourceFieldName:"principalId"}),PermissionSet:s.a.string({SourceFieldName:"permissionSet"}),Type:s.a.reference({SourceFieldName:"type"}),FormId:s.a.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:s.a.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:s.a.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:s.a.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:s.a.reference({IsLocalField:!0})};var q=function(t){function e(e){var n=t.call(this,e)||this;return Object(O.b)(n),n}Object(i.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),e}(c.a.createObjectMasterClass("Permission",B,(function(t,e){return new U(t,e)}))),Q=function(){function t(t,e){this.K=t,this.I=Object(g.b)(this.K.getForm())}var e=t.prototype;return e.P=function(){return this.K.getFormId()},e.add=function(t){return this.I.createPermissionToken(this.P(),t)},e.delete=function(t){return this.I.deletePermissionToken(this.P(),t.principalId)},e.query=function(t){return Object(m.b)("No scenario to call this method currently.")},e.update=function(t,e){return Object(m.b)("No scenario to call this method currently.")},t}(),z={PrincipalId:s.a.string({IsSourceGenerated:!0,SourceFieldName:"principalId"}),Type:s.a.reference({SourceFieldName:"type"}),Name:s.a.string({SourceFieldName:"name"})};var H,V=function(t){function e(e){return t.call(this,e)||this}Object(i.c)(e,t);var n=e.prototype;return n.getForm=function(){return this.Parent.Parent},n.getFormId=function(){return this.getForm().Model.Id},e}(c.a.createObjectMasterClass("PermissionToken",z,(function(t,e){return new Q(t,e)})));!function(t){t[t.Default=0]="Default",t[t.Shown=1]="Shown",t[t.Closed=2]="Closed"}(H||(H={}));var G=n(55),W=n(101),J=n(122);n.d(e,"a",(function(){return X}));var K={Id:s.a.string({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),Description:s.a.string({SourceFieldName:"description"}),Background:s.a.fromMasterClass((function(){return Object(l.f)()}),{SourceFieldName:"background"}),Category:s.a.string({SourceFieldName:"category"}),Logo:s.a.fromMasterClass((function(){return Object(l.f)()}),{SourceFieldName:"logo"}),MeetingId:s.a.string({SourceFieldName:"meetingId"}),ModifiedDate:s.a.string({SourceFieldName:"modifiedDate"}),CreatedDate:s.a.string({SourceFieldName:"createdDate"}),OtherInfo:s.a.string({SourceFieldName:"otherInfo"}),OwnerId:s.a.string({SourceFieldName:"ownerId"}),OwnerTenantId:s.a.string({SourceFieldName:"ownerTenantId"}),OwnerUserType:s.a.string({SourceFieldName:"ownerUserType"}),RowCount:s.a.number({SourceFieldName:"rowCount"}),SharedBy:s.a.string({SourceFieldName:"sharedBy"}),SharedFormOwnerName:s.a.string({SourceFieldName:"ownerDisplayName"}),SharedDate:s.a.string({SourceFieldName:"dateTimeShared"}),TableId:s.a.string({IsSourceGenerated:!0,SourceFieldName:"tableId"}),TenantSwitches:s.a.number({SourceFieldName:"tenantSwitches"}),Title:s.a.string({SourceFieldName:"title"}),Version:s.a.string({SourceFieldName:"version"}),XlWorkbookId:s.a.string({SourceFieldName:"xlWorkbookId"}),XlExportingTag:s.a.string({SourceFieldName:"xlExportingTag"}),XlFileUnsynced:s.a.boolean({SourceFieldName:"xlFileUnSynced"}),XlUnsyncedReason:s.a.string({SourceFieldName:"xlUnsyncedReason"}),Permissions:s.a.collectionOf((function(){return q}),{SourceFieldName:"permissions"}),PermissionTokens:s.a.collectionOf((function(){return V}),{SourceFieldName:"permissionTokens"}),Questions:s.a.collectionOf((function(){return Object(l.i)()}),{SourceFieldName:"questions"}),DescriptiveElements:s.a.collectionOf((function(){return P.a}),{SourceFieldName:"descriptiveQuestions"}),MovingToRecycleBin:s.a.boolean({IsLocalField:!0}),SoftDeleted:s.a.enumeration((function(){return r}),{SourceFieldName:"softDeleted",IsNumberTypeInDataSource:!0}),BusinessCdsId:s.a.string({SourceFieldName:"BusinessCdsId"}),BusinessCdsRegion:s.a.string({SourceFieldName:"BusinessCdsRegion"}),IsDefaultCds:s.a.string({SourceFieldName:"IsDefaultCds"}),LastEmbedConfig:s.a.string({SourceFieldName:"LastEmbedConfig"}),FormsProBranchRules:s.a.string({SourceFieldName:"FormsProBranchRules"}),MfpBranchingData:s.a.string({SourceFieldName:"mfpBranchingData"}),PipesDetails:s.a.string({SourceFieldName:"formsProConfiguredPipes"}),FormsProRTTitle:s.a.string({SourceFieldName:"formsProRTTitle"}),FormsProRTDescription:s.a.string({SourceFieldName:"formsProRTDescription"}),ResponseThresholdCount:s.a.string({SourceFieldName:"responseThresholdCount"}),InviteExpiryDays:s.a.string({SourceFieldName:"inviteExpiryDays"}),FormsProAnswerTagMap:s.a.collectionOf({name:s.a.string(),value:s.a.string(),questionId:s.a.string()},{IsLocalField:!0}),FormsProAnswerTagMapRT:s.a.collectionOf({name:s.a.string(),value:s.a.string()},{IsLocalField:!0}),FooterText:s.a.string({SourceFieldName:"footerText"}),CustomCssFileName:s.a.string({SourceFieldName:"customCssFileName"}),CustomDomainSenderEmail:s.a.string({SourceFieldName:"customDomainSenderEmail"}),TrackingId:s.a.string({SourceFieldName:"trackingId"}),ThankYouMessage:s.a.string({SourceFieldName:"thankYouMessage"}),EmailReceiptEnabled:s.a.boolean({SourceFieldName:"emailReceiptEnabled"}),Flags:s.a.number({SourceFieldName:"flags"}),Type:s.a.reference({SourceFieldName:"type"}),OnlineSafetyLevel:s.a.number({SourceFieldName:"onlineSafetyLevel"}),BufferResponses:s.a.collectionOf(s.a.reference({},(function(t){return t.Id.toString()})),{IsLocalField:!0}),CoAuthMessage:s.a.string({IsLocalField:!0}),DeleteCollaborationPermission:s.a.boolean({IsLocalField:!0}),HasValidBranching:s.a.boolean({IsLocalField:!0}),HasQuestionMedia:s.a.boolean({IsLocalField:!0}),Created:s.a.string({IsLocalField:!0}),Modified:s.a.string({IsLocalField:!0}),PredefinedResponses:s.a.collectionOf({Id:s.a.number({IsKeyField:!0}),Answers:s.a.collectionOf({QuestionId:s.a.string(),Answer:s.a.reference()})},{IsLocalField:!0}),PrimaryCustomizedThemeColor:s.a.string({IsLocalField:!0}),QuizQuestionsCount:s.a.number({IsLocalField:!0}),SecondaryCustomizedThemeColor:s.a.string({IsLocalField:!0}),Responses:s.a.collectionOf(s.a.reference({},(function(t){return t.Id.toString()})),{IsLocalField:!0}),ResponsesCount:s.a.number({IsLocalField:!0}),XlExportingLocalTag:s.a.string({IsLocalField:!0}),SerializedSettings:s.a.string({SourceFieldName:"settings"}),Settings:s.a.fromMasterClass((function(){return W.a}),{IsLocalField:!0}),SerializedPredefinedResponses:s.a.string({SourceFieldName:"predefinedResponses"}),TertiaryCustomizedThemeColor:s.a.string({IsLocalField:!0}),Theme:s.a.fromMasterClass((function(){return J.a}),{IsLocalField:!0}),ResponseModels:s.a.collectionOf((function(){return T}),{IsLocalField:!0}),IntegratedSavingState:s.a.reference({IsLocalField:!0}),SavingState:s.a.reference({IsLocalField:!0}),LogoInfo:s.a.fromMasterClass(l.g,{IsLocalField:!0}),CreatedFromOneDrive:s.a.boolean({IsLocalField:!0}),TemplateId:s.a.string(),TransferInProgress:s.a.boolean({IsLocalField:!0}),DataClassificationLabel:s.a.string(),DefaultLanguage:s.a.string({SourceFieldName:"defaultLanguage"}),LocaleList:s.a.collectionOf((function(){return A}),{SourceFieldName:"localeList"}),LocalizedResources:s.a.collectionOf((function(){return D.a}),{SourceFieldName:"localizedResources"}),CreatedBy:s.a.string({SourceFieldName:"createdBy"}),FileUploadFormInfo:s.a.create({errorCode:s.a.string()},{SourceFieldName:"fileUploadFormInfo"}),ProgressBarEnabled:s.a.string({SourceFieldName:"progressBarEnabled"}),FormsProEmbedCode:s.a.string({SourceFieldName:"formsProEmbedCode"}),YouTubeMessageBarState:s.a.enumeration((function(){return H}),{IsLocalField:!0})},X=function(t){function e(n,r,i,o,c,s){void 0===o&&(o=!1);var u=this,a=$.Deferred();r=Object(G.h)(r),(u=t.call(this,r,{Scheduler:new w.a,MasterReady:a.promise()})||this).initializing=a,u.syncBlocker=c||u.initializing,u.isGroupForm=i,u.X=o,u.Y=n,u.Z=s;var f=Object(l.e)();return u.formElementManager=new f(u),u.nt(r),u.rt(r),u.ot(r),e.Rules.forEach((function(t){return u.addRule(t)})),u.ct(),u}Object(i.c)(e,t);var n=e.prototype;return n.getSyncBlocker=function(){return this.syncBlocker},Object.defineProperty(n,"IsGroupForm",{get:function(){return this.isGroupForm},enumerable:!0,configurable:!0}),Object.defineProperty(n,"IsSampleForm",{get:function(){return this.X},enumerable:!0,configurable:!0}),Object.defineProperty(n,"IsAssignmentForm",{get:function(){return!!this.isFieldReady(this.Schema.Category)&&"assignments"===this.Model.Category},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SyncContext",{get:function(){return this.Y},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FormElementManager",{get:function(){return this.formElementManager},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SettingMaster",{get:function(){return c.a.getObjectMasterFromModel(this.Model.Settings)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ThemeMaster",{get:function(){return c.a.getObjectMasterFromModel(this.Model.Theme)},enumerable:!0,configurable:!0}),n.getRelatedSourceFields=function(t){return Object(G.g)(t)},n.getImageMaster=function(t){return Object(M.c)(this.getModelByFieldSchema(t))},n.getImageSettingsMaster=function(t){return Object(L.e)(this.getModelByFieldSchema(t))},n.getQuestionById=function(t){return this.formElementManager.getQuestionById(t)},n.getElementById=function(t){return this.formElementManager.getElementMasterById(t)},n.getReleasedResponsesByResponder=function(t){var e=this;return t&&!this.SettingMaster.Model.IsAnonymous?function(t,e){return Object(g.b)(t).getRuntimeResponses(t.Model.Id,e).then((function(t){return t.filter((function(t){return"0001-01-01T00:00:00Z"!==t.releaseDate})).map(C)}))}(this,t).then((function(t){return Object(u.c)()?e.Z.normalizeResponses(t):e.normalizeResponses(t)})):$.Deferred().resolve().promise()},n.getRuntimeResponse=function(t){var e=this;return t?function(t,e){return Object(g.b)(t).getRuntimeResponse(t.Model.Id,e).then(C)}(this,t).then((function(t){return e.st(t)})):$.Deferred().resolve().promise()},n.ensureReadyToResponse=function(){return this.ensureFieldsReady(Object(G.d)())},n.ensureReadyToShare=function(){return this.ensureFieldsReady(Object(G.e)())},n.getDefaultResponse=function(){var t={};return Object(f.a)()&&o.forEach(this.Model.Questions,(function(e){return t[e.Id]=e.DefaultValue})),t},n.hasSection=function(){return this.FormElementManager.SectionMasters.length>0},n.syncRuntimeResponses=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return e=t,Object(g.b)(e).getRuntimeResponses(e.Model.Id).then((function(t){return t.map(C)}));var e})).then((function(e){t.updatingResponsesFromServer=!0,t.bulkEdit((function(){return t.Model.Responses=t.normalizeResponses(e)})),t.updatingResponsesFromServer=!1}))},n.submitResponse=function(t){var e=this;if("pending"===this.syncBlocker.state())return $.Deferred().resolve();var n=0,r=0,i=!1;return(t=o.clone(t)).Answers=o.map(t.Answers,(function(t){var c=e.getQuestionById(t.QuestionId);return c&&c.Model&&((t=o.clone(t)).Answer=c.serializeAnswer(t.Answer),"Question.TextField"===c.Model.Type&&(n++,t.Answer&&(r+=t.Answer.length),!i&&c.Model.IsMathQuiz&&(i=!0))),t})),i&&this.ut(t),d.a.logData({name:"ResponsePage.Form.TextQuestionInfoOfSubmit",extraData:{textQuestionCount:n,textQuestionAnswerTotalLength:r,isQuiz:this.SettingMaster.Model.IsQuizMode}}),this.Synchronizer.existingInDataSource().then((function(){return function(t,e){var n=o.map(e.Answers,(function(t){return{questionId:t.QuestionId,answer1:t.Answer}})),r={answers:JSON.stringify(n),startDate:e.StartDate instanceof Date?e.StartDate.toISOString():"",submitDate:e.SubmitDate instanceof Date?e.SubmitDate.toISOString():""};return r.emailReceiptConsent=e.EmailReceiptConsent,r.submitLanguage=e.SubmitLanguage,e.Responder&&(r.responder=e.Responder,r.responderName=e.ResponderName),Object(g.b)(t).submitFormResponse(t.Model.Id,r)}(e,t)}))},n.getSnapshotToCopy=function(){var t=this.getSnapshot(Object(G.b)()),e=null;return t.XlWorkbookId&&((e=o.clone(t)).XlWorkbookId="WaitingForExport"),this.Model.OwnerTenantId!==Object(a.a)().userInfo.TenantId&&t.DataClassificationLabel&&(e||(e=o.clone(t)),e.DataClassificationLabel=null),null===e?t:e},n.getLocaleResouceById=function(t){return Object(g.a)(this.Model.Id).getLocaleResource(this.Model.Id,t).then((function(t){return Object(_.e)(t)}))},n.ensureFieldsReady=function(e){return t.prototype.ensureFieldsReady.call(this,e)},n.rt=function(t){t.ExistingInDataSource?this.isFieldReady(e.Schema.ModifiedDate)&&(this.Model.Modified=this.Model.ModifiedDate):this.Model.Modified=(new Date).toISOString()},n.ot=function(t){t.ExistingInDataSource?this.isFieldReady(e.Schema.CreatedDate)&&(this.Model.Created=this.Model.CreatedDate):this.Model.Created=(new Date).toISOString()},n.nt=function(t){this.at=new x.a(this,e.Schema.OtherInfo,Object(G.f)()),t.InitialData&&this.isFieldReady(e.Schema.OtherInfo)&&(t.ExistingInDataSource||t.InitialData.OtherInfo?this.at.deserialize():this.at.serialize())},n.normalizeResponses=function(t){var e=this;return this.bulkEdit((function(){t=t.map((function(t){return e.st(t)}))})),t},n.st=function(t){var e=this.Model.Settings.IsQuizMode&&this.SyncContext!==v.a.ResponseTimeForm,n={};this.FormElementManager.QuestionMasters.forEach((function(t){return n[t.Model.Id]=t})),(t=o.clone(t)).Answers=o.map(t.Answers,(function(t){var r=n[t.QuestionId];return r?((t=o.clone(t)).Answer=r.deserializeAnswer(t.Answer),t.IsMathAnswer=!r.Model.IsAnswerPlainText,null==t.Score&&e&&r.autoGradeAnswer(t),t):null})).filter((function(t){return!!t}));var r=this.getResponseModelById(t.Id);return r&&(function(t){return c.a.getObjectMasterFromModel(t)}(r).updateWithNormalizedResponse(t),t=r),t},n.getResponseModelById=function(t){return c.a.Collection.getItemWithKeyFields(this.Model.ResponseModels,{Id:t})},n.ut=function(t){var e=this,n={QuestionCount:0,GradableQuestionCount:0,MathResponses:0,MathGradableResponses:0,TextResponses:0,TextGradableResponses:0,EmptyResponses:0,TotalLength:0};o.forEach(t.Answers,(function(t){var r=e.getQuestionById(t.QuestionId);if(r&&r.Model&&"Question.TextField"===r.Model.Type&&r.Model.IsMathQuiz){r.hasCorrectAnswers()?n.GradableQuestionCount++:n.QuestionCount++;var i=Object(h.u)(t.Answer);null!=i&&i.Answer?(n.TotalLength+=i.Answer.length,r.hasCorrectAnswers()?i.IsMath?n.MathGradableResponses++:n.TextGradableResponses++:i.IsMath?n.MathResponses++:n.TextResponses++):n.EmptyResponses++}})),d.a.logData({name:"ResponsePage.Form.TextFieldSubmissionMathInfo",extraData:n})},n.ct=function(){var t=this;this.formElementManager.adjustElementOrders();var n=[e.Schema.Questions,e.Schema.DescriptiveElements];this.addRule({Name:"ElementOrder",InterestedFields:n,onChange:function(){return t.formElementManager.adjustElementOrders()}})},Object.defineProperty(e,"Rules",{get:function(){if(!e.rules){var t=e.Schema;e.rules=[{Name:"DeserializeSettings",InterestedFields:[t.SerializedSettings],onChange:function(t){if(!t.BeingDeleted){var e=t.Master.Model.SerializedSettings||"{}",n=JSON.parse(e);t.Master.setData({Settings:n})}}},{Name:"DeserializePredefinedResponses",InterestedFields:[t.SerializedPredefinedResponses],onChange:function(t){if(!t.BeingDeleted){var e=t.Master.Model.SerializedPredefinedResponses||"[]",n=JSON.parse(e);t.Master.setData({PredefinedResponses:n})}}}]}return e.rules},enumerable:!0,configurable:!0}),e}(c.a.createObjectMasterClass("FormMaster",K,(function(t,e){return t.getSyncBlocker().then((function(){return new p(t,e)}))})));FormsPro.FormMaster=X},,function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.DesignTimeForm=1]="DesignTimeForm",t[t.ResponseTimeForm=2]="ResponseTimeForm",t[t.SharedTimeForm=3]="SharedTimeForm",t[t.LocalForm=4]="LocalForm",t[t.AnalysisTimeForm=5]="AnalysisTimeForm",t[t.ResponseDetailTimeForm=6]="ResponseDetailTimeForm",t[t.AdminPhishingReviewForm=7]="AdminPhishingReviewForm"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return s}));n(3);function r(t){return o(t||window.location.search.substring(1))}function i(t){return o(t||window.location.hash.substring(1))}function o(t){var e={};return t&&t.trim().split("&").forEach((function(t){var n=t.indexOf("=");-1===n&&(n=t.length);var r=t.substring(0,n).trim();r&&(e[r]=decodeURIComponent(t.substring(n+1)||"").trim())})),e}function c(t){var e=document.createElement("a");return e.href=t,e.href}function s(t,e,n){var r=t.indexOf("#"),i=-1===r?"":t.substr(r);t=-1===r?t:t.substr(0,r);var o=new RegExp("([?&])"+e+"=.*?(&|$)","i"),c=-1!==t.indexOf("?")?"&":"?";return(t=t.match(o)?t.replace(o,"$1"+e+"="+n+"$2"):t+c+e+"="+n)+i}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2),i=n(0),o=n(26),c=function(t){function e(e){var n,r,i=t.call(this,e)||this;return i.state={},r=n=i,s.forEach((function(t){var e=r[t];e&&(r[t]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{return e.apply(n,r)}catch(e){return u(n,t,e),null}})})),i}return Object(r.c)(e,t),e}(i.Component),s=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","render"];function u(t,e,n){try{if(n&&n.stack&&console.error(n.stack),window.onerror){var r=o.findDOMNode(t),i=r&&r.getAttribute("data-reactId")||"",c="Exception in "+t.constructor.name+"["+i+"]:"+e;n&&n.message&&(c+=" Message: "+n.message),window.onerror(c,"",0,0,n)}}catch(n){}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return c}));var r=n(20);function i(t){s().log(t)}function o(t){s().logFormsProEvent(t)}function c(t){s().logForTeamsTab(t)}function s(){return r.a.Resolve("ILogger")}var u=window.onerror;window.onerror=function(t,e,n,r,o){i({eventName:"UnhandleException",eventType:"error_event",extraData:{columnNo:r,error:o&&o.toString(),fileName:e,lineNo:n,message:t,stack:o&&o.stack}}),u&&u.apply(this,arguments)}},function(t,e,n){"use strict";var r=n(2),i=n(3),o=n(4),c=n(19),s=n(1),u=n(9),a=n(21),f=n(71),l=n(63),h=n(35),d=n(84),m=n(44),b=n(32),v=n(40),g=n(68),p=n(69),O=n(30),j=n(49),w=n(23),S=n(14),I=function(){function t(t,e){this.ft=t,this.I=Object(w.b)(this.ft.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.ft.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionId",{get:function(){return this.ft.QuestionId},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ChoiceId",{get:function(){return this.ft.Model.Id},enumerable:!0,configurable:!0}),e.add=function(t){if(this.ft.Form.SyncContext===S.a.DesignTimeForm)return this.I.createQuestionChoice(this.FormId,this.QuestionId,t);Object(c.b)("Trying to create a choice out of design time.")},e.delete=function(t){if(this.ft.Form.SyncContext===S.a.DesignTimeForm)return this.I.deleteQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId);Object(c.b)("Trying to delete a choice out of design time.")},e.query=function(t){return this.I.getQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId)},e.update=function(t,e){if(this.ft.Form.SyncContext===S.a.DesignTimeForm){if(t)return this.I.updateQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId,t);try{throw Error("patch choice body null error")}catch(t){h.a.logData({errorName:"DataSourceUpdatingChoiceNull",errorInfo:{stack:t.stack}})}return $.Deferred().resolve().promise()}Object(c.b)("Trying to update a choice out of design time.")},t}(),F={Id:s.a.number({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),AnswerHint:s.a.string({SourceFieldName:"description"}),CustomProperties:s.a.string({SourceFieldName:"customProperties"}),Description:s.a.string({SourceFieldName:"displayText"}),FormsProDisplayRTText:s.a.string({SourceFieldName:"formsProDisplayRTText"}),Order:s.a.number({SourceFieldName:"order"}),Key:s.a.string({SourceFieldName:"key"}),IsGenerated:s.a.boolean({IsLocalField:!0}),IsMathOption:s.a.boolean({IsLocalField:!0}),BranchInfo:s.a.fromMasterClass((function(){return d.a}),{IsLocalField:!0}),SavingState:s.a.reference({IsLocalField:!0})};var y=function(t){function e(e){var n=this,r=$.Deferred();return n=t.call(this,e,{Scheduler:new m.a,MasterReady:r.promise()})||this,Object(j.b)(n),n.fieldsReady([n.Schema.Id,n.Schema.Key]).done((function(){n.Model.Key||(n.Model.Key=Object(O.b)())})),n.ht(e),r.resolve(),n}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Question",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.Question.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Form",{get:function(){return this.Question.Form},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),n.ht=function(t){this.dt=new g.a(this,e.Schema.CustomProperties,e.CustomPropertiesFieldSet),t.InitialData&&this.isFieldReady(e.Schema.CustomProperties)&&(t.ExistingInDataSource||t.InitialData.CustomProperties?this.dt.deserialize():this.dt.serialize())},Object.defineProperty(e,"CustomPropertiesFieldSet",{get:function(){return e.customPropertiesFieldSet||(e.customPropertiesFieldSet=new p.a([e.Schema.BranchInfo,e.Schema.IsGenerated,e.Schema.IsMathOption])),e.customPropertiesFieldSet},enumerable:!0,configurable:!0}),e}(o.a.createObjectMasterClass("ChoiceV2Master",F,(function(t,e){return new I(t,e)}))),N=n(91),k=n(6),T=n(39),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.DateTime"},e.createDefaultDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(k.a)().Question_DefaultTitle,Date:!0,Time:!1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)},n.verify=function(t){return this.Model.Required&&!t?W.RequiredError:W.Success},n.getTypeDisplayName=function(){return Object(k.a)().QuestionType_DateTime},e}(T.a),P=n(51),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.FileUpload"},e.createDefaultDefinition=function(){var t=P.b;return{Type:e.getElementTypeName(),Title:Object(k.a)().Question_DefaultTitle,HasSpecificFileType:!1,FileTypes:{Word:!0,Excel:!0,PowerPoint:!0,PDF:!0,Image:!0,Video:!0,Audio:!0},QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1,MaxFileCount:1,MaxFileSize:t[Object.keys(t)[0]]}},n.verify=function(t){return this.Model.Required&&!t?W.RequiredError:W.Success},n.getTypeDisplayName=function(){return Object(k.a)().QuestionType_UploadFile},e}(T.a),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.MatrixChoice"},n.verify=function(t){return!this.Model.Required||t&&0!==t.length?W.Success:W.RequiredError},n.getTypeDisplayName=function(){return"MatrixChoice"},n.getNormalizedAnswer=function(t){return t},e}(T.a),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.MatrixChoiceGroup"},e.createDefaultDefinition=function(){var t=[{Description:Object(k.a)().Designer_Choices_DefaultDescription.format(1),IsGenerated:!0,Id:1,Order:1},{Description:Object(k.a)().Designer_Choices_DefaultDescription.format(2),IsGenerated:!0,Id:2,Order:2},{Description:Object(k.a)().Designer_Choices_DefaultDescription.format(3),IsGenerated:!0,Id:3,Order:3},{Description:Object(k.a)().Designer_Choices_DefaultDescription.format(4),IsGenerated:!0,Id:4,Order:4},{Description:Object(k.a)().Designer_Choices_DefaultDescription.format(5),IsGenerated:!0,Id:5,Order:5}];return{Type:e.getElementTypeName(),Title:Object(k.a)().Question_DefaultTitle,ChoiceGroup:t,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.createSubQuestionsDefinition=function(){return[{Title:Object(k.a)().Desinger_Likert_DefaultDescription.format(1),Type:"Question.MatrixChoice"},{Title:Object(k.a)().Desinger_Likert_DefaultDescription.format(2),Type:"Question.MatrixChoice"}]},n.verify=function(t){return W.Success},n.getTypeDisplayName=function(){return Object(k.a)().QuestionType_Likert},n.hasAnswer=function(){return!1},e}(T.a),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.NPS"},e.createDefaultDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(k.a)().NPS_DefaultTitle,LeftDescription:Object(k.a)().NPS_LeftDescription,RightDescription:Object(k.a)().NPS_RightDescription,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},n.verify=function(t){return this.Model.Required&&!t&&0!==t?W.RequiredError:W.Success},n.getTypeDisplayName=function(){return Object(k.a)().QuestionType_NPS},n.isNumberType=function(){return!0},e}(T.a),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.Ranking"},e.createDefaultDefinition=function(){var t=[{Description:Object(k.a)().Designer_Choices_DefaultDescription.format(1),Order:1,Key:Object(O.b)()},{Description:Object(k.a)().Designer_Choices_DefaultDescription.format(2),Order:2,Key:Object(O.b)()},{Description:Object(k.a)().Designer_Choices_DefaultDescription.format(3),Order:3,Key:Object(O.b)()}];return{Type:e.getElementTypeName(),Title:Object(k.a)().Question_DefaultTitle,AllowMultipleValues:!0,ChoiceGroup:t,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},n.verify=function(t){return!this.Model.Required||t&&0!==t.length?W.Success:W.RequiredError},n.getTypeDisplayName=function(){return Object(k.a)().QuestionType_Ranking},n.isCorrectAnswer=function(t){var e=this;if(!t)return!1;var n,r=JSON.parse(this.Model.GradingBasis);n=i.isString(t)?JSON.parse(t):i.map(i.sortBy(t,(function(t){return t.answerOrder})),(function(t){return t.id}));var o=i.map(r,(function(t){return i.findWhere(e.Model.ChoiceGroup,{Key:t}).Id}));return n.length===o.length&&i.isEqual(o,n)},n.createQuizResult=function(t){if(this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(t),GradingBasis:this.Model.GradingBasis}},n.autoGradeAnswer=function(t){var e=this.Model.Point||0;t.Score=this.isCorrectAnswer(t.Answer)?e:0,t.IsAutoGraded=!0},n.autoGradeWithQuizResult=function(t,e){return e?e.IsAnswerCorrect?this.Model.Point:0:null},n.getNormalizedAnswer=function(t){return t||[]},n.hasCorrectAnswers=function(t){return!0},n.redressGradingBasis=function(){var t=this;this.Master.fieldsReady([Object(a.i)().Schema.ChoiceGroup,Object(a.i)().Schema.GradingBasis]).done((function(){var e=o.a.convertToArray(t.Master.Model.ChoiceGroup).sort((function(t,e){return t.Order-e.Order})).map((function(t){return t.Key}));t.Master.Model.GradingBasis=JSON.stringify(e)}))},e}(T.a),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.Rating"},e.createDefaultDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(k.a)().Question_DefaultTitle,Length:5,RatingShape:G.Star,LeftDescription:"",RightDescription:"",MinRating:1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)&&!t.ShowRatingLabel},n.verify=function(t){return this.Model.Required&&!t?W.RequiredError:W.Success},n.getTypeDisplayName=function(){return Object(k.a)().QuestionType_Rating},n.isNumberType=function(){return!0},e}(T.a),A=n(27);var _=n(73),U=n(10),B=(n(7),n(86));var q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.TextField"},e.createDefaultDefinition=function(){return e.createDefaultSingleLineDefinition()},e.createDefaultSingleLineDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(k.a)().Question_DefaultTitle,Multiline:!1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)&&!t.IsNumber},n.verify=function(t){var e=t;if(this.Model.IsMathQuiz&&e){var n=Object(U.u)(t);if((e=null==n.Answer?t:n.Answer).length>Object(A.i)())return W.MathLengthError}return this.Model.Required&&!e?W.RequiredError:e&&this.Model.IsNumber&&!this.bt(e)?W.NumberValidationError:W.Success},n.getTypeDisplayName=function(){return this.Model.Multiline?Object(k.a)().QuestionType_MultiLineText:this.Model.IsNumber?Object(k.a)().QuestionType_Number:Object(k.a)().QuestionType_SingleLineText},n.isNumberType=function(){return!!this.Model.IsNumber},n.justifyNumberBoundaries=function(){var t=this;this.Master.bulkEdit((function(){var e=t.Master.Model,n=Object(_.a)(e.NumberMinBoundary)||"1",r=Object(_.a)(e.NumberMaxBoundary)||"10";switch(e.NumberValidationRule){case H.Greater:case H.GreaterOrEqual:case H.Equal:case H.NotEqual:r=null;break;case H.Less:case H.LessOrEqual:n=null;break;case H.Between:case H.NotBetween:if(parseFloat(n)>parseFloat(r)){var i=n;n=r,r=i}}e.NumberMinBoundary=n,e.NumberMaxBoundary=r}))},n.getValidationErrorMessage=function(){var t;switch(this.Model.FormsProValidationType){case z.Email:t=Object(k.a)().EmailValidFormatError;break;case z.Custom:t=this.Model.FormsProCustomPlaceholder?this.Model.FormsProCustomPlaceholder:Object(k.a)().CustomValidFormatError;break;default:t=this.getNumberValidationErrorMessage()}return t},n.getNumberValidationErrorMessage=function(t){var e=this.Model.NumberValidationRule;if(null!=e)return function(t){var e=Object(k.a)();switch(t){case"Between":return e.NumberValidation_ErrorMessage_Between;case"Equal":return e.NumberValidation_ErrorMessage_Equal;case"Greater":return e.NumberValidation_ErrorMessage_Greater;case"GreaterOrEqual":return e.NumberValidation_ErrorMessage_GreaterOrEqual;case"Less":return e.NumberValidation_ErrorMessage_Less;case"LessOrEqual":return e.NumberValidation_ErrorMessage_LessOrEqual;case"None":return e.NumberValidation_ErrorMessage_None;case"NotBetween":return e.NumberValidation_ErrorMessage_NotBetween;case"NotEqual":return e.NumberValidation_ErrorMessage_NotEqual;default:return""}}(H[e]).format(this.Model.NumberMinBoundary,this.Model.NumberMaxBoundary)},n.hasCorrectAnswers=function(t){return!(!this.Model.IsQuiz||this.Model.Multiline)&&new B.a(t||this.Model).areAnyAnswersDefined()},n.isCorrectAnswer=function(e){return this.Model.IsQuiz&&!this.Model.Multiline?new B.a(this.Model).isCorrect(e):t.prototype.isCorrectAnswer.call(this,e)},n.createQuizResult=function(t){if(new B.a(this.Model).areAnyAnswersDefined()&&this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(t),GradingBasis:this.Model.GradingBasis}},n.autoGradeAnswer=function(e){if(this.Model.IsQuiz&&!this.Model.Multiline){var n=new B.a(this.Model);if(n.areAnyAnswersDefined()){var r=this.Model.Point?this.Model.Point:0;e.Score=n.isCorrect(e.Answer)?r:0,e.IsAutoGraded=!0}else t.prototype.autoGradeAnswer.call(this,e)}else t.prototype.autoGradeAnswer.call(this,e)},n.autoGradeWithQuizResult=function(e,n){return n?this.Model.IsQuiz&&!this.Model.Multiline?n.IsAnswerCorrect?this.Model.Point:0:t.prototype.autoGradeWithQuizResult.call(this,e,n):null},n.vt=function(t,e){return void 0===t||""===t||!!e.test(t)},n.bt=function(t){if(void 0===t||""===t)return!0;if(!Object(_.b)(t))return!1;var e=parseFloat(Object(_.a)(t)),n=parseFloat(this.Model.NumberMinBoundary),r=parseFloat(this.Model.NumberMaxBoundary);switch(this.Model.NumberValidationRule){case H.None:return!0;case H.Between:return e>=n&&e<=r;case H.NotBetween:return!(e>=n&&e<=r);case H.Greater:return e>n;case H.GreaterOrEqual:return e>=n;case H.Less:return e<r;case H.LessOrEqual:return e<=r;case H.Equal:return e===n;case H.NotEqual:return e!==n;default:return!0}},n.deserializeAnswer=function(t){if(this.Model.IsMathQuiz&&t&&""!=t){var e=Object(U.u)(t);return this.Model.IsAnswerPlainText=!e.IsMath,null==e.Answer?t:e.Answer}return t},e}(T.a);var Q=function(){function t(t,e){this.gt=t,this.I=Object(w.b)(this.gt.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.gt.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionId",{get:function(){return this.gt.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionType",{get:function(){return this.gt.Model.Type},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ExtraQosData",{get:function(){var t=this.gt.Form;return{WithSection:t.isFieldReady(t.Schema.DescriptiveElements)&&t.hasSection()}},enumerable:!0,configurable:!0}),e.add=function(t){var e=this;if(this.gt.Form.SyncContext===S.a.DesignTimeForm){var n=this.gt.ParentQuestionMaster;return n?n.Synchronizer.existingInDataSource().then((function(){return e.pt(t)})):this.pt(t)}Object(c.b)("Trying to create a question without design type.")},e.delete=function(t){var e=this;this.gt.Form.SyncContext!==S.a.DesignTimeForm&&Object(c.b)("Trying to delete a question without design type.");var n=this.gt.ParentQuestionMaster;if(n&&n.Deleted)return $.Deferred().resolve().promise();var r=this.gt.SubQuestionMasters.map((function(t){return t.Synchronizer.flush()}));return $.when.apply($,r).then((function(){return e.gt.createSyncJob((function(){return e.I.deleteFormQuestion(e.FormId,t.id,e.QuestionType,e.ExtraQosData)}))})).then(null,(function(t){return t&&621===t.innerCode?$.Deferred().resolve().promise():t}))},e.query=function(t){Object(c.b)("No scenario to call this method currently.")},e.update=function(t,e){var n=this;if(this.gt.Form.SyncContext!==S.a.DesignTimeForm)return $.Deferred().resolve().promise();if("id"in t){var r=t.id,i=e.ValuesBefore.id;h.a.logData({errorName:"DataSourceUpdatingQuestionId",errorInfo:{newId:r,oldId:i}})}if(null===t.allowMultipleValues)try{throw Error("allowMultipleValues null error")}catch(t){h.a.logData({errorName:"DataSourceUpdatingQuestionNullAllowMultipleValues",errorInfo:{stack:t.stack}})}return this.gt.createUploadSyncJob((function(){return n.I.updateFormQuestion(n.FormId,n.QuestionId,n.QuestionType,t,n.ExtraQosData)}))},e.pt=function(t){var e=this,n=this.gt.createSyncJob((function(){return e.I.createFormQuestion(e.FormId,t,e.ExtraQosData)})).then((function(t){var e=t;return e.FileUploadSPOInfo&&(t.fileUploadSPOInfo={driveId:e.FileUploadSPOInfo.DriveId,errorCode:e.FileUploadSPOInfo.ErrorCode,folderId:e.FileUploadSPOInfo.FolderId,linkInfo:e.FileUploadSPOInfo.linkInfo,anonymousLinkInfo:e.FileUploadSPOInfo.anonymousLinkInfo}),t}));return n.done((function(t){"id"in t&&t.id!==e.QuestionId&&h.a.logData({errorName:"ChangedIdFromServerSide",errorInfo:{newId:t.id,oldId:e.QuestionId,formId:e.FormId}})})),n},t}();n.d(e,"g",(function(){return z})),n.d(e,"b",(function(){return H})),n.d(e,"a",(function(){return V})),n.d(e,"f",(function(){return G})),n.d(e,"e",(function(){return W})),n.d(e,"c",(function(){return J})),n.d(e,"h",(function(){return X})),n.d(e,"d",(function(){return Y}));var z,H,V,G,W,J,K={Id:s.a.string({IsKeyField:!0,SourceFieldName:"id"}),DefaultValue:s.a.reference({SourceFieldName:"defaultValue"}),ImageInfo:s.a.fromMasterClass(a.f,{SourceFieldName:"image"}),ImageSettings:s.a.fromMasterClass(a.g,{IsLocalField:!0}),Order:s.a.number({SourceFieldName:"order"}),QuestionInfo:s.a.string({SourceFieldName:"questionInfo"}),Required:s.a.boolean({SourceFieldName:"required"}),Subtitle:s.a.string({SourceFieldName:"subtitle"}),CombinedTitle:s.a.string({SourceFieldName:"title"}),Type:s.a.reference({SourceFieldName:"type"}),GroupId:s.a.string({SourceFieldName:"groupId"}),ShowSubtitle:s.a.boolean({IsLocalField:!0}),Hidden:s.a.boolean({IsLocalField:!0}),FormsProRTQuestionTitle:s.a.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProCalculateSentiment:s.a.boolean({IsLocalField:!0}),FormsProRTSubtitle:s.a.string({SourceFieldName:"formsProRTSubtitle"}),FormsProEnableAnswerTag:s.a.boolean({IsLocalField:!0}),FormsProAnswerTag:s.a.string({IsLocalField:!0}),FormsProAnswerTagHasError:s.a.boolean({IsLocalField:!0}),Title:s.a.string({IsLocalField:!0}),BranchInfo:s.a.fromMasterClass((function(){return d.a}),{IsLocalField:!0}),IntegratedSavingState:s.a.reference({IsLocalField:!0}),SavingState:s.a.reference({IsLocalField:!0}),IsQuiz:s.a.boolean({SourceFieldName:"isQuiz"}),GradingBasis:s.a.string({IsLocalField:!0}),Point:s.a.number({IsLocalField:!0}),ChoiceType:s.a.reference({IsLocalField:!0}),Choices:s.a.collectionOf({Description:s.a.string(),BranchInfo:s.a.fromMasterClass((function(){return d.a})),IsAnswerKey:s.a.boolean(),AnswerHint:s.a.string(),IsGenerated:s.a.boolean(),IsMathOption:s.a.boolean(),FormsProDisplayRTText:s.a.string()},{IsLocalField:!0}),Hint:s.a.string({IsLocalField:!0}),AllowMultipleValues:s.a.boolean({SourceFieldName:"allowMultipleValues"}),AllowOtherAnswer:s.a.boolean({IsLocalField:!0}),OptionDisplayStyle:s.a.enumeration((function(){return J}),{IsLocalField:!0}),ShuffleOptions:s.a.boolean({IsLocalField:!0}),BranchInfoForOtherChoice:s.a.fromMasterClass((function(){return d.a}),{IsLocalField:!0}),ChoiceGroup:s.a.collectionOf((function(){return y}),{SourceFieldName:"choices"}),Length:s.a.number({IsLocalField:!0}),RatingShape:s.a.enumeration((function(){return G}),{IsLocalField:!0}),LeftDescription:s.a.string({IsLocalField:!0}),RightDescription:s.a.string({IsLocalField:!0}),FormsProRTLeftDescription:s.a.string({IsLocalField:!0}),FormsProRTRightDescription:s.a.string({IsLocalField:!0}),ShowRatingLabel:s.a.boolean({IsLocalField:!0}),MinRating:s.a.number({IsLocalField:!0}),FormsProSmileyList:s.a.string({IsLocalField:!0}),Multiline:s.a.boolean({IsLocalField:!0}),IsNumber:s.a.boolean({IsLocalField:!0}),HasTFRestrictionForPro:s.a.boolean({IsLocalField:!0}),Placeholder:s.a.string({IsLocalField:!0}),NumberValidationRule:s.a.enumeration((function(){return H}),{IsLocalField:!0}),FormsProValidationType:s.a.enumeration((function(){return z}),{IsLocalField:!0}),NumberMinBoundary:s.a.string({IsLocalField:!0}),NumberMaxBoundary:s.a.string({IsLocalField:!0}),FormsProCustomRegEx:s.a.string({IsLocalField:!0}),FormsProCustomPlaceholder:s.a.string({IsLocalField:!0}),Date:s.a.boolean({IsLocalField:!0}),Time:s.a.boolean({IsLocalField:!0}),FileUploadSPOInfo:s.a.create({anonymousLinkInfo:s.a.string(),driveId:s.a.string(),folderId:s.a.string(),errorCode:s.a.string(),linkInfo:s.a.string()},{SourceFieldName:"fileUploadSPOInfo"}),FileTypes:s.a.create({Word:s.a.boolean(),Excel:s.a.boolean(),PowerPoint:s.a.boolean(),PDF:s.a.boolean(),Image:s.a.boolean(),Video:s.a.boolean(),Audio:s.a.boolean()},{IsLocalField:!0}),MaxFileCount:s.a.number({IsLocalField:!0}),MaxFileSize:s.a.number({IsLocalField:!0}),HasSpecificFileType:s.a.boolean({IsLocalField:!0}),CoAuthors:s.a.collectionOf(s.a.reference(),{IsLocalField:!0}),IsMathQuiz:s.a.boolean({IsLocalField:!0}),IsPlainTextInMathField:s.a.boolean({IsLocalField:!0}),IsAnswerPlainText:s.a.boolean({IsLocalField:!0}),IsMathInputDefault:s.a.boolean({IsLocalField:!0}),InputSwitcherDisabled:s.a.boolean({IsLocalField:!0}),MathPatterns:s.a.collectionOf(s.a.string(),{IsLocalField:!0}),MathAriaLabels:s.a.collectionOf(s.a.string(),{IsLocalField:!0}),LastMathMLFormula:s.a.string({IsLocalField:!0}),VideoInfo:s.a.create({Url:s.a.string(),Title:s.a.string(),Author:s.a.string(),Thumbnail_url:s.a.string(),OriginalWidth:s.a.number(),OriginalHeight:s.a.number(),ShowWarningBar:s.a.boolean()},{IsLocalField:!0}),TrackingId:s.a.string({SourceFieldName:"trackingId"}),QuestionTagForIntelligence:s.a.string({SourceFieldName:"questionTagForIntelligence"}),IsFromSuggestion:s.a.boolean({SourceFieldName:"isFromSuggestion"})};!function(t){t[t.Number=0]="Number",t[t.Email=1]="Email",t[t.Custom=2]="Custom"}(z||(z={})),function(t){t[t.None=0]="None",t[t.Greater=1]="Greater",t[t.GreaterOrEqual=2]="GreaterOrEqual",t[t.Less=3]="Less",t[t.LessOrEqual=4]="LessOrEqual",t[t.Equal=5]="Equal",t[t.NotEqual=6]="NotEqual",t[t.Between=7]="Between",t[t.NotBetween=8]="NotBetween",t[t.Max=9]="Max"}(H||(H={})),function(t){t[t.SingleChoice=1]="SingleChoice",t[t.MultiChoice=2]="MultiChoice"}(V||(V={})),function(t){t[t.Number=0]="Number",t[t.Star=1]="Star",t[t.Smiley=2]="Smiley"}(G||(G={})),function(t){t[t.Success=0]="Success",t[t.RequiredError=1]="RequiredError",t[t.NumberValidationError=2]="NumberValidationError",t[t.QuizWrongChoiceError=3]="QuizWrongChoiceError",t[t.MathLengthError=4]="MathLengthError",t[t.MultiChoiceQuestionLengthLimitError=5]="MultiChoiceQuestionLengthLimitError",t[t.RegExValidationError=6]="RegExValidationError"}(W||(W={})),function(t){t[t.Dropdown=0]="Dropdown",t[t.ListAll=1]="ListAll"}(J||(J={}));K.Choices[0],K.ChoiceGroup[0];function X(t){return o.a.getObjectMasterFromModel(t)}var Y=function(t){function e(n){var r,s,u=this,a=$.Deferred();return n.InitialData?(e.resolveQuestionNullTypeIssue(n.InitialData),(n=i.clone(n)).InitialData=i.clone(n.InitialData),void 0!==n.InitialData.CombinedTitle?(r=n.InitialData,(s=r.CombinedTitle)&&(s=s.split("⁣")[0]),r.Title=s):function(t){if(t.IsMathQuiz&&t.Subtitle){var e=t.Title||"";t.CombinedTitle=e+"⁣"+t.Subtitle}else t.CombinedTitle=t.Title}(n.InitialData)):Object(c.b)("Question model should created with initial data."),(u=t.call(this,n,{MasterReady:a.promise(),Scheduler:new m.a})||this).fieldsReady([e.Schema.ChoiceGroup]).done((function(){o.a.Collection.setComparer(u.Model.ChoiceGroup,(function(t,e){return t.Order-e.Order}))})),u.Ot(n),Object(v.d)(u,e.Schema.ImageInfo,e.Schema.ImageSettings),u.jt(n),u.redressGradingBasis(),u.coAuthorTimers={},u.initializing=a,u}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ImageInfoMaster",{get:function(){return Object(b.c)(this.Model.ImageInfo)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ImageSettingsMaster",{get:function(){return Object(v.e)(this.Model.ImageSettings)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ParentQuestionMaster",{get:function(){if(!this.isFieldReady(this.Schema.GroupId))return null;var t=this.Model.GroupId;return t&&this.Form.getQuestionById(t)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SubQuestionMasters",{get:function(){var t=this;return this.Form.FormElementManager.QuestionMasters.filter((function(e){return e.Model.GroupId===t.Model.Id}))},enumerable:!0,configurable:!0}),n.isFieldReady=function(n){return n=e.getSourceFields([n])[0],t.prototype.isFieldReady.call(this,n)},n.ensureFieldsReady=function(n){return t.prototype.ensureFieldsReady.call(this,e.getSourceFields(n))},n.fieldsReady=function(n){return t.prototype.fieldsReady.call(this,e.getSourceFields(n))},n.hasValidVideoUrl=function(){return Object(u.b)("SupportStreamVideo")?this.wt()&&Object(l.c)(this.Model.VideoInfo.Url):this.wt()&&Object(l.d)(this.Model.VideoInfo.Url)},n.createSyncJob=function(t){var e=this,n=$.Deferred(),r=$.when(n).then((function(){return e.Form.getQuestionSyncBlocker(r)})).then(t);return n.resolve(),r},n.createUploadSyncJob=function(t){var e=this,n=$.Deferred(),r=$.when(n,this.St).then((function(){return e.createSyncJob(t)}));return n.resolve(),this.St=Object(f.a)(r),r},n.getMethodDelegator=function(){var t=this.Model.Type;this.It=this.It||(this.It={});var e=this.It[t];e||(e=new(function(t){switch(t){case"Question.Choice":return N.a;case"Question.TextField":return q;case"Question.DateTime":return C;case"Question.Rating":return E;case"Question.Ranking":return R;case"Question.MatrixChoice":return M;case"Question.MatrixChoiceGroup":return L;case"Question.NPS":return D;case"Question.FileUpload":return x;default:throw Error(t+" is not supported")}}(t))(this),this.It[t]=e);return e},n.getChoiceById=function(t){var e=o.a.Collection.getItemWithKeyFields(this.Model.ChoiceGroup,{Id:t});return e&&o.a.getObjectMasterFromModel(e)},n.getChoiceByKey=function(t){var e=i.find(this.Model.ChoiceGroup,(function(e){return e.Key===t}));return e&&function(t){return o.a.getObjectMasterFromModel(t)}(e)},n.Ot=function(t){this.Ft=new g.a(this,e.Schema.QuestionInfo,e.QuestionInfoFieldSet),t.InitialData&&this.isFieldReady(e.Schema.QuestionInfo)&&(t.ExistingInDataSource||t.InitialData.QuestionInfo?this.Ft.deserialize():this.Ft.serialize()),this.justifyQuestionInfo()},n.jt=function(t){!t.ExistingInDataSource&&t.InitialData.FileUploadSPOInfo&&(this.Model.FileUploadSPOInfo=null)},n.hasRuntimeError=function(){var t=this.Model.FileUploadSPOInfo;return!!t&&!(!this.Form.SettingMaster.Model.IsAnonymous||!t.anonymousLinkInfo)},n.wt=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(e,"QuestionInfoFieldSet",{get:function(){return e.questionInfoFieldSet||(e.questionInfoFieldSet=new p.a([e.Schema.VideoInfo,e.Schema.ShowSubtitle,e.Schema.Hidden,e.Schema.BranchInfo,e.Schema.ShowRatingLabel,e.Schema.Point,e.Schema.FormsProCalculateSentiment,e.Schema.ImageSettings,e.Schema.GradingBasis,e.Schema.ChoiceType,e.Schema.Choices,e.Schema.Hint,e.Schema.AllowOtherAnswer,e.Schema.OptionDisplayStyle,e.Schema.ShuffleOptions,e.Schema.BranchInfoForOtherChoice,e.Schema.Length,e.Schema.RatingShape,e.Schema.LeftDescription,e.Schema.RightDescription,e.Schema.Multiline,e.Schema.IsNumber,e.Schema.Placeholder,e.Schema.NumberValidationRule,e.Schema.NumberMinBoundary,e.Schema.NumberMaxBoundary,e.Schema.Date,e.Schema.Time,e.Schema.IsMathQuiz,e.Schema.IsPlainTextInMathField,e.Schema.IsAnswerPlainText,e.Schema.InputSwitcherDisabled,e.Schema.IsMathInputDefault,e.Schema.MathPatterns,e.Schema.MathAriaLabels,e.Schema.HasSpecificFileType,e.Schema.FileTypes,e.Schema.MaxFileCount,e.Schema.MaxFileSize,e.Schema.MinRating,e.Schema.FormsProRTLeftDescription,e.Schema.FormsProRTRightDescription,e.Schema.FormsProEnableAnswerTag,e.Schema.FormsProAnswerTag,e.Schema.FormsProAnswerTagHasError,e.Schema.HasTFRestrictionForPro,e.Schema.FormsProValidationType,e.Schema.FormsProCustomRegEx,e.Schema.FormsProCustomPlaceholder,e.Schema.FormsProSmileyList])),e.questionInfoFieldSet},enumerable:!0,configurable:!0}),e.resolveQuestionNullTypeIssue=function(t){if(!t.Type){var e={choiceType:t.ChoiceType,date:t.Date,time:t.Time,ratingShape:t.RatingShape,multiline:t.Multiline};t.Type=null!=e.choiceType?"Question.Choice":null!=e.date||null!=e.time?"Question.DateTime":e.ratingShape?"Question.Rating":"Question.TextField",h.a.logData({errorName:"QuestionNullTypeError",errorInfo:{message:"question type resolved",conditions:e,resolvedType:t.Type}})}},e.getSourceFields=function(t){return i.uniq(t.map((function(t){return e.QuestionInfoFieldSet.covers(t)?e.Schema.QuestionInfo:t})))},e}(o.a.createObjectMasterClass("QuestionMaster",K,(function(t,e){return new Q(t,e)})));Object.keys({verify:null,isEmpty:null,getTypeDisplayName:null,getBranchedResult:null,isNumberType:null,resetBranchInfo:null,getNormalizedAnswer:null,hasAnswer:null,justifyNumberBoundaries:null,getNumberValidationErrorMessage:null,getValidationErrorMessage:null,supportsQuestionLevelBranching:null,supportsChoiceLevelBranching:null,getSnapshotWithoutBranchInfo:null,insertChoice:null,setAnswerKey:null,createQuizResult:null,autoGradeAnswer:null,autoGradeWithQuizResult:null,serializeAnswer:null,deserializeAnswer:null,justifyQuestionInfo:null,showAsDropdown:null,hasCorrectAnswers:null,isCorrectAnswer:null,redressGradingBasis:null}).forEach((function(t){Y.prototype[t]=function(){var e=this.getMethodDelegator();return e[t].apply(e,arguments)}}))},,function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=function(){function t(){this.yt=!1,this.Nt=!1}var e=t.prototype;return e.UsingSingleton=function(t){return this.kt(t,!0)},e.UsingFactory=function(t){return this.kt(t,!1)},e.Create=function(){return this.yt?(this.Tt||(this.Tt=this.Ct()),this.Tt):this.Ct()},e.kt=function(t,e){return this.yt=e,this.Pt=t,this},e.Ct=function(){if(this.Nt)throw Error("Circular dependency detected ");this.Nt=!0;var t=this.Pt();return this.Nt=!1,t},t}(),i=function(){function t(){this.xt={}}var e=t.prototype;return e.Add=function(t,e){this.xt[t]=e},e.Get=function(t){return this.xt[t]},t}(),o=new(function(){function t(){this.Mt=new i}var e=t.prototype;return e.Resolve=function(t){var e,n=this.Mt.Get(t);if(!n)throw Error("Failed to resolve "+t+", make sure you have registered it by calling Register()");try{e=n.Create()}catch(e){throw Error("Exception when resolving "+t+": "+e)}return e},e.Register=function(t){if(this.Mt.Get(t))throw Error("Duplicate registration of "+t);var e=new r;return this.Mt.Add(t,e),e},t}())},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"j",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"i",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"e",(function(){return a})),n.d(e,"g",(function(){return f})),n.d(e,"b",(function(){return l})),n.d(e,"h",(function(){return h})),n.d(e,"c",(function(){return d}));var r=n(20);function i(){return r.a.Resolve("IMixin").getMixinFormMaster()}function o(){return r.a.Resolve("IMixin").getMixinFormMaster()}function c(){return r.a.Resolve("IMixin").getMixinImageInfoMaster()}function s(){return r.a.Resolve("IMixin").getMixinQuestionMaster()}function u(){return r.a.Resolve("IFormApiMixin").getMixinFormApi()}function a(){return r.a.Resolve("IMixin").getMixinFormElementManager()}function f(){return r.a.Resolve("IMixin").getMixinImageSettingsMaster()}function l(){return r.a.Resolve("IMixin").getMixinDesignPageUxStateMaster().getInstance()}function h(){return r.a.Resolve("IMixin").getMobileDesignPageUxStateMaster().getInstance()}function d(){return r.a.Resolve("IMixin").getFileUploadConfirmDialog()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(17),i=function(){function t(){}t.prototype;return t.logData=function(t){Object(r.a)({eventName:t.name,eventType:"engagement_event",extraData:t.extraData})},t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return s}));n(4);var r=n(48),i=n(31),o=(n(22),n(12));n(55);function c(t){if(!t.isFieldReady(o.a.Schema.OwnerTenantId)||!t.isFieldReady(o.a.Schema.OwnerId))return i.a.getInstance().createDataProvider();var e=1;if(t.IsGroupForm)e=3;else{if(!t.Model.OwnerTenantId||!t.Model.OwnerId)return null;e=2}return i.a.getInstance().createDataProvider(e,t.Model.OwnerTenantId,t.Model.OwnerId)}function s(t){var e=Object(r.a)(t),n=1;return e.IsGroupOwner?n=3:e.OrgId&&e.OwnerId&&(n=2),i.a.getInstance().createDataProvider(n,e.OrgId,e.OwnerId)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return u}));var r=n(2),i=n(0),o=n(3),c=n(8);function s(t){return i.createElement(u,Object(r.a)({},t))}var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=o.clone(this.props.HTMLAttributes)||{};return t.className=Object(c.a)("ms-Icon",this.props.IconName?"ms-Icon--"+this.props.IconName:"",t.className),this.props.Accessible||(t.role="presentation",t["aria-hidden"]="true"),i.createElement("i",Object(r.a)({},t))},e}(n(16).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(20);function i(){return r.a.Resolve("IPageContext")}},function(t,e){t.exports=ReactDOM},function(t,e,n){"use strict";n.d(e,"j",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"e",(function(){return s})),n.d(e,"k",(function(){return u})),n.d(e,"h",(function(){return a})),n.d(e,"g",(function(){return f})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return h})),n.d(e,"i",(function(){return d})),n.d(e,"l",(function(){return m}));n(25),n(7),n(5);function r(){return 1e3}function i(){return 4e3}function o(){return 1e3}function c(){return 800}function s(){return 600}function u(){return 719}function a(){return 320}function f(){return 240}function l(){return 422}function h(){return 5242880}function d(){return 3e3}function m(){return/^[\w+!#$%&'*+-/=?^_`{|}~.]+@[\w+.-]+\.[\w+.]+$/}},function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"e",(function(){return a})),n.d(e,"a",(function(){return f}));var r=n(71);function i(t){return l().then((function(){window.location.assign(t)}))}function o(){return s(!1)}function c(){return s(!0)}function s(t){return l().then((function(){window.location.reload(t)}))}function u(t){return l().then((function(){window.location.replace(t)}))}function a(t){return l().then((function(){var e=window.location,n=e.origin+t+e.search+e.hash;window.location.replace(n)}))}function f(t){h.push(t)}function l(){var t=h;h=[];var e=$.when.apply($,t.map((function(t){return Object(r.a)(t())})));return h.push((function(){return e})),e}var h=[]},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return h})),n.d(e,"d",(function(){return d})),n.d(e,"g",(function(){return m})),n.d(e,"j",(function(){return b})),n.d(e,"f",(function(){return v})),n.d(e,"l",(function(){return g})),n.d(e,"h",(function(){return p})),n.d(e,"i",(function(){return O})),n.d(e,"c",(function(){return j})),n.d(e,"k",(function(){return w})),n.d(e,"e",(function(){return S}));var r,i=n(5),o=n(15);!function(t){t[t.signup=1]="signup"}(r||(r={}));var c,s,u,a="auth_pvr",f=!1;function l(){return u||h()}function h(){var t=u||Object(o.c)().Host||Object(o.b)().Host;switch(t){case"OneNote":case"OneNoteUwp":case"Outlook":case"Teams":case"Excel":case"OneDrive":case"Excel_Win32":case"PowerPointContent":case"PowerPointTaskpane":case"Assignments":case"ProjectShimla":case"Stream":case"StreamMobile":case"Union":case"ODC":return t;default:return null}}function d(){return c||Object(o.c)().groupId||Object(o.b)().groupId}function m(){return s||Object(o.c)().tid||Object(o.b)().tid}function b(){return!!h()||!!Object(i.a)().isOembedSPO}function v(){var t=Object(o.c)().route;if(t){var e=t.toLowerCase();switch(e){case"start":case"appitems":case"groupitems":return e;default:return}}}function g(){return"Teams"===l()&&"undefined"!=typeof microsoftTeams}function p(){return"Assignments"===l()}function O(){return"/pages/assignmentsdesignpage.aspx"===window.location.pathname.toLowerCase()||"/pages/assignmentsresponsepage.aspx"===window.location.pathname.toLowerCase()}function j(){return g()||p()||"Stream"===l()||"StreamMobile"===l()}function w(){return"PowerPointTaskpane"===l()||"PowerPointContent"===l()}function S(){return f}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(3);function i(){return t=[c()+c(),c(),c(),c(),c()+c()+c()].join("-"),e=parseInt(t.charAt(19),16),n=(e=3&e|8).toString(16),t=s(t,14,"4"),t=s(t,19,n);var t,e,n}function o(t){var e=t.match(/[0-9a-fA-F]*/g),n="";return r.map(e,(function(t){return n+=t})),!t||/^[0-]*$/.test(t)}function c(){return function(t,e,n){for(var r=t.length,i=n.length;r<e;r+=i)t=n+t;return t}(Math.floor(65536*Math.random()).toString(16),4,"0")}function s(t,e,n){return t.substring(0,e)+n+t.substring(e+1)}},function(t,e,n){"use strict";var r=n(11),i=n(5),o=n(21),c=n(7),s=n(56),u=n(9),a=n(46),f=n(30),l=n(28),h=n(25),d=n(78),m=n(58),b=function(){function t(t){for(this.Lt=t.trim();"/"===this.Lt.charAt(this.Lt.length-1);)this.Lt=this.Lt.substr(0,this.Lt.length-1)}var e=t.prototype;return e.deleteQuestionImage=function(e,n,r){var i=this;return this.Dt().then((function(o){return t.deleteImageInternal(o,i.Rt(t.getQuestionImageUrl(e,n,r)))}))},e.uploadQuestionImage=function(e,n,r,i){var o=this;return this.Dt().then((function(c){return t.uploadImageInternal(c,o.Rt(t.getQuestionImageUrl(e,n,r)),r,i)}))},e.deleteFormImage=function(e,n){var r=this;return this.Dt().then((function(i){return t.deleteImageInternal(i,r.Rt(t.getFormImageUrl(e,n)))}))},e.uploadFormImage=function(e,n,r){var i=this;return this.Dt().then((function(o){return t.uploadImageInternal(o,i.Rt(t.getFormImageUrl(e,n)),n,r)}))},t.getFormImageUrl=function(e,n){return t.formImageUrlPattern.format(e,n)},t.getQuestionImageUrl=function(e,n,r){return t.questionImageUrlPattern.format(e,n,r)},t.deleteImageInternal=function(e,n){var r=new d.a("Image.Delete");r.start();var i={type:"DELETE",url:n,headers:{Authorization:e?"Bearer "+e:"","X-CorrelationId":r.CorrelationId,"X-UserSessionId":Object(m.b)()}};return t.sendRequest(i,(function(){return r.end({resultType:"Success"})}),(function(t){var e={correlationId:r.CorrelationId,innerCode:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.code,statusCode:t.status,innerMessage:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.message,statusText:t.statusText};return r.end({resultType:"Failure",extraData:{imageUrl:n,error:e}}),e}))},t.uploadImageInternal=function(e,n,r,i){var o=new d.a("Image.Upload");o.start();var c={type:"PUT",url:n,headers:{Authorization:e?"Bearer "+e:"","Content-Type":i.ImageType,"Content-Disposition":"attachment; name={0}; filename={1}".format(Object(f.b)(),i.ImageName),"X-CorrelationId":o.CorrelationId,"X-UserSessionId":Object(m.b)()},processData:!1,data:i.ImageBlob};return t.sendRequest(c,(function(t){if(!t||!t.resourceId){var e={correlationId:o.CorrelationId,innerCode:5200,statusCode:0,innerMessage:"Upload image return bad response",statusText:"CollabDb bad response"};return o.end({resultType:"Failure",extraData:{imageUrl:n,error:e,imageType:r}}),$.Deferred().reject(e).promise()}o.end({resultType:"Success",extraData:{imageType:r}});var i={};return i.altText=t.altText,i.contentType=t.contentType,i.fileIdentifier=t.fileIdentifier,i.originalFileName=t.originalFileName,i.resourceId=t.resourceId,i.resourceUrl=t.resourceUrl,i.height=t.height,i.width=t.width,i}),(function(t){var e={correlationId:o.CorrelationId,innerCode:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.code,statusCode:t.status,innerMessage:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.message,statusText:t.statusText};return o.end({resultType:"Failure",extraData:{imageUrl:c.url,error:e}}),e}))},t.sendRequest=function(t,e,n){return Object(u.b)("CookieAuth")&&(t.headers.__RequestVerificationToken=Object(i.a)().antiForgeryToken),$.ajax(t).then(e,(function(r){if(!Object(s.c)(r))return n(r);Object(h.a)().AuthContext.refreshToken().done((function(){Object(a.e)((function(){return t.headers.__RequestVerificationToken=Object(i.a)().antiForgeryToken,$.ajax(t).then(e,n)}),(function(){return Object(l.d)()}))}))}))},e.Dt=function(){return Object(h.a)().AuthContext.getFormApiToken()},e.Rt=function(t){return this.Lt+"/"+t},t.formImageUrlPattern="forms('{0}')/{1}",t.questionImageUrlPattern="forms('{0}')/questions('{1}')/{2}",t}();n.d(e,"a",(function(){return v})),n.d(e,"b",(function(){return g}));var v=function(){function t(){if(t.instance)return t.instance;t.instance=this,this.Et=Object(r.d)()}var e=t.prototype;return t.getInstance=function(){return new t},e.getOwnerServiceUrl=function(t,e,n){return 1===t?this.getFormApiServiceUrl():4===t?this.getFormApiServiceUrl()+"me/":e&&n?this.getFormApiServiceUrl()+e+(3===t?"/groups/":"/users/")+n+"/":null},e.createDataProvider=function(t,e,n){void 0===t&&(t=1),void 0===e&&(e=null),void 0===n&&(n=null);var r=Object(o.d)();if(1===t)return this.defaultDataProvider||(this.defaultDataProvider=new r(this.getFormApiServiceUrl(),this.getFormApiServiceUrl())),this.defaultDataProvider;var i=this.getOwnerServiceUrl(t,e,n);return i&&new r(this.getFormApiServiceUrl(),i)},e.createImageProvider=function(t,e,n){if(void 0===t&&(t=1),void 0===e&&(e=null),void 0===n&&(n=null),1===t)return this.currentImageProvider||(this.currentImageProvider=new b(this.getFormApiServiceUrl())),this.currentImageProvider;var r=this.getOwnerServiceUrl(t,e,n);return r&&new b(r)},e.getFormApiServiceUrl=function(){return this.getServiceUrl("formapi/api/")},e.getCollabDBServiceUrl=function(){var t;return t=Object(r.q)()?Object(r.d)():Object(r.e)(),Object(r.c)(t)},e.getBaseServiceUrl=function(){if(!Object(r.q)())return"https://forms.office-int.com/";var t;switch(this.Et){case"USDoDProd":t="https://forms.osi.apps.mil/";break;case"USGovProd":t="https://forms.osi.office365.us/";break;case"USGovGccProd":t=Object(r.o)()?"https://forms.microsoft.com/":"https://forms.office.com/";break;case"WWProd":t=Object(c.c)((function(){return"https://forms.office.com/"}),c.e);break;case"MSProd":t="https://forms.microsoft.com/";break;case"ProTip":t="https://tip.forms.office.com/";break;default:t="https://"+window.location.host+"/"}return t},e.getServiceUrl=function(t){return this.getBaseServiceUrl()+t},t}();function g(){return v.getInstance().createDataProvider()}},function(t,e,n){"use strict";var r=n(2),i=n(3),o=n(4),c=n(1),s=n(19),u=n(30),a=n(21),f=n(31),l=n(35),h=n(47),d=n(12),m=n(18),b=n(23),v=function(){function t(t,e){this.At=t;var n,r=this.At.Parent;if(r instanceof d.a)n=r;else{if(!(r instanceof m.d||r instanceof h.a))throw"Wrong parent type of ImageInfoMaster.";n=r.Form}var i=n.IsGroupForm?3:2;this.I=Object(b.b)(n),this._t=f.a.getInstance().createImageProvider(i,n.Model.OwnerTenantId,n.Model.OwnerId);var c=o.a.getFieldSchemaInfo(t.Membership.FieldSchema);this.Ut=c.Attributes.SourceFieldName||c.Name}var e=t.prototype;return e.add=function(t){var e=$.Deferred();return window.setTimeout((function(){e.resolve()})),e.promise()},e.delete=function(t){return Object(s.b)("not supported")},e.query=function(t){return Object(s.b)("not supported")},e.update=function(t){var e,n=t.uploadParameters;return n?(n.Delete?e=this.$t():n.ImageFile?e=this.Bt(n.ImageFile):n.Url&&(e=this.qt(n.Url,n.Size)),e?e.then((function(t){var e=i.clone(t);return e.uploadParameters=null,e})):void 0):this.Qt()},e.Qt=function(){var t=this,e=o.a.convertToSourceData(this.At.getSnapshot(),Object(a.f)().Schema);delete e.uploadParameters;var n,r={};r[this.Ut]=e;var i=this.At.Parent;if(i instanceof d.a)n=this.I.updateForm(i.Model.Id,r);else{if(!(i instanceof m.d||i instanceof h.a))return Object(s.b)("not supported");var c=i;n=c.createUploadSyncJob((function(){return t.I.updateFormQuestion(c.Form.Model.Id,c.Model.Id,c.Model.Type,r)}))}return n.then((function(e){return e&&e[t.Ut]}))},e.qt=function(t,e){var n=this,r={SourceUrl:t,Title:Object(u.b)(),Size:e},i=this.At.Parent;if(i instanceof d.a)return this.I.createFormImageFromUrl(i.Model.Id,this.Ut,r);if(i instanceof m.d||i instanceof h.a){var o=i;return o.createUploadSyncJob((function(){return n.I.createQuestionImageFromUrl(o.Form.Model.Id,o.Model.Id,r)}))}return Object(s.b)("not supported")},e.Bt=function(t){var e=this,n={ImageBlob:t,ImageName:Object(u.b)(),ImageType:t.type},r=this.At.Parent;if(r instanceof d.a)return this._t.uploadFormImage(r.Model.Id,this.Ut,n);if(r instanceof m.d||r instanceof h.a){var i=r;return i.createUploadSyncJob((function(){return e._t.uploadQuestionImage(i.Form.Model.Id,i.Model.Id,e.Ut,n)}))}return Object(s.b)("not supported")},e.$t=function(){var t,e=this,n=this.At.Parent;if(n instanceof d.a)t=this._t.deleteFormImage(n.Model.Id,this.Ut);else{if(!(n instanceof m.d||n instanceof h.a))return Object(s.b)("not supported");var r=n;t=r.createUploadSyncJob((function(){return e._t.deleteQuestionImage(r.Form.Model.Id,r.Model.Id,e.Ut)}))}return t.then(null,(function(t){return t&&805===t.innerCode?(l.a.logData({errorName:"DeleteImageNotFoundError",errorInfo:{imageUrl:e.At.Model.ResourceUrl}}),$.Deferred().resolve().promise()):t})).then((function(){return{altText:null,contentType:null,fileIdentifier:null,height:null,imageFile:null,originalFileName:null,resourceId:null,resourceUrl:null,size:null,width:null}}))},t}(),g=n(44),p=n(49);n.d(e,"b",(function(){return O})),n.d(e,"d",(function(){return S})),n.d(e,"c",(function(){return I})),n.d(e,"a",(function(){return F}));var O,j,w={AltText:c.a.string({SourceFieldName:"altText"}),ContentType:c.a.string({SourceFieldName:"contentType"}),FileIdentifier:c.a.string({SourceFieldName:"fileIdentifier"}),OriginalFileName:c.a.string({SourceFieldName:"originalFileName"}),ResourceId:c.a.string({SourceFieldName:"resourceId"}),ResourceUrl:c.a.string({SourceFieldName:"resourceUrl"}),Width:c.a.number({SourceFieldName:"width"}),Height:c.a.number({SourceFieldName:"height"}),UploadParameters:c.a.reference({SourceFieldName:"uploadParameters"}),ErrorType:c.a.enumeration((function(){return j}),{IsLocalField:!0}),ResponseError:c.a.reference({IsLocalField:!0}),ImageProcessingStatus:c.a.enumeration((function(){return O}),{IsLocalField:!0}),IsPredefined:c.a.boolean({IsLocalField:!0}),SavingState:c.a.reference({IsLocalField:!0})};function S(t){if(!t)return!1;if(t.ResourceUrl)return!0;var e=t.UploadParameters;return!!e&&!!e.ImageFile}function I(t){return o.a.getObjectMasterFromModel(t)}!function(t){t[t.Idle=0]="Idle",t[t.Picking=1]="Picking",t[t.Uploading=2]="Uploading",t[t.Deleting=3]="Deleting"}(O||(O={})),function(t){t[t.NoError=0]="NoError",t[t.SizeTooLarge=1]="SizeTooLarge",t[t.InvalidType=2]="InvalidType",t[t.BrokenImage=3]="BrokenImage",t[t.ServerError=4]="ServerError",t[t.DeleteFailError=5]="DeleteFailError"}(j||(j={}));var F=function(t){function e(e){var n=this,r=$.Deferred(),o=!e.ExistingInDataSource&&e.InitialData&&!!e.InitialData.ResourceUrl,c=i.clone(e.InitialData);(e=i.clone(e)).InitialData=o?i.extend({},c,{ImageProcessingStatus:O.Uploading}):i.extend({},c,{UploadParameters:null,ErrorType:j.NoError,ResponseError:null,ImageProcessingStatus:O.Idle,Width:null,Height:null});var s=new g.a;s.setMaxRetryTimesForUpdate(0);var u=(n=t.call(this,e,{Scheduler:s,MasterReady:r.promise()})||this).Synchronizer;return u.observe((function(t){var e;i.contains(t.FieldSchemas,u.Schema.CreationError)?e=u.Model.CreationError:i.contains(t.FieldSchemas,u.Schema.UpdateError)&&(e=u.Model.UpdateError),e&&n.bulkEdit((function(){n.Model.ResponseError=e;var t=n.Model.UploadParameters;t&&t.Delete?n.Model.ErrorType=j.DeleteFailError:n.Model.ErrorType=j.ServerError}))}),[u.Schema.CreationError,u.Schema.UpdateError]),n.addRule({InterestedFields:[n.Schema.ResourceId],Name:"ResetErrorStatus",onChange:function(t){!t.BeingDeleted&&n.Model.ResourceId&&n.resetStatus(O.Idle)}}),n.initializing=r,n.duplicatingImage=o,n.originalInitialData=c,Object(p.b)(n),n}Object(r.c)(e,t);var n=e.prototype;return n.getSettingsMaster=function(){return this.zt},n.setSettingsMaster=function(t){this.zt=t},n.resetStatus=function(t){var e=this.Model;this.bulkEdit((function(){e.ErrorType=j.NoError,e.ResponseError=void 0,e.ImageProcessingStatus=t}))},e}(o.a.createObjectMasterClass("ImageInfoMaster",w,(function(t,e){return new v(t,e)})))},function(t,e,n){"use strict";var r,i,o,c;n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return m}));var s=null,u=null;function a(){return r||(r=f())instanceof b&&(r=l()),r}function f(){return i||(i=d()?window.localStorage:h()),i}function l(){return o||(o=m()?window.sessionStorage:h()),o}function h(){return c||(c=new b),c}function d(){if(null==s)try{var t="officeforms.__storage_test__";window.localStorage.setItem(t,t),window.localStorage.removeItem(t),s=!0}catch(t){s=!1}return s}function m(){if(null==u)try{var t="officeforms.__storage_test__";window.sessionStorage.setItem(t,t),window.sessionStorage.removeItem(t),u=!0}catch(t){u=!1}return u}var b=function(){function t(){}var e=t.prototype;return e.clear=function(){},e.getItem=function(t){},e.key=function(t){return null},e.removeItem=function(t){},e.setItem=function(t,e){},t}()},function(t,e,n){"use strict";n.d(e,"g",(function(){return c})),n.d(e,"a",(function(){return s})),n.d(e,"f",(function(){return u})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return f})),n.d(e,"e",(function(){return l})),n.d(e,"b",(function(){return h}));var r=n(11),i=n(48),o=null;function c(t){o=t}function s(){return o&&o()}function u(t){t}function a(){var t=Object(i.a)(s()||"");return!!t.OrgId&&t.OrgId.toLowerCase()===Object(r.l)()}function f(){var t=Object(i.a)(s()||"");return!!t.OrgId&&t.OrgId.toLowerCase()===Object(r.k)()}function l(){var t=Object(i.a)(s()||"");return!!t.OrgId&&-1!==Object(r.g)().indexOf(t.OrgId.toLowerCase())}function h(){var t=s();return t&&Object(i.a)(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(17),i=function(){function t(){}t.prototype;return t.logData=function(t){Object(r.a)({eventName:t.errorName,eventType:"error_event",extraData:t.errorInfo})},t}()},function(t,e,n){"use strict";var r=n(2),i=n(3),o=n(4),c=n(1),s=n(44),u=n(68),a=n(69),f=n(100),l=n(23),h=n(14),d=function(){function t(t){this.W=t,this.I=Object(l.b)(this.W.Form)}var e=t.prototype;return e.add=function(t){var e=this;if(this.W.Form.SyncContext!==h.a.DesignTimeForm)return $.Deferred().resolve().promise();var n=this.W.QuestionId;if(n){var r=this.W.Form.getQuestionById(n).getChoiceByKey(this.W.Model.key||"");if(r)return r.Synchronizer.existingInDataSource().then((function(){var n=r.Model.Id.toString();e.W.Model.choiceId=n;var i={elementKey:"choiceid_"+n,elementValue:t.description,locale:e.W.LocaleId,questionId:e.W.QuestionId};return Object(f.a)(i,e.W.FormId).then((function(){return{choiceId:n,description:t.description}}))}))}return $.Deferred().reject().promise()},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||this.W.Form.SyncContext!==h.a.DesignTimeForm)return $.Deferred().resolve().promise();if(t.choiceId||void 0===t.description)throw Error("No valid payload to update.");var n={elementKey:"choiceid_"+this.W.ChoiceId,elementValue:t.description,locale:this.W.LocaleId,questionId:this.W.QuestionId};return null!==e.ValuesBefore.description?this.I.updateLocaleItem(this.W.FormId,n):this.I.createLocaleItem(this.W.FormId,n)},t}(),m={choiceId:c.a.string({IsKeyField:!0}),description:c.a.string(),key:c.a.string({IsLocalField:!0})},b=function(t){function e(e){var n=t.call(this,e)||this;if(!n.Model.key){if(!n.Model.choiceId)throw Error("Current choice localized master doesn't has key and choiceId.");e.MasterTreeReady&&e.MasterTreeReady.then((function(){return n.Form.fieldsReady([n.Form.Schema.Questions])})).done((function(){var t=n.Form.getQuestionById(n.QuestionId).getChoiceById(Number(n.Model.choiceId));t&&(n.Model.key=t.Model.Key)}))}return n}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"QuestionLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Form",{get:function(){return this.QuestionLocalizedMaster.Form},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.QuestionLocalizedMaster.Model.questionId},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LocaleId",{get:function(){return this.QuestionLocalizedMaster.Model.localeId},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ChoiceId",{get:function(){return this.Model.choiceId},enumerable:!0,configurable:!0}),e}(o.a.createObjectMasterClass("ChoiceLocalizedItemMaster",m,(function(t){return new d(t)}))),v=n(54),g=function(){function t(t){this.W=t,this.I=Object(l.b)(this.W.Form)}var e=t.prototype;return e.add=function(t){var e=this;if(this.W.Form.SyncContext!==h.a.DesignTimeForm)return $.Deferred().resolve().promise();var n=this.W.QuestionId;if(n){var r=this.W.Form.getElementById(n);if(r)return r.Synchronizer.existingInDataSource().then((function(){var n,r=[];for(n in t)if(t.hasOwnProperty(n)){var o=Object(v.f)(i.pick(t,[n]));o.elementKey&&(o.locale=e.W.Model.localeId,o.questionId=e.W.QuestionId,r.push(Object(f.a)(o,e.W.FormId)))}return $.when.apply($,r).then((function(t){}))}))}return $.Deferred().reject().promise()},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||this.W.Form.SyncContext!==h.a.DesignTimeForm)return $.Deferred().resolve().promise();var n,r=[];for(n in t)if(t.hasOwnProperty(n)){var o=null!==e.ValuesBefore[n],c=Object(v.f)(i.pick(t,[n]));c.locale=this.W.Model.localeId,c.questionId=this.W.QuestionId,r.push(o?this.I.updateLocaleItem(this.W.FormId,c):this.I.createLocaleItem(this.W.FormId,c))}return $.when.apply($,r).then((function(t){}))},t}();n.d(e,"a",(function(){return O}));var p={choices:c.a.collectionOf((function(){return b})),choicesV1:c.a.collectionOf({choiceId:c.a.string({IsLocalField:!0}),description:c.a.string({SourceFieldName:"Description"}),formsProDisplayRTText:c.a.string({SourceFieldName:"FormsProDisplayRTText"})},{IsLocalField:!0}),formsprortlocaleldescription:c.a.string(),formsprortlocalerdescription:c.a.string(),formsprortlocalesubtitle:c.a.string(),formsprortlocaletitle:c.a.string(),leftDescription:c.a.string(),localeId:c.a.string({IsKeyField:!0}),localeName:c.a.string(),option:c.a.string(),questionId:c.a.string({IsKeyField:!0}),rightDescription:c.a.string(),subtitle:c.a.string(),title:c.a.string()},O=function(t){function e(e){var n=this,r=$.Deferred();return(n=t.call(this,e,{MasterReady:r.promise(),Scheduler:new s.a})||this).Ht(e),r.resolve(),n}Object(r.c)(e,t);var n=e.prototype;return e.handleChoicesV1Deleted=function(t,e,n){t<0||i.forEach(n.Model.LocalizedResources,(function(n){i.filter(n.questionResources,(function(t){return t.questionId===e})).forEach((function(e){e.choicesV1.length>t&&o.a.Collection.itemsDeletedInSource(e.choicesV1,[e.choicesV1[t]])}))}))},e.handleChoicesV1Exchange=function(t,e,n,r){i.forEach(r.Model.LocalizedResources,(function(r){o.a.getCollectionMasterFromModel(r.questionResources).bulkEdit((function(r){i.filter(r,(function(t){return t.questionId===n})).forEach((function(n){var r,o,c=n.choicesV1;for(t>e?(r=e,o=t):(r=t,o=e);c.length<=o+1;)Object(v.b)(n);var s=i.map(c,(function(t){return t.description})),u=s.splice(t,1);s.splice(e,0,u[0]);for(var a=r;a<=o;++a)c[a].description=s[a]}))}))}))},Object.defineProperty(n,"Form",{get:function(){return this.FormLocalizedMaster.Form},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FormLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.Model.questionId},enumerable:!0,configurable:!0}),n.getChoiceLocalizedMaster=function(t){var e=this,n=i.find(this.Form.Model.Questions,(function(t){return t.Id===e.QuestionId}));if(n){var r=i.find(n.ChoiceGroup,(function(e){return e.Id.toString()===t}));if(r){var c=o.a.Collection.getItemWithKeyFields(this.Model.choices,{choiceId:t});return c?o.a.getObjectMasterFromModel(c):Object(v.a)(t,r.Key,this.Model)}}throw Error("Question or Chocie don't exist for localization.")},n.getChoiceV1LocalizedMaster=function(t){var e=this,n=i.find(this.Form.Model.Questions,(function(t){return t.Id===e.QuestionId}));if(n&&n.Choices.length>t){for(;this.Model.choicesV1.length<n.Choices.length;)Object(v.b)(this.Model);return o.a.getObjectMasterFromModel(this.Model.choicesV1[t])}return null},n.Ht=function(t){e.Schema.option&&(this.Vt=new u.a(this,e.Schema.option,e.ChoicesV1FieldSet),t.InitialData&&this.isFieldReady(e.Schema.option)&&(t.ExistingInDataSource||t.InitialData.option?this.Vt.deserialize():this.Vt.serialize()))},Object.defineProperty(e,"ChoicesV1FieldSet",{get:function(){return e.choicesV1FieldSet||(e.choicesV1FieldSet=new a.a([e.Schema.choicesV1])),e.choicesV1FieldSet},enumerable:!0,configurable:!0}),e}(o.a.createObjectMasterClass("QuestionLocalizedItemMaster",p,(function(t){return new g(t)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0),i=n(6),o={};Object.defineProperty(o,"LocalizedStrings",{get:i.a});var c=r.createContext(o)},function(t,e,n){"use strict";var r=n(2),i=n(0),o=i.PureComponent,c=i.Suspense,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=this.props,e=t.children,n=t.fallback;return i.createElement(c,{fallback:n},e)},e.defaultProps={fallback:null},e}(o);e.a=s},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3),i=n(4),o=function(){function t(t){this.Gt=t}var e=t.prototype;return t.supportMobileDesign=function(t){return!1},t.hasInvalidSettingOnMobile=function(t){return t.ShowSubtitle||!!t.ImageInfo.ResourceUrl||!!t.VideoInfo.Url},Object.defineProperty(e,"Master",{get:function(){return this.Gt},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Model",{get:function(){return this.Gt.Model},enumerable:!0,configurable:!0}),e.isEmpty=function(t){return!t},e.justifyNumberBoundaries=function(){throw Error("to be overridden")},e.supportsQuestionLevelBranching=function(){return!0},e.supportsChoiceLevelBranching=function(){return!1},e.getBranchedResult=function(t,e){var n=this.getBranchingResult(t);switch(n.Type){case"Next":n.TargetElement=e}return n},e.isNumberType=function(){return!1},e.getNumberValidationErrorMessage=function(t){throw Error("to be overridden")},e.getValidationErrorMessage=function(){throw Error("to be overridden")},e.getSnapshotWithoutBranchInfo=function(){var t=r.clone(this.Master.getSnapshot());return delete t.BranchInfo,delete t.BranchInfoForOtherChoice,t},e.resetBranchInfo=function(){this.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},e.insertChoice=function(t,e){},e.getNormalizedAnswer=function(t){return t},e.hasAnswer=function(){return!0},e.hasCorrectAnswers=function(t){return!1},e.isCorrectAnswer=function(t){return!1},e.setAnswerKey=function(t,e){},e.createQuizResult=function(t){return null},e.autoGradeAnswer=function(t){var e=!this.Model.Point,n=null==t.Answer||""===t.Answer;(e||n)&&(t.Score=0,t.IsAutoGraded=!0)},e.autoGradeWithQuizResult=function(t,e){var n=this.Master.Parent;return(n&&n.Model||this.Model).Point||(null==t||""===t)?0:null},e.serializeAnswer=function(t){return t},e.deserializeAnswer=function(t){return t},e.justifyQuestionInfo=function(){},e.showAsDropdown=function(){},e.redressGradingBasis=function(){},e.getBranchInfoMaster=function(t){return i.a.getObjectMasterFromModel(t)},e.getBranchingResult=function(t){return this.getBranchInfoMaster(this.Model.BranchInfo).getBranchingResult()},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return b})),n.d(e,"d",(function(){return v})),n.d(e,"b",(function(){return g}));var r,i,o=n(2),c=n(3),s=n(4),u=n(1),a=n(27),f=n(5),l=n(25),h=n(12),d=n(32),m={TargetResourceId:u.a.string(),Layout:u.a.enumeration((function(){return r})),Size:u.a.enumeration((function(){return i})),NaturalWidth:u.a.number(),NaturalHeight:u.a.number(),ContainerWidth:u.a.number(),ContainerHeight:u.a.number(),ActualWidth:u.a.number(),ActualHeight:u.a.number(),Left:u.a.number(),Top:u.a.number()};function b(t){return s.a.getObjectMasterFromModel(t)}function v(t,e,n){t.fieldsReady([e]).done((function(){var r=t.getModelByFieldSchema(e),i=Object(d.c)(r);t.ensureFieldsReady([n]).done((function(){var e=b(t.getModelByFieldSchema(n));i.setSettingsMaster(e)}))}))}!function(t){t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Square=3]="Square"}(r||(r={})),function(t){t[t.Small=1]="Small",t[t.Large=2]="Large"}(i||(i={}));var g=function(t){function e(e){var n=t.call(this,e)||this;return e.MasterTreeReady&&e.MasterTreeReady.done((function(){var t=n.Parent;t instanceof h.a&&t.fieldsReady([h.a.Schema.LogoInfo]).done((function(){t.Model.LogoInfo===n.Model&&(n.Wt=!0)}))})),n}Object(o.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"IsFormLogo",{get:function(){return this.Wt},enumerable:!0,configurable:!0}),n.validateImageSettings=function(t){var e=c.clone(this.getSnapshot());if(744===e.ContainerWidth&&(e.ContainerHeight=e.ContainerHeight*Object(a.k)()/e.ContainerWidth,e.ContainerWidth=Object(a.k)(),!t)){var n=this.Model;n.ContainerWidth=e.ContainerWidth,n.ContainerHeight=e.ContainerHeight}if(null==e.ContainerHeight||null==e.ContainerWidth||null==e.ActualHeight||null==e.ActualWidth||null==e.Top||this.IsFormLogo&&(120!==e.ContainerHeight||120!==e.ContainerWidth)||e.Left>0||e.ContainerWidth>e.Left+e.ActualWidth||e.Top>0||e.ContainerHeight>e.Top+e.ActualHeight){var r=this.getDefaultImageSettings();for(var i in r)e[i]=Math.round(r[i]),t||(this.Model[i]=e[i])}return e},n.calcLogoLayout=function(t){var e,n,i,o=(this.Model.NaturalWidth||Object(a.f)())/(this.Model.NaturalHeight||Object(a.e)()),c=(t=t||{}).isSmallSize,s=t.isMobile,u=t.isSlimSize;if(s)(n=(e=u?30:c?70:80)*o)>e?(n=(e=u?40:e)*o,i=r.Vertical):i=r.Horizontal;else{var f=void 0;c?(e=70,f=125):u?(e=40,f=95):(e=120,f=215),(n=e*o)>f?(n=(e=u?30:c?40:70)*o,i=r.Vertical):i=r.Horizontal}return{ActualWidth:n=Math.min(n,750),ActualHeight:e,Layout:i}},n.getDefaultImageSettings=function(){var t,e=this.Model;e.NaturalHeight&&e.NaturalWidth?t={NaturalHeight:e.NaturalHeight,NaturalWidth:e.NaturalWidth}:t={NaturalHeight:e.NaturalHeight||Object(a.e)(),NaturalWidth:e.NaturalWidth||Object(a.f)()};if((!Object(l.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")||!Object(f.a)().userInfo.IsMsa)&&this.IsFormLogo)return t;var n=this.Jt();if(null==n.Height?(t.ContainerWidth=n.Width,t.ContainerHeight=n.Width*t.NaturalHeight/t.NaturalWidth):null==n.Width?(t.ContainerWidth=n.Height*t.NaturalWidth/t.NaturalHeight,t.ContainerHeight=n.Height):(t.ContainerWidth=n.Width,t.ContainerHeight=n.Height),null==n.Height||null==n.Width)t.Left=0,t.Top=0,t.ActualWidth=t.ContainerWidth,t.ActualHeight=t.ContainerHeight;else{var r=Math.max(t.ContainerWidth/t.NaturalWidth,t.ContainerHeight/t.NaturalHeight);t.ActualWidth=r*t.NaturalWidth,t.ActualHeight=r*t.NaturalHeight,t.Left=(t.ContainerWidth-t.ActualWidth)/2,t.Top=(t.ContainerHeight-t.ActualHeight)/2}return t},n.Jt=function(){var t=this.Model;if(this.IsFormLogo)return{Height:120,Width:120};if(null==t.Size||t.Size===i.Small)switch(t.Layout){case r.Square:return{Width:314,Height:314};case r.Vertical:return{Height:314};case r.Horizontal:default:return{Width:314}}else switch(t.Layout){case r.Square:return{Width:414,Height:414};case r.Vertical:return{Height:414};case r.Horizontal:default:return{Width:Object(a.k)()}}},e}(s.a.createObjectMasterClass("ImageSettingsMaster",m))},function(t,e,n){"use strict";function r(t,e){return t&&e?t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate():void 0}function i(t,e){return t&&e?1e3*(60*(60*t.getHours()+t.getMinutes())+t.getSeconds())+t.getMilliseconds()-(1e3*(60*(60*e.getHours()+e.getMinutes())+e.getSeconds())+e.getMilliseconds()):void 0}function o(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Math.floor(Date.now())}n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"f",(function(){return u})),n.d(e,"c",(function(){return a})),n.d(e,"g",(function(){return f}));var r=n(33);function i(){return Object(r.d)()}function o(){return function(t){var e=Object(r.b)(),n=t+".timestamp",i=e.getItem(n),o=i&&JSON.parse(i);if(!o||Date.now()>o)return e.removeItem(n),e.removeItem(t),null;var c=e.getItem(t);return c&&JSON.parse(c)}("officeforms.auth.detectAADInProgress")}function c(t){!function(t,e,n){var i=t+".timestamp",o=Object(r.b)();e?(o.setItem(i,JSON.stringify(Date.now()+n)),o.setItem(t,JSON.stringify(e))):(o.removeItem(i),o.removeItem(t))}("officeforms.auth.detectAADInProgress",t,5e3)}function s(){return"true"===l("officeforms.auth.detectAADResult")}function u(t){h("officeforms.auth.detectAADResult",t?"true":null)}function a(){return!!l("officeforms.uselegacylogindomain")}function f(t){h("officeforms.uselegacylogindomain",t?"1":null)}function l(t){return Object(r.b)().getItem(t)}function h(t,e){e?Object(r.b)().setItem(t,e):Object(r.b)().removeItem("officeforms.uselegacylogindomain")}},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Desktop=0]="Desktop",t[t.Mobile=1]="Mobile",t[t.Auto=2]="Auto"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(71),i=function(){function t(t,e){var n=this;void 0===t&&(t=1e3),void 0===e&&(e=5e3),this.Kt=Number.MAX_VALUE,null==t&&(t=1e3),null==e&&(e=5e3),this.Xt=t,this.Yt=e,this.Zt=function(){return n.ee().resolve()}}var e=t.prototype;return e.scheduleUpdate=function(){if(this.ne)throw Error("Calling scheduleUpdate() before the previous one is resolved.");return this.ne=$.Deferred(),this.re=window.setTimeout(this.Zt,this.Xt),this.ie=window.setTimeout(this.Zt,this.Yt),this.ne.promise()},e.postponeUpdate=function(){if(!this.ne)throw Error("Calling postponeUpdate() before update scheduled.");window.clearTimeout(this.re),this.re=window.setTimeout(this.Zt,this.Xt)},e.cancelUpdate=function(){this.ee().reject()},e.setMaxRetryTimesForUpdate=function(t){this.Kt=t},e.ee=function(){window.clearTimeout(this.re),this.re=void 0,window.clearTimeout(this.ie),this.ie=void 0;var t=this.ne;return this.ne=void 0,t},e.retryForCreation=function(t){return t<3?Object(r.c)():Object(r.b)()},e.retryForUpdate=function(t){var e=this;if(t>=this.Kt)return Object(r.b)();var n=c;t<s&&(n=o*Math.pow(2,t)),this.ce=window.setTimeout((function(){e.ce=void 0,i.resolve()}),n);var i=$.Deferred();return i.promise()},e.cancelRetryForUpdate=function(){window.clearTimeout(this.ce),this.ce=void 0},t}(),o=2500,c=6e5,s=Math.log(c/o)/Math.log(2)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return h}));var r=n(11),i=n(9),o=n(15);function c(t,e){void 0===e&&(e=!1);var n=Object(o.c)()[t];return""===n||(n?(Array.isArray(n)&&(n=n[0]),e?"false"!==n.toLowerCase():"true"===n.toLowerCase()):e)}function s(){return c("d")}function u(){return c("oembedssotrial")&&Object(r.s)()||c("oembedsso")||c("powerappembed")}function a(){if(c("pptcontentsso")){var t=Object(o.c)().hostplatform;if("PC"===t)return!0;if("OfficeOnline"===t&&Object(i.b)("PPTContentAddinSSO"))return!0}return!1}function f(){return c("pptintegration")}function l(){return c("runtimeautorefresh")}function h(){return c("streamsso")}},function(t,e,n){"use strict";var r=n(3),i=(n(7),n(22)),o=n(78),c=n(58),s=n(11),u=n(5);function a(t,e,n){var r=void 0;t&&(r="lang="+t),p(Object(u.a)().isHashResourceEnabled?"GetHashResourceStrings":"GetResourceStrings",r,void 0,e,n)}function f(t,e){return a(Object(s.f)(),t,e)}function l(t,e){p("GetRefreshedAntiForgeryToken",void 0,void 0,(function(e){var n=Object(u.a)();n.antiForgeryToken=e,Object(u.b)(n),t&&t()}),e)}function h(t,e){p("GetUserInfo",void 0,void 0,(function(e){var n=Object(u.a)();n.userInfo=e,Object(u.b)(n),t&&t()}),e)}function d(t){return g("GetThemes",void 0,JSON.stringify({name:t||""}),void 0)}function m(t){return g("GetUserInfo",void 0,void 0,v(t)).then((function(t){if(t){var e=Object(u.a)();e.userInfo=t,Object(u.b)(e)}}))}function b(t){return g("GetFlights",void 0,void 0,v(t)).then((function(t){if(t){var e=Object(u.a)();e.flights=t,Object(u.b)(e)}}))}function v(t){return{Accept:"application/json",Authorization:t?"Bearer "+t:""}}function g(t,e,n,i){var s;s="/"===window.location.pathname?"/Default.aspx/"+t:window.location.pathname+"/"+t,e&&(s+="?"+e);var u=new o.a("PageMethod.{0}".format(t));return u.start(),i=r.extend({},i,{"X-CorrelationId":u.CorrelationId,"X-UserSessionId":Object(c.b)()}),$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:s,data:n||"{}",dataType:"json",headers:i}).then((function(t,e,n){return u.end({resultType:"Success",extraData:{status:e}}),t.d}),(function(e,n,r){return u.end({resultType:"Failure",extraData:{url:s,message:r}}),{message:r,name:"PageMethod CallWebMethod Failure: "+t}}))}function p(t,e,n,r,i){g(t,e,n,void 0).done(r).fail(i)}function O(t,e,n,r){var o=r||Object(s.f)()||navigator.language,c="https://uhf.microsoft.com/"+o+"/shell/xml/OfficeForms";t&&(c+="?"+t),$.ajax({type:"GET",url:c,dataType:"xml",success:function(t){e&&e(t)},error:function(r){i.a.logData({name:"Error.UHF.UniversalHeaderAndFooterError",extraData:{error:r}}),"en-us"!==o?O(t,e,n,"en-us"):n&&n(r)}})}n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return f})),n.d(e,"e",(function(){return l})),n.d(e,"g",(function(){return h})),n.d(e,"c",(function(){return d})),n.d(e,"h",(function(){return m})),n.d(e,"f",(function(){return b})),n.d(e,"d",(function(){return O}))},function(t,e,n){"use strict";var r=n(2),i=n(3),o=n(4),c=n(1),s=n(9),u=(n(6),n(21)),a=n(71),f=n(63),l=n(17),h=n(84),d=n(44),m=n(32),b=n(40),v=n(23),g=n(14),p=function(){function t(t,e){this.se=t,this.I=Object(v.b)(this.se.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.se.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ElementId",{get:function(){return this.se.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ElementType",{get:function(){return this.se.Model.Type},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ExtraQosData",{get:function(){var t=this.se.Form;return{WithSection:t.isFieldReady(t.Schema.DescriptiveElements)&&!!t.FormElementManager.SectionMasters.length}},enumerable:!0,configurable:!0}),e.add=function(t){var e=this;if(this.se.Form.SyncContext!==g.a.DesignTimeForm)throw Error("Trying to create an element without design type.");return this.se.createSyncJob((function(){return e.I.createFormDescriptiveElement(e.FormId,t,e.ExtraQosData)}))},e.delete=function(t){var e=this;if(!t||!t.id)throw Error("Trying to delete an empty element.");if(this.se.Form.SyncContext!==g.a.DesignTimeForm)throw Error("Trying to delete an element without design type.");return $.when(this.se.createSyncJob((function(){return e.I.deleteFormDescriptiveElement(e.FormId,t.id||"",e.ElementType,e.ExtraQosData)}))).then(null,(function(t){return t&&621===t.innerCode?$.Deferred().resolve().promise():t}))},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){var n=this;return this.se.Form.SyncContext!==g.a.DesignTimeForm?$.Deferred().resolve().promise():this.se.createUploadSyncJob((function(){return n.I.updateFormDescriptiveElement(n.FormId,n.ElementId,n.ElementType,t,n.ExtraQosData)}))},t}(),O=n(68),j=n(69),w=n(49);n.d(e,"b",(function(){return I})),n.d(e,"a",(function(){return F}));var S={BranchInfo:c.a.fromMasterClass((function(){return h.a}),{IsLocalField:!0}),CoAuthors:c.a.collectionOf(c.a.reference(),{IsLocalField:!0}),FileUploadSPOInfo:c.a.create({anonymousLinkInfo:c.a.string(),driveId:c.a.string(),errorCode:c.a.string(),folderId:c.a.string(),linkInfo:c.a.string()},{SourceFieldName:"fileUploadSPOInfo"}),FormsProRTQuestionTitle:c.a.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProRTSubtitle:c.a.string({SourceFieldName:"formsProRTSubtitle"}),Id:c.a.string({IsKeyField:!0,SourceFieldName:"id"}),ImageInfo:c.a.fromMasterClass(u.f,{SourceFieldName:"image"}),ImageSettings:c.a.fromMasterClass(u.g,{IsLocalField:!0}),IntegratedSavingState:c.a.reference({IsLocalField:!0}),Order:c.a.number({SourceFieldName:"order"}),QuestionInfo:c.a.string({SourceFieldName:"questionInfo"}),SavingState:c.a.reference({IsLocalField:!0}),ShowSubtitle:c.a.boolean({IsLocalField:!0}),Subtitle:c.a.string({SourceFieldName:"subtitle"}),Title:c.a.string({SourceFieldName:"title"}),Type:c.a.reference({SourceFieldName:"type"}),VideoInfo:c.a.create({Author:c.a.string(),OriginalHeight:c.a.number(),OriginalWidth:c.a.number(),ShowWarningBar:c.a.boolean(),Thumbnail_url:c.a.string(),Title:c.a.string(),Url:c.a.string()},{IsLocalField:!0})};function I(t){return o.a.getObjectMasterFromModel(t)}var F=function(t){function e(n){var r=this,o=$.Deferred();if(!n.InitialData)throw Error("Element model should created with initial data.");return(n=i.clone(n)).InitialData=i.clone(n.InitialData),n.InitialData.FormsProRTQuestionTitle||(n.InitialData.FormsProRTQuestionTitle=null),n.InitialData.FormsProRTSubtitle||(n.InitialData.FormsProRTSubtitle=null),r=t.call(this,n,{MasterReady:o.promise(),Scheduler:new d.a})||this,Object(w.b)(r),r.U(),r.Ot(n),Object(b.d)(r,e.Schema.ImageInfo,e.Schema.ImageSettings),e.Rules.forEach((function(t){return r.addRule(t)})),r.ue={},o.resolve(),r}Object(r.c)(e,t);var n=e.prototype;return e.supportMobileDesign=function(t){return!1},Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ImageInfoMaster",{get:function(){return Object(m.c)(this.Model.ImageInfo)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ImageSettingsMaster",{get:function(){return Object(b.e)(this.Model.ImageSettings)},enumerable:!0,configurable:!0}),n.isFieldReady=function(n){return n=e.getSourceFields([n])[0],t.prototype.isFieldReady.call(this,n)},n.ensureFieldsReady=function(n){return t.prototype.ensureFieldsReady.call(this,e.getSourceFields(n))},n.fieldsReady=function(n){return t.prototype.fieldsReady.call(this,e.getSourceFields(n))},n.ensureCreationDone=function(){var t=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))},n.setVideoUrl=function(t,n){var r=this.Model.VideoInfo;o.a.getObjectMasterFromModel(r).bulkEdit((function(){r.Url=Object(f.a)(t),r.Title="",r.Author="",r.Thumbnail_url="",r.OriginalWidth=e.defaultWidth,r.OriginalHeight=e.defaultHeight,r.ShowWarningBar=n&&Object(f.b)(t)}))},n.hasValidVideoUrl=function(){return Object(s.b)("SupportStreamVideo")?this.wt()&&Object(f.c)(this.Model.VideoInfo.Url):this.wt()&&Object(f.d)(this.Model.VideoInfo.Url)},n.clearVideoInfo=function(){this.Model.VideoInfo={Author:"",OriginalHeight:e.defaultHeight,OriginalWidth:e.defaultWidth,ShowWarningBar:!1,Thumbnail_url:"",Title:"",Url:""}},n.resetBranchInfo=function(){e.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},n.createSyncJob=function(t){var e=this,n=$.Deferred(),r=n.promise().then((function(){return e.Form.getQuestionSyncBlocker(r)})).then(t);return n.resolve(),r},n.createUploadSyncJob=function(t){var e=this,n=$.Deferred(),r=$.when(n,this.St).then((function(){return e.createSyncJob(t)}));return n.resolve(),this.St=Object(a.a)(r),r},n.updateCoAuthors=function(t){var e=this,n=i.filter(this.Model.CoAuthors,(function(e){return t.userId===e.userId}))[0],r=function(){n&&c.deleteItems([n]),t.userId in e.ue&&(clearTimeout(e.ue[t.userId]),delete e.ue[t.userId])},c=o.a.getCollectionMasterFromModel(this.Model.CoAuthors);c.bulkEdit((function(){r(),n=o.a.Collection.addItems(e.Model.CoAuthors,[t])[0]}));this.ue[t.userId]=window.setTimeout(r,1e4)},e.getBranchInfoMaster=function(t){return o.a.getObjectMasterFromModel(t)},n.Ot=function(t){this.Ft=new O.a(this,e.Schema.QuestionInfo,e.QuestionInfoFieldSet),t.InitialData&&this.isFieldReady(e.Schema.QuestionInfo)&&(t.ExistingInDataSource||t.InitialData.QuestionInfo?this.Ft.deserialize():this.Ft.serialize())},n.U=function(){this.isFieldReady(e.Schema.ImageInfo)?this.Model.IntegratedSavingState=Object(w.a)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},n.wt=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(e,"QuestionInfoFieldSet",{get:function(){return e.questionInfoFieldSet||(e.questionInfoFieldSet=new j.a([e.Schema.BranchInfo,e.Schema.ImageSettings,e.Schema.ShowSubtitle,e.Schema.VideoInfo])),e.questionInfoFieldSet},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Rules",{get:function(){if(!e.rules){var t=e.Schema;e.rules=[{InterestedFields:[t.Id],Name:"block id changes",onChange:function(t){var e,n=t.Master.Model,r=n.Id,i=t.OldValues.Id;n.Id=i;try{throw Error("Changing element id")}catch(t){e=t}Object(l.a)({eventName:"UpdatingElementId",eventType:"error_event",extraData:{newId:r,oldId:i,stack:e.stack}})}},{InterestedFields:[t.ImageInfo.SavingState,t.SavingState],Name:"IntegrateSavingState",onChange:function(t){return t.Master.U()}}]}return e.rules},enumerable:!0,configurable:!0}),e.getSourceFields=function(t){return i.uniq(t.map((function(t){return e.QuestionInfoFieldSet.covers(t)?e.Schema.QuestionInfo:t})))},e.defaultWidth=459,e.defaultHeight=256,e}(o.a.createObjectMasterClass("DescriptiveElementMaster",S,(function(t,e){return new p(t,e)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));function r(t){var e=function(t){try{t=t.replace(/_/g,"/").replace(/-/g,"+");var e=(f=t,window.atob(f.replace(/ /g,"")).split("").map((function(t){return t.charCodeAt(0)}))),n=i(e.slice(0,16)),r=i(e.slice(16,32)),o=function(t,e){if(null==t||0===t.length)return t;var n=t.length;for(;--n>=0&&!(e.indexOf(t.charAt(n))<0););return t.substr(0,n+1)}(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e.slice(32)),"."),c={},s=o.split("$%@#");if(s.length>1){o=s[0];for(var u=1;u<s.length;u++){var a=s[u].split("=");a&&2===a.length&&(c[a[0]]=a[1])}}return{OrgId:n,OwnerId:r,TableId:o,MoreInfo:c}}catch(t){return{OrgId:null,OwnerId:null,TableId:null,MoreInfo:null}}var f}(t),n=!1;return e.MoreInfo&&"g"===e.MoreInfo.t&&(n=!0),{OrgId:e.OrgId,OwnerId:e.OwnerId,TableId:e.TableId,IsGroupOwner:n}}function i(t){if(16!==t.length)return null;var e=function(t){for(var e="",n="",r=0;r<t.length;r++)n=1===(n=t[r].toString(16)).length?"0"+n:n,e+=n;return e}([].concat(t.slice(0,4).reverse(),t.slice(4,6).reverse(),t.slice(6,8).reverse(),t.slice(8)));return e=e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return s}));var r=n(3),i=n(4);function o(t){var e=t.Synchronizer;e.observe((function(){return u(t)}),[e.Schema.CreationFailed,e.Schema.CreationInProcess,e.Schema.CreationScheduled,e.Schema.UpdateFailed,e.Schema.UpdateInProcess,e.Schema.UpdateScheduled]),u(t)}function c(t,e,n){var o=i.a.convertToArray(t.Model).map(i.a.getObjectMasterFromModel);function c(){var t=o.map((function(t){return t.getModelByFieldSchema(e)}));n(s(t))}c(),t.observe((function(t){t.AddedModels.length&&(o=o.concat(t.AddedModels.map(i.a.getObjectMasterFromModel))),t.RemovedModels.length&&t.RemovedModels.map(i.a.getObjectMasterFromModel).forEach((function(t){t.Synchronizer.deletedFromDataSource().done((function(){o=r.without(o,t),c()}))})),c()}),[e])}function s(t){return r.contains(t,"Saving")?"Saving":r.contains(t,"Scheduled")?"Scheduled":r.contains(t,"Failed")?"Failed":"Idle"}function u(t){var e=t.Synchronizer.Model;e.CreationInProcess||e.UpdateInProcess?t.Model.SavingState="Saving":e.CreationScheduled||e.UpdateScheduled?t.Model.SavingState="Scheduled":e.CreationFailed||e.UpdateFailed?t.Model.SavingState="Failed":t.Model.SavingState="Idle"}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return l}));var r=n(11),i=n(95),o=n(5),c=Object(o.a)().hashMapping,s=Object(o.a)().isCdnEnabled,u=Object(o.a)().addPrefixForProWhenNoCdn,a={defaultFolder:{css:"/css/dist/",js:"/Scripts/dists/"},vendorsFolder:{css:"/css/",js:"/Scripts/"}};function f(t){return t?s?h(t):u?"/FormsPro"+t:t:""}function l(t,e){if(!t)return"";var n=t.split(".").pop();if("js"!==n&&"css"!==n)return t;var r=function(t,e){return(/^vendors\//i.test(t)?a.vendorsFolder:a.defaultFolder)[e]}(t,n)+t;if(s&&void 0!==c){var i=c[t.toLowerCase()];if(void 0!==i)return h(r.replace(new RegExp(n+"$"),i+"."+n))}var f=r+(e?"?v="+Object(o.a)().version:""),l=Object(o.a)().ring;return!s&&l&&(f=f+(e?"&":"?")+"ring="+l),u?"/FormsPro"+f:f}function h(t){if(t=t.toLowerCase(),Object(r.q)()){var e=Object(i.a)("CdnEndPoint");if(e)return e+t}return"/cdn"+t}},function(t,e,n){"use strict";n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return p})),n.d(e,"d",(function(){return O})),n.d(e,"a",(function(){return j})),n.d(e,"g",(function(){return S})),n.d(e,"e",(function(){return I})),n.d(e,"f",(function(){return y}));var r=n(0),i=n(3),o=(n(6),n(33)),c=n(24),s=["mp3","aif","iff","m3u","m4a","mid","mpa","ra","wav","wma"],u=["xls","xlt","xlm","xlsx","xlsm","xltx","xltm"],a=["jpg","jpeg","png","gif","bmp","tiff","psd","thm","yuv","ai","drw","eps","ps","svg","3dm","max"],f=["ppt","pot","pps","pptx","pptm","potx","potm","ppam","ppsx","ppsm","sldx","sldm"],l=["pdf"],h=["avi","mp4","mov","wmv","asf","3g2","3gp","asx","flv","mpg","rm","swf","vob"],d=["doc","dot","wbk","docx","docm","dotx","dotm","docb"],m={};s.forEach((function(t){return m[t]="Audio"})),u.forEach((function(t){return m[t]="Excel"})),a.forEach((function(t){return m[t]="Image"})),f.forEach((function(t){return m[t]="PowerPoint"})),l.forEach((function(t){return m[t]="PDF"})),h.forEach((function(t){return m[t]="Video"})),d.forEach((function(t){return m[t]="Word"}));var b={Audio:s,Excel:u,Image:a,PDF:l,PowerPoint:f,Video:h,Word:d},v={Audio:{Color:"#666666",Name:"Microphone"},Excel:{Color:"#217346",Name:"ExcelDocument"},Image:{Color:"#666666",Name:"Photo2"},PDF:{Color:"#666666",Name:"PDF"},PowerPoint:{Color:"#B7472A",Name:"PowerPointDocument"},Text:{Color:"#666666",Name:"TextField"},Video:{Color:"#666666",Name:"Video"},Word:{Color:"#2B579A",Name:"WordDocument"}},g={"10MB":10,"100MB":100,"1GB":1e3};function p(t){var e=[];return Object.keys(t).forEach((function(n){t[n]&&(e=e.concat(b[n]))})),e}function O(t){var e=w(t),n={className:"forms-icon-size20x20 office-form-theme-quiz-point analyze-view-file-icon",style:{color:e.Color}};return r.createElement(c.a,{HTMLAttributes:n,IconName:e.Name})}function j(t,e){switch(e){case"Audio":return t.UploadFile_Type_Audio;case"Excel":return t.UploadFile_Type_Excel;case"Image":return t.UploadFile_Type_Image;case"PowerPoint":return t.UploadFile_Type_PowerPoint;case"PDF":return t.UploadFile_Type_PDF;case"Video":return t.UploadFile_Type_Video;case"Word":return t.UploadFile_Type_Word;default:return""}}function w(t){var e=t.split("."),n=e[e.length-1].toLowerCase();return v[m[n]]||{Color:"#666666",Name:"TextDocument"}}function S(t,e){var n=t.Model.Id,r=!!i.find(t.Model.Questions,(function(t){return"Question.FileUpload"===t.Type}));if(I(n)||!r){var c=F(),s=i.find(c,(function(t){return t.FormId===n}));s?s.ShowConfirmDialog=s.ShowConfirmDialog&&e:c.push({FormId:n,ShowConfirmDialog:!0}),Object(o.b)().setItem("officeforms.fileuploaddialogmap",JSON.stringify(c))}}function I(t){var e=i.find(F(),(function(e){return e.FormId===t}));return!!e&&e.ShowConfirmDialog}function F(){var t=[],e=Object(o.b)().getItem("officeforms.fileuploaddialogmap");return e&&(t=JSON.parse(e)),t}function y(t){var e=t.Model.FileTypes;Object.keys(e).forEach((function(t){e[t]=!0}))}},function(t,e,n){"use strict";var r=n(2),i=n(0),o=n(3),c=n(64),s=n(11),u=n(9),a=n(27),f=n(77),l=n(5),h=n(6),d=n(8),m=n(21),b=n(10),v=n(112),g=n(31),p=n(82),O=n(12),j=n(18),w=n(32),S=n(40),I=n(57),F=n(36),y=n(113),N=n(7),k=n(93),T=n(24),C=n(91);function P(t){var e,n,r,o=t.Master.Question.Model,c=t.Master.SubQuestionRuntimeMasters,s=c[c.length-1];if(t.IsStudentViewMode){if(!(l=(s||t.Master).getScore())&&!o.Point)return;var u=o.Point?o.Point:"-",a=null!=l?l:"-",f=Object(h.a)().RuntimeView_TotalPoints_Content.format(a,u);return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},Object(h.a)().Quiz_Points_BracketsText.format(f))}if(o.IsQuiz&&!t.HiddenPoint){if(!o.Point)return;if(!t.ShowDesignInfo&&t.ShowQuizResult){var l;a=null!=(l=(s||t.Master).getScore())?l:"-",f=Object(h.a)().RuntimeView_TotalPoints_Content.format(a,o.Point);return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},Object(h.a)().Quiz_Points_BracketsText.format(f))}return i.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(e=o.Point,n=Object(h.a)().Quiz_Points_BracketsText_Singular,r=Object(h.a)().Quiz_Points_BracketsText_Plural,(1===e?n:r).format(e)))}}function x(t){var e=t.Master.Model,n=t.Master.Question.Model,r=n.Type===C.a.getElementTypeName(),i="Question.TextField"===n.Type&&!n.Multiline,o="Question.Ranking"===n.Type,c=r||i||o;return!!(n.IsQuiz&&t.ShowQuizResult&&c&&e.QuizResult)&&!e.QuizResult.IsAnswerCorrect}var M=n(70),L=n(129),D=n(114),R=n(115),E=n(16),A=n(116),_=n(117);n.d(e,"a",(function(){return U}));var U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ae=i.createRef(),e.fe=9,e.le=16,e.me=o.uniqueId("question"),e.ve=400,e.ge=function(){var t={chunks:e.getFormattedDataForImmersiveReader(),title:""},n={uiLang:Object(s.f)()||navigator.language};Object(g.b)().getImmersiveReaderToken().then((function(e){e&&ImmersiveReader&&ImmersiveReader.launchAsync(e,null,t,n)}))},e}Object(r.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.update=function(){return t.forceUpdate((function(){var e=t.props.onHeightChange;e&&e()}))};var e=this.props.Master;e.Question.Form.observe(this.update,[O.a.Schema.HasQuestionMedia]),e.observe(this.update),e.Question.observe(this.update),this.pe=Object(y.a)(),this.pe.observe(this.update,[this.pe.Schema.FormsTenantSettings]);var n=Object(m.f)().Schema;e.Question.ImageInfoMaster.observe(this.update,[n.ResourceUrl,n.ContentType,n.OriginalFileName]),e.Question.ImageSettingsMaster.observe(this.update),this.Oe(this.props)},n.componentWillReceiveProps=function(t){this.Oe(t)},n.componentWillUnmount=function(){var t=this.props.Master;t.Question.ImageSettingsMaster.unobserve(this.update),t.Question.ImageInfoMaster.unobserve(this.update),t.Question.unobserve(this.update),t.unobserve(this.update),t.Question.Form.unobserve(this.update),this.pe.unobserve(this.update),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update)},n.componentDidMount=function(){var t=$(this.ae.current),e=t.find(".office-form-question-formula span"),n=t.find(".office-form-question-choice-formula span"),r=t.find(".design-formula-mixer span");Object(f.a)(t.find("span").not(e).not(n).not(r))},n.render=function(){var t={className:"__question__ office-form-question",ref:this.ae};if("has-error"===this.getValidationStyle()||x(this.props)){var e=this.props.IsMobile?"office-form-error-question-mobile":"office-form-error-question";t.className=Object(d.a)(t.className,e)}var n=this.je(),o=null;return void 0!==n&&(t.className=Object(d.a)(t.className,"office-form-studentview-question"),o=i.createElement("div",{className:"office-form-feedback-marginbottom-box"})),i.createElement("div",Object(r.a)({},t),this.we(),this.createQuestionContent(),n,o)},n.createWrongResultLabel=function(){return function(t){if(!t.IsMobile){var e=[];if(x(t)){var n=Object(T.b)({Accessible:!0,HTMLAttributes:{"aria-label":Object(h.a)().Response_Preview_WrongReponseIcon.format(t.Ordinal),className:"validation-error-message-wrong-Icon office-form-answerkey"},IconName:"Cancel"});e=[i.createElement("div",{className:"validation-error-circle-big"}),i.createElement("div",{className:"validation-error-circle-small"}),n]}return i.createElement.apply(i,Object(r.f)(["div",{"aria-live":"assertive",role:"alert"}],e))}}(this.props)},n.createReactNodes=function(){throw Error("to be overridden.")},n.createQuestionContent=function(){var t={className:"office-form-question-content office-form-theme-focus-border"},e=this.props.HTMLAttributes;e&&(t=Object(d.f)(e,t));var n=Object(d.a)("office-form-question-element",this.Se()?"with-image":""),o=null;return this.isRequiredQuestionError()&&(o=Object(M.a)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:this.props.LocalizedStrings.Required_Question_Error_Message})),i.createElement("div",Object(r.a)({},t),this.createWrongResultLabel(),this.Ie(),i.createElement("div",{className:n},this.createReactNodes()),o)},n.isRequiredQuestionError=function(){if(!this.props.ShowValidationStyle)return!1;var t=this.props.Master,e=t.Question.verify(t.Model.Answer);return t.SubQuestionRuntimeMasters.forEach((function(t){t.Question.verify(t.Model.Answer)===j.e.RequiredError&&(e=j.e.RequiredError)})),e===j.e.RequiredError},n.getValidationStyle=function(){if(!this.props.ShowValidationStyle)return"";var t=this.props.Master,e=t.Question.verify(t.Model.Answer);return t.SubQuestionRuntimeMasters.forEach((function(t){t.Question.verify(t.Model.Answer)===j.e.RequiredError&&(e=j.e.RequiredError)})),e===j.e.Success?"has-success":"has-error"},n.getQuestionId=function(){return this.me},n.getRequiredId=function(){return this.props.Master.Question.Model.Required?this.me+"-required":void 0},n.getQuestionTypeId=function(){return this.me+"-questiontype"},n.getElementProps=function(t){var e={"aria-describedby":this.Fe(),"aria-labelledby":Object(d.a)(this.ye(),this.Ne(),this.getRequiredId(),this.getQuestionTypeId())};return t?Object(d.f)(t,e):e},n.getFormattedDataForImmersiveReader=function(){var t=this.props.Master.Question.Model,e=[];if(e.push({content:this.props.Ordinal+". "+t.Title+(t.Required?" *":"")+"\n"}),t.Point){var n=P(this.props);e.push({content:n.props.children.toString()+"\n\n"})}else e.push({content:"\n"});if(t.Subtitle){var r=t.Subtitle;if("undefined"!=typeof MathJax){var i=MathJax.Hub.getAllJax(null),c=o.find(i,(function(e){return e.originalText===t.Subtitle}));if(c){var s=c.root&&c.root.toMathML&&c.root.toMathML();s&&(s=s.replace(/\n\s*/g,""),r="\x3c!--[if mathML]&#62;"+Object(d.b)(s,!0)+"&#60;![endif]--\x3e")}}e.push({content:""+r,mimeType:"text/html"}),e.push({content:"\n\n"})}var u=document.createElement("i");return u.textContent=Object(d.b)(this.props.LocalizedStrings.ImmersiveReader_InputAnswer,!0),e.push({content:u.outerHTML,mimeType:"text/html"}),e},n.Oe=function(t){var e=t.Master,n=t.LocaleId;this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.unobserve(this.update),this.questionLocalizedItemMaster=void 0),n&&(this.questionLocalizedItemMaster=I.a.getQuestionResourceMaster(n,e.Question.Model.Id,e.Question.Form),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[F.a.Schema.title,F.a.Schema.subtitle]))},n.je=function(){var t=this.props.Master.SubQuestionRuntimeMasters,e=t[t.length-1],n=(e&&e.Model||this.props.Master.Model).AnswerEntity,r=n&&n.Feedback;if(this.props.IsStudentViewMode&&r){var o={HTMLAttributes:{className:Object(d.a)("feedback-icon forms-icon-size16x16",Object(b.g)()?"edge":void 0,Object(b.h)()?"ie":void 0),role:"presentation"},IconName:"Chat"};return i.createElement("div",{className:"office-form-feedback-box"},Object(T.b)(o),i.createElement("div",{className:"office-form-feedback-content"},Object(L.a)({content:r})))}},n.ke=function(){var t=this,e=this.props.Master.Question.Model,n=this.questionLocalizedItemMaster,r=n&&n.Model,o=this.props.Master.Question.Form.Model.HasQuestionMedia,s=r&&r.title||e.Title,u=Object(N.c)((function(){return s}),N.e),a=!this.props.HideMedia&&(e.ImageInfo&&e.ImageInfo.ResourceUrl||o)?"office-form-question-title with-image":"office-form-question-title",f=this.props.Master.Question.Form,l=Object(c.b)(f,c.a.ResponsePagePollView),h=Object(N.c)((function(){return!(t.Se()||l)}),N.e),d={"aria-level":2,className:a,id:this.Ne(),role:"heading"},m=e.Required?this.props.LocalizedStrings.Accessibility_RequiredAnswer:void 0,b=null;m&&(b=i.createElement("div",{key:"accessibilityNode"},i.createElement("span",{className:"accessibility-reader-no-display",id:this.getRequiredId()},m)));var v=this.Te(),g=this.Ce(),p=null;g&&(p=i.createElement("div",{key:"questionTypeNode"},i.createElement("span",{className:"accessibility-reader-no-display",id:this.getQuestionTypeId()},g)));var O={children:[v,b,p,P(this.props)],HTMLAttributes:d,key:this.getQuestionId().toString(),Label:u,Ordinal:this.props.Ordinal,ShowOrdinal:h,ShowRequiredStar:e.Required,Theme:this.props.Theme};return Object(M.a)(O)},n.Ce=function(){var t=this.props.Master.Question.Model,e="";switch(t.Type){case"Question.Choice":e=t.ChoiceType===j.a.MultiChoice?this.props.LocalizedStrings.QuestionType_MultiChoice:this.props.LocalizedStrings.QuestionType_SingleChoice;break;case"Question.DateTime":e=this.props.LocalizedStrings.QuestionType_DateTime;break;case"Question.Rating":e=this.props.LocalizedStrings.QuestionType_Rating;break;case"Question.TextField":e=t.Multiline?this.props.LocalizedStrings.QuestionType_MultiLineText:this.props.LocalizedStrings.QuestionType_SingleLineText;break;case"Question.Ranking":e=this.props.LocalizedStrings.QuestionType_Ranking;break;case"Question.MatrixChoiceGroup":e=this.props.LocalizedStrings.QuestionType_MatrixChoiceGroup}return e},n.Pe=function(){return i.createElement("div",{className:"office-form-question-ordinal office-form-theme-primary-background"},i.createElement("span",{id:this.ye()},this.props.Ordinal))},n.Ie=function(){var t,e,n,o,c=this.props.Master.Question,s=c.Model,u=c.Form.Model.HasQuestionMedia,f={},l="office-form-question-subtitle",h=this.props.IsMobile||Object(b.r)()||s.ImageSettings.Layout===S.a.Horizontal&&s.ImageSettings.Size===S.c.Large,m=c.hasValidVideoUrl(),g=h||m;if(this.props.HideMedia||m||!(s.ImageInfo&&s.ImageInfo.ResourceUrl||u||s.ImageInfo.ImageProcessingStatus===w.b.Uploading||s.ImageInfo.ImageProcessingStatus===w.b.Picking)){if(!this.props.HideMedia&&m){var O=Object(b.k)();l="office-form-question-subtitle with-video";var j=s.VideoInfo;if(f.className=Object(d.a)(f.className,"question-title-container office-form-theme-video-question-background"),Object(v.a)(j.Url,c.Form))o=i.createElement(A.a,{IsMobile:O,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:j.Url});else{var I={allowFullScreen:!0,frameBorder:"0",height:this.xe(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:j.Url,width:"100%"};t=i.createElement("div",{className:"office-form-question-video-container"},i.createElement("iframe",Object(r.a)({},I)))}}}else{f.className="question-title-container office-form-theme-image-question-background",l="office-form-question-subtitle with-image";var F=h?"office-form-question-horizontal-large-image-container office-form-theme-image-container-border":"office-form-question-image-container office-form-theme-image-container-border";if(s.ImageInfo&&s.ImageInfo.ResourceUrl){var y=c.ImageSettingsMaster.validateImageSettings(),T={className:F,style:h?void 0:{width:"{0}px".format(y.ContainerWidth)}},C=Object(k.b)(s.ImageInfo);t=i.createElement("div",Object(r.a)({},T),i.createElement(k.a,{Image:c.ImageInfoMaster,ImageSettings:c.ImageSettingsMaster,ImageType:"Question"}),C,i.createElement(_.a,null,this.props.Master.Question.ImageInfoMaster.Model.AltText))}else if(s.ImageInfo.ImageProcessingStatus===w.b.Uploading||s.ImageInfo.ImageProcessingStatus===w.b.Picking){T={className:F,style:{height:"{0}px".format(Object(a.g)()),width:"{0}px".format(Object(a.h)())}};t=i.createElement("div",Object(r.a)({},T),Object(k.b)())}}if(this.Me())if(s.IsMathQuiz&&!s.IsPlainTextInMathField){var P=Object(p.c)({DisableLinebreaks:this.props.DisableFormulaLinebreak,Formula:s.Subtitle,onRenderComplete:this.props.onHeightChange});e=i.createElement("div",{className:"office-form-question-formula"},P)}else{var x=this.questionLocalizedItemMaster,L=x&&x.Model,D=Object(N.c)((function(){return L&&L.subtitle||s.Subtitle}),N.e);n=Object(M.a)({HTMLAttributes:{className:l,id:this.Fe()},HtmlContent:!1,Label:D})}return i.createElement("div",{className:"question-title-box"},i.createElement("div",Object(r.a)({},f),g?void 0:t,g?void 0:o,this.Se()?this.Pe():void 0,this.ke(),n,g?t:void 0,g?o:void 0,e))},n.Te=function(){return!Object(b.h)()&&Object(u.b)("ImmersiveReaderInForms")&&this.props.ShouldShowImmersiveReaderButtons?i.createElement("button",{className:"immersive-reader-button","data-locale":Object(s.f)()||navigator.language,"aria-label":Object(h.a)().ImmersiveReaderButton_Label,onClick:o.debounce(this.ge,this.ve,!0)}):null},n.we=function(){var t,e=this,n=this.props.Master.Question.Model;return n.CoAuthors&&n.CoAuthors.length>0?n.CoAuthors[n.CoAuthors.length-1].userId!==Object(l.a)().userInfo.UserId&&(t=o.map(n.CoAuthors,(function(t){if(t.userId!==Object(l.a)().userInfo.UserId){var n={ariaLabel:e.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Screen_Reader.format(t.displayName||t.userId,e.props.Ordinal||0),displayText:Object(R.a)(t.displayName,t.firstName,t.lastName),email:t.email,isCoAuthUser:!0,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId};return i.createElement(D.a,Object(r.a)({},n))}}))):t=void 0,i.createElement("div",{className:"question-coAuthor-notification-container-render-mode","aria-live":"polite"},t)},n.xe=function(){if(Object(b.k)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),t/(this.le/this.fe)}return Object(a.c)()},n.ye=function(){return this.Se()?this.me+"-ordinal":void 0},n.Ne=function(){return this.me+"-title"},n.Fe=function(){return this.Me()?this.me+"-subtitle":void 0},n.Se=function(){return this.props.Master.Question.Form.Model.HasQuestionMedia&&!this.props.HideMedia},n.Me=function(){var t=this.props.Master.Question.Model;return t.ShowSubtitle&&!!t.Subtitle},e}(E.a)},function(t,e,n){"use strict";var r,i,o,c,s,u,a,f,l,h,d,m,b,v,g,p,O,j,w,S=n(3),I=n(11),F=n(29),y=n(9),N=n(5),k=n(35),T=n(31),C=n(2),P=function(t){function e(){var n=this;return e.instance?e.instance:((n=t.call(this,window.FormPrefetchCache&&window.FormPrefetchCache.userLicenseInfoCache)||this).init(),e.instance=n,n)}Object(C.c)(e,t);var n=e.prototype;return e.getInstance=function(){return new e},n.onPrefetchSucceed=function(){try{var t=JSON.parse(this.cache.data);this.prefetchDeferred.resolve(t)}catch(t){this.fallBackToNormalBoot()}},n.onPrefetchFaied=function(){this.fallBackToNormalBoot()},n.fallBackToNormalBoot=function(){var t=this;T.a.getInstance().createDataProvider().getUserInfo().done((function(e){return t.prefetchDeferred.resolve(e)})).fail((function(e){return t.prefetchDeferred.reject(e)}))},e}(n(96).a);function x(){return Object(y.b)("PreferUserInfoFromAspx")&&Object(N.a)().userLicenseInfo&&Object(N.a)().userLicenseInfo.licenses?$.Deferred().resolve(Object(N.a)().userLicenseInfo).promise():Object(y.b)("PrefetchUserLicenseInfo")?P.getInstance().getPromise():T.a.getInstance().createDataProvider().getUserInfo()}function M(){return U().then((function(){return d}),(function(){return $.Deferred().resolve(!1).promise()}))}function L(){var t=Object(N.a)().userInfo.TenantId;return!(!t||t.toLowerCase()!==Object(I.k)())}function D(){var t=Object(N.a)().userInfo.TenantId;return!(!t||t.toLowerCase()!==Object(I.l)())}function R(){var t=Object(N.a)().userInfo.TenantId;return t&&-1!==Object(I.g)().indexOf(t.toLowerCase())}function E(){return U().then((function(){var t=0;return d&&(t=1),m&&(t|=2),D()&&(t|=8),L()&&(t|=b?16:4),v&&(t|=64,g?t|=128:O?t|=256:p&&(t|=512)),t}),(function(){return 0}))}function A(){return j||(j=$.Deferred(),$(document).ready((function(){T.a.getInstance().createDataProvider().getDataClassificationLabels().then((function(t){j.resolve(t)}),(function(t){return j.reject(t)})),j.fail((function(t){k.a.logData({errorInfo:t,errorName:"TenantDataClassificationLevelsGetFailure"})}))}))),j.promise()}function _(t,e){if(!w){var n=T.a.getInstance().createDataProvider();(w=n.getDataClassificationLabelDetail(t,e)).fail((function(t){k.a.logData({errorInfo:t,errorName:"TenantDataClassificationLevelDetailGetFailure"})}))}return w}function U(){return h||(h=$.Deferred(),$(document).ready((function(){if(Object(N.a)().userInfo.UserId||Object(F.i)())try{if(Object(N.a)().userLicenseInfo&&Object(N.a)().userLicenseInfo.id){var t=Object(N.a)().userLicenseInfo;B(t.licenses,t.isPaidUser)}else{var e=void 0;if(Object(y.b)("BlockRestrictUser")||Object(y.b)("PrefetchUserLicenseInfo"))e=x;else{var n=T.a.getInstance().createDataProvider();e=n.getUserInfo.bind(n)}e().then((function(t){B(t.licenses,t.isPaidUser)}),(function(t){return h.reject(t)}))}}catch(t){h.reject(t)}else h.resolve({});h.fail((function(t){k.a.logData({errorInfo:t,errorName:"UserInfoGetFailure"})}))}))),h.promise()}function B(t,e){var n=S.object(t.map((function(t){var e=t.licenseName,n=t.skus;return[e,JSON.parse(n)]})));!function(t){for(var e in r)if(t.hasOwnProperty(r[e])){var n=t[r[e]];if(n&&n.length>0)return void(d=!0)}d=!1}(n),function(t){for(var e in i)if(t.hasOwnProperty(i[e])){var n=t[i[e]];if(n&&n.length>0)return m=!0,void parseInt(e)}m=!1}(n),function(t){for(var e in o){if(t.hasOwnProperty(o[e]))if((n=t[o[e]])&&n.length>0){!0,parseInt(e);break}}for(var e in c){if(t.hasOwnProperty(c[e]))if((n=t[c[e]])&&n.length>0){parseInt(e);break}}for(var e in s){var n;if(t.hasOwnProperty(s[e]))if((n=t[s[e]])&&n.length>0){parseInt(e);break}}}(n),function(t){b=!(!L()||!t)}(e),function(t){for(var e in u)if(t.hasOwnProperty(u[e])){var n=t[u[e]];if(n&&n.length>0)return void(v=!0)}v=!1}(n),function(t){for(var e in a){if(t.hasOwnProperty(a[e]))(n=t[a[e]])&&n.length>0&&(g=!0)}for(var e in f){if(t.hasOwnProperty(f[e]))(n=t[f[e]])&&n.length>0&&(O=!0)}for(var e in l){var n;if(t.hasOwnProperty(l[e]))(n=t[l[e]])&&n.length>0&&(p=!0)}}(n),h.resolve(n)}n.d(e,"d",(function(){return M})),n.d(e,"f",(function(){return L})),n.d(e,"g",(function(){return D})),n.d(e,"e",(function(){return R})),n.d(e,"c",(function(){return E})),n.d(e,"b",(function(){return A})),n.d(e,"a",(function(){return _})),function(t){t[t.OFFICE_FORMS_PLAN_2=0]="OFFICE_FORMS_PLAN_2",t[t.OFFICE_FORMS_PLAN_3=1]="OFFICE_FORMS_PLAN_3"}(r||(r={})),function(t){t[t.FORMS_PLAN_E1=0]="FORMS_PLAN_E1",t[t.FORMS_PLAN_E3=1]="FORMS_PLAN_E3",t[t.FORMS_PLAN_E5=2]="FORMS_PLAN_E5",t[t.FORMS_PLAN_K=3]="FORMS_PLAN_K"}(i||(i={})),function(t){t[t.FORMS_GOV_E1=0]="FORMS_GOV_E1",t[t.FORMS_GOV_E3=1]="FORMS_GOV_E3",t[t.FORMS_GOV_E5=2]="FORMS_GOV_E5",t[t.FORMS_GOV_F1=3]="FORMS_GOV_F1"}(o||(o={})),function(t){t[t.FORMS_GCCHIGH_E1=0]="FORMS_GCCHIGH_E1",t[t.FORMS_GCCHIGH_E3=1]="FORMS_GCCHIGH_E3",t[t.FORMS_GCCHIGH_E5=2]="FORMS_GCCHIGH_E5",t[t.FORMS_GCCHIGH_F1=3]="FORMS_GCCHIGH_F1"}(c||(c={})),function(t){t[t.FORMS_DOD_E1=0]="FORMS_DOD_E1",t[t.FORMS_DOD_E3=1]="FORMS_DOD_E3",t[t.FORMS_DOD_E5=2]="FORMS_DOD_E5",t[t.FORMS_DOD_F1=3]="FORMS_DOD_F1"}(s||(s={})),function(t){t[t.FORMS_PRO=0]="FORMS_PRO",t[t.Forms_Pro_USL=1]="Forms_Pro_USL",t[t.Forms_Pro_USL_GCC=2]="Forms_Pro_USL_GCC",t[t.Forms_Pro_CE=3]="Forms_Pro_CE",t[t.Forms_Pro_Service=4]="Forms_Pro_Service",t[t.Forms_Pro_FS=5]="Forms_Pro_FS",t[t.Forms_Pro_Marketing=6]="Forms_Pro_Marketing",t[t.Forms_Pro_Plan=7]="Forms_Pro_Plan",t[t.Forms_Pro_PS=8]="Forms_Pro_PS",t[t.Forms_Pro_SalesEnt=9]="Forms_Pro_SalesEnt",t[t.Forms_Pro_Talent=10]="Forms_Pro_Talent",t[t.Forms_Pro_Operations=11]="Forms_Pro_Operations",t[t.Forms_Pro_Relationship_Sales=12]="Forms_Pro_Relationship_Sales",t[t.Forms_Pro_Customer_Insights=13]="Forms_Pro_Customer_Insights",t[t.Forms_Pro_Service_GCC=14]="Forms_Pro_Service_GCC",t[t.Forms_Pro_FS_GCC=15]="Forms_Pro_FS_GCC",t[t.Forms_Pro_Human_Resources_GCC=16]="Forms_Pro_Human_Resources_GCC",t[t.Forms_Pro_PS_GCC=17]="Forms_Pro_PS_GCC",t[t.Forms_Pro_SalesEnt_GCC=18]="Forms_Pro_SalesEnt_GCC"}(u||(u={})),function(t){t[t.Forms_Pro_USL=0]="Forms_Pro_USL",t[t.Forms_Pro_USL_GCC=1]="Forms_Pro_USL_GCC"}(a||(a={})),function(t){t[t.Forms_Pro_CE=0]="Forms_Pro_CE",t[t.Forms_Pro_Service=1]="Forms_Pro_Service",t[t.Forms_Pro_FS=2]="Forms_Pro_FS",t[t.Forms_Pro_Marketing=3]="Forms_Pro_Marketing",t[t.Forms_Pro_Plan=4]="Forms_Pro_Plan",t[t.Forms_Pro_PS=5]="Forms_Pro_PS",t[t.Forms_Pro_SalesEnt=6]="Forms_Pro_SalesEnt",t[t.Forms_Pro_Talent=7]="Forms_Pro_Talent",t[t.Forms_Pro_Operations=8]="Forms_Pro_Operations",t[t.Forms_Pro_Relationship_Sales=9]="Forms_Pro_Relationship_Sales",t[t.Forms_Pro_Customer_Insights=10]="Forms_Pro_Customer_Insights",t[t.Forms_Pro_Service_GCC=11]="Forms_Pro_Service_GCC",t[t.Forms_Pro_FS_GCC=12]="Forms_Pro_FS_GCC",t[t.Forms_Pro_Human_Resources_GCC=13]="Forms_Pro_Human_Resources_GCC",t[t.Forms_Pro_PS_GCC=14]="Forms_Pro_PS_GCC",t[t.Forms_Pro_SalesEnt_GCC=15]="Forms_Pro_SalesEnt_GCC"}(f||(f={})),function(t){t[t.FORMS_PRO=0]="FORMS_PRO"}(l||(l={}))},function(t,e,n){"use strict";n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"f",(function(){return a})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return h}));var r=n(3),i=n(4),o=n(17);function c(t){return{localizedResources:s(t)}}function s(t){var e=function(t){var e=t.filter((function(t){return!t.questionId})),n=r.groupBy(e,(function(t){return t.locale}));return r.map(n,(function(t){var e={footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:null,localeName:null,questionResources:[],subtitle:null,thankYouMessage:null,title:null};return t.forEach((function(t){!function(t,e){switch(t.elementKey){case"thankyoumessage":e.thankYouMessage=t.elementValue;break;case"formclosemessage":e.formCloseMessage=t.elementValue;break;case"footertext":e.footerText=t.elementValue;break;default:d(t,e)}}(t,e)})),e}))}(t),n=function(t){var e=t.filter((function(t){return t.questionId})),n=r.groupBy(e,(function(t){return t.locale})),i={};return r["map"](n,(function(t,e){var n=r["groupBy"](t,(function(t){return t.questionId}));var i=r["map"](n,(function(t,n){var i={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:e,localeName:null,option:null,questionId:n,rightDescription:null,subtitle:null,title:null};var o=t.filter((function(t){return t.elementKey&&t.elementKey.startsWith("choiceid_")}));if(o&&o.length>0){var c=r["map"](o,(function(t){var e={choiceId:null,description:null,key:null};v(t,e);return e}));i.choices=c}var s=t.filter((function(t){return t.elementKey&&!t.elementKey.startsWith("choiceid_")}));if(s){s.forEach((function(t){b(t,i)}))}return i}));return i})).forEach((function(t){var e=t.length>0&&t[0].localeId;e&&(i[e]=t)})),i}(t);return e.forEach((function(t){if(t.localeId){var e=n[t.localeId];e&&(t.questionResources=e)}})),e}function u(t){var e=m(t);return null!=t.formCloseMessage?(e.elementKey="formclosemessage",e.elementValue=t.formCloseMessage):null!=t.thankYouMessage?(e.elementKey="thankyoumessage",e.elementValue=t.thankYouMessage):null!=t.footerText&&(e.elementKey="footertext",e.elementValue=t.footerText),e}function a(t){var e=m(t);return null!=t.leftDescription?(e.elementKey="leftdescription",e.elementValue=t.leftDescription):null!=t.rightDescription?(e.elementKey="rightdescription",e.elementValue=t.rightDescription):null!=t.option&&'{"choicesV1":[]}'!==t.option?(e.elementKey="option",e.elementValue=t.option):null!=t.formsprortlocaleldescription?(e.elementKey="formsprortlocaleldescription",e.elementValue=t.formsprortlocaleldescription):null!=t.formsprortlocalerdescription&&(e.elementKey="formsprortlocalerdescription",e.elementValue=t.formsprortlocalerdescription),e}function f(t,e,n,o){var c={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:t.localeId,localeName:t.localeName,option:null,questionId:e,rightDescription:null,subtitle:null,title:null},s=i.a.Collection.getItemWithKeyFields(o.Model.Questions,{Id:e});if(s&&s.ChoiceGroup&&s.ChoiceGroup.length>0){var u=r.map(s.ChoiceGroup,(function(t){return{choiceId:t.Id.toString(),description:null,key:t.Key}}));c.choices=u}var a=i.a.Collection.itemsAddedInSource(n.questionResources,[c]);return i.a.getObjectMasterFromModel(a[0])}function l(t,e,n){var r={choiceId:t,description:null,key:e},o=i.a.Collection.itemsAddedInSource(n.choices,[r]);return i.a.getObjectMasterFromModel(o[0])}function h(t){var e=i.a.Collection.itemsAddedInSource(t.choicesV1,[{choiceId:null,description:"",formsProDisplayRTText:""}]);return i.a.getObjectMasterFromModel(e[0])}function d(t,e){switch(e.localeId=t.locale,t.elementKey){case"title":e.title=t.elementValue;break;case"subtitle":e.subtitle=t.elementValue;break;case"localename":e.localeName=t.elementValue;break;case"formsprortlocaletitle":e.formsprortlocaletitle=t.elementValue;break;case"formsprortlocalesubtitle":e.formsprortlocalesubtitle=t.elementValue;break;default:var n=t.elementValue&&t.elementValue.length,r="Unexpected locale element key:["+t.elementKey+"], value length:"+n,i=new Error(r).stack;return console.log(i),void Object(o.a)({eventName:"UnexpectedLocaleElementKey",eventType:"error_event",extraData:r+", call stack:"+i})}}function m(t){var e={elementKey:null,elementValue:null,locale:null,questionId:null};return null!=t.title?(e.elementKey="title",e.elementValue=t.title):null!=t.subtitle?(e.elementKey="subtitle",e.elementValue=t.subtitle):null!=t.localeName?(e.elementKey="localename",e.elementValue=t.localeName):null!=t.formsprortlocaletitle?(e.elementKey="formsprortlocaletitle",e.elementValue=t.formsprortlocaletitle):null!=t.formsprortlocalesubtitle&&(e.elementKey="formsprortlocalesubtitle",e.elementValue=t.formsprortlocalesubtitle),e}function b(t,e){switch(e.questionId=t.questionId,t.elementKey){case"leftdescription":e.leftDescription=t.elementValue;break;case"rightdescription":e.rightDescription=t.elementValue;break;case"option":e.option=t.elementValue;break;case"formsprortlocaleldescription":e.formsprortlocaleldescription=t.elementValue;break;case"formsprortlocalerdescription":e.formsprortlocalerdescription=t.elementValue;break;default:d(t,e)}}function v(t,e){var n=t.elementKey;n&&n.startsWith("choiceid_")&&(e.choiceId=n.split("_")[1]),e.description=t.elementValue}},function(t,e,n){"use strict";n.d(e,"g",(function(){return u})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return f})),n.d(e,"f",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return m})),n.d(e,"h",(function(){return b}));var r,i=n(3),o=(n(7),n(69)),c=n(12),s=n(101);function u(t){var e=c.a.Schema,n=[];return t.forEach((function(t){switch(t){case"Settings":case e.Settings:n.push(e.SerializedSettings);break;case"Modified":case e.Modified:n.push(e.ModifiedDate);break;case"Created":case e.Created:n.push(e.CreatedDate);break;case"ResponsesCount":case e.ResponsesCount:n.push(e.RowCount);break;case"PredefinedResponses":case e.PredefinedResponses:n.push(e.SerializedPredefinedResponses);break;case"Theme":case e.Theme:n.push(e.Background,e.OtherInfo);break;default:l().covers(t)?n.push(e.OtherInfo):n.push(t)}})),i.uniq(n)}function a(){var t=c.a.Schema;return[t.Background,t.Description,t.Logo,t.LogoInfo,t.Questions,t.DescriptiveElements,t.Settings,t.SoftDeleted,t.Title,t.PrimaryCustomizedThemeColor,t.SecondaryCustomizedThemeColor,t.TertiaryCustomizedThemeColor,t.Theme,t.TrackingId,t.XlWorkbookId,t.ThankYouMessage,t.EmailReceiptEnabled,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.LocalizedResources,t.OnlineSafetyLevel,t.MeetingId,t.ProgressBarEnabled]}function f(){return a().concat([c.a.Schema.OwnerId,c.a.Schema.OwnerTenantId])}function l(){return r||(r=new o.a([c.a.Schema.PrimaryCustomizedThemeColor,c.a.Schema.SecondaryCustomizedThemeColor,c.a.Schema.TertiaryCustomizedThemeColor,c.a.Schema.Theme,c.a.Schema.LogoInfo,c.a.Schema.CreatedFromOneDrive,c.a.Schema.TemplateId])),r}function h(){var t=c.a.Schema;return[t.Title,t.ModifiedDate,t.CreatedDate,t.MeetingId,t.OwnerId,t.OwnerTenantId,t.Description,t.Questions,t.DescriptiveElements,t.Permissions,t.PermissionTokens,t.ResponsesCount,t.Settings,t.Theme,t.Logo,t.LogoInfo,t.Background,t.XlWorkbookId,t.XlExportingTag,t.XlFileUnsynced,t.XlUnsyncedReason,t.Category,t.TrackingId,t.PredefinedResponses,t.ThankYouMessage,t.EmailReceiptEnabled,t.Flags,t.OnlineSafetyLevel,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.LocalizedResources,t.ProgressBarEnabled]}function d(){var t=c.a.Schema;return[t.Title,t.ModifiedDate,t.Description,t.Settings,t.Theme,t.Questions,t.DescriptiveElements,t.Logo,t.LogoInfo,t.Background,t.Category,t.PredefinedResponses,t.ThankYouMessage,t.EmailReceiptEnabled,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.OnlineSafetyLevel,t.ProgressBarEnabled,t.TenantSwitches]}function m(){var t=c.a.Schema;return[t.Title,t.ModifiedDate,t.OwnerId,t.OwnerTenantId,t.Description,t.Questions,t.DescriptiveElements,t.Settings,t.Theme,t.Logo,t.LogoInfo,t.Background,t.XlWorkbookId,t.Category,t.Type,t.ProgressBarEnabled]}function b(t){var e,n;return t.InitialData&&((t.InitialData.SerializedSettings||t.InitialData.Settings)&&(e=e||{},t.InitialData.SerializedSettings?e.Settings=JSON.parse(t.InitialData.SerializedSettings):e.SerializedSettings=s.a.serialize(t.InitialData.Settings)),(t.InitialData.SerializedPredefinedResponses||t.InitialData.PredefinedResponses)&&(e=e||{},t.InitialData.SerializedPredefinedResponses?e.PredefinedResponses=JSON.parse(t.InitialData.SerializedPredefinedResponses):e.SerializedPredefinedResponses=(n=t.InitialData.PredefinedResponses)&&n.length>0?JSON.stringify(n):null)),e&&((t=i.clone(t)).InitialData=i.extend({},t.InitialData,e)),t}},function(t,e,n){"use strict";var r,i,o=n(25),c=n(17),s=n(88),u=n(11),a=n(9),f=n(5),l=n(45),h=n(8),d=n(15),m=n(28),b=n(10),v=n(110),g=n(42),p=n(46);function O(t){try{return $.when(function(t){r&&"rejected"!==r.state()||(r=Object(p.h)(t).done((function(){Object(c.a)({eventName:"AddinPage.PageMethod.GetAddinUserInfoSuccess",eventType:"engagement_event"})})).fail((function(t){Object(c.a)({eventName:"AddinPage.PageMethod.GetAddinUserInfoFailed",eventType:"engagement_event",extraData:{error:t}})})));return r}(t),function(t){i&&"rejected"!==i.state()||(i=Object(p.f)(t).done((function(){Object(c.a)({eventName:"AddinPage.PageMethod.GetFlightsSuccess",eventType:"engagement_event"})})).fail((function(t){Object(c.a)({eventName:"AddinPage.PageMethod.GetFlightsFailed",eventType:"engagement_event",extraData:{error:t}})})).always((function(){return Object(o.a)().setFlightsBasingOnAuth_Deprecated(Object(f.a)().flights)})));return i}(t))}catch(t){return Object(c.a)({eventName:"TeamsTab.Auth.RefreshInfoFailed",eventType:"engagement_event"}),$.Deferred().resolve().promise()}}n.d(e,"c",(function(){return N})),n.d(e,"d",(function(){return k})),n.d(e,"a",(function(){return T})),n.d(e,"b",(function(){return C}));var j,w,S=Object(f.a)().signInLinkSilent,I=Object(f.a)().signInLinkSilentMsa,F=0,y=null;function N(t){var e=t&&t.response&&t.response.statusCode;if(Object(a.b)("CookieAuth")&&401===e){if(t&&t.response&&"Expired"===Object(h.c)(t.response.headers,"X-FailureReason"))return!0;var n=t&&t.response&&Object(b.u)(t.response.body);if(711===(n&&n.error&&parseInt(n.error.code)))return!0}return!1}function k(){var t=$.Deferred();if(window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]),window.formsRefreshAuthTokenCallbacks.push((function(e,n){!n&&e?t.resolve():Object(o.a)().AuthContext.signIn().then(m.b)})),!window.formsRefreshAuthTokenCallback){var e=new s.a("Auth.RefreshToken");e.start();var n=function(t,n){try{e.end({extraData:{loggedIn:t},resultType:n?"ExpectedFailure":"Success"}),$("#refreshAuthTokenFrame").remove();var r=window.formsRefreshAuthTokenCallbacks;r&&(n?r&&r.length>0&&r[0](t,n):r.forEach((function(e){return e(t,n)})))}finally{window.formsRefreshAuthTokenCallback=void 0,window.formsRefreshAuthTokenCallbacks=void 0}};if(Object(o.a)().AuthContext.hasUserLoggedIn()){var r=Object(f.a)().userInfo.IsMsa?I:S,i=$('<iframe id="refreshAuthTokenFrame" style="display: none" src="'+r+'" />');i.on("load",(function(){window.setTimeout((function(){window.formsRefreshAuthTokenCallback&&window.formsRefreshAuthTokenCallback(!1,!0)}),5e3)})),window.formsRefreshAuthTokenCallback=n,$(document.body).append(i)}else n(!1,!0)}return t.promise()}function T(t,e){var n=$.Deferred();if(window.formsDetectUserLoggedInCallback)n.reject();else{var r="Msa"===t,i=r?"Auth.DetectUserLoggedInMSA":"Auth.DetectUserLoggedInAAD",o=new s.a(i);o.start();var c=r?I:S;e&&(c=Object(d.d)(c,r?"username":"login_hint",encodeURIComponent(e)));var u=$("<iframe id='detect-user-loggedIn-frame' style='display: none' src='"+c+"' />");u.on("load",(function(){window.setTimeout((function(){window.formsDetectUserLoggedInCallback&&window.formsDetectUserLoggedInCallback(!1,!0)}),5e3)})),window.formsDetectUserLoggedInCallback=function(t,e){window.formsDetectUserLoggedInCallback=void 0,o.end({resultType:e?"ExpectedFailure":"Success"}),$("#detect-user-loggedIn-frame").remove(),n.resolve(t)},$(document.body).append(u)}return n.promise()}function C(t){return Object(l.b)()||Object(l.c)()||Object(l.f)()?(w||(w=$.Deferred()),!Object(l.c)()&&!Object(l.f)()&&y&&y.isAccessTokenFromHostValid()?(w.resolve(y.getAccessToken()),w.promise()):("pending"!==w.state()&&(w=$.Deferred()),y=null,window.addEventListener("message",P,!1),window.parent.postMessage("GetAccessTokenFromHost","*"),F=0,M(),w.promise())):Object(b.b)()?Object(v.a)().then(null,(function(){return x(t)})):x(t)}function P(t){if(t.data.startsWith("FormsAccessTokenFromHost:"))try{var e=t.data.indexOf("FormsAccessTokenFromHost:Bearer ");if(-1!==e){var n=t.data.substring(e+"FormsAccessTokenFromHost:Bearer ".length);y=new L(n)}}finally{window.removeEventListener("message",P,!1)}}function x(t){var e=$.Deferred();return Object(a.b)("CookieAuth")?(e.resolve(null),e.promise()):t.getCachedUser()?(t.acquireToken(Object(u.i)(),(function(n,r){if(!n&&r)return j=new Date,void e.resolve(r);var i;if(!t.getCachedToken(Object(u.a)())){if(j){var o=(new Date).getTime()-j.getTime();Object(c.a)({eventName:"Auth.AcquireTokenIdleTime",eventType:"engagement_event",extraData:{error:n,idleTimeInMinutes:o/6e4}})}return t.clearCache(),void Object(m.d)()}if(t.clearCache(),n.match("^AADSTS50079:"))return Object(c.a)({eventName:"AADAcquireTokenMfaCheckFailure",eventType:"error_event",extraData:n}),(i=new Error).name="AADAcquireTokenMfaCheckError",i.message=n,void e.reject(i);if(!n.match("^AADSTS50058:"))return Object(c.a)({eventName:"AADAcquireTokenFailure",eventType:"error_event",extraData:n}),(i=new Error).name="AADAcquireTokenError",i.message=n,void e.reject(i);if(Object(b.h)()||Object(b.g)()){var s=Object(g.c)();if(Object(c.a)({eventName:"LoginIECrossZone",eventType:"error_event",extraData:{useLegacyLoginDomain:!!s}}),Object(g.c)())Object(g.g)(!1);else if(Object(g.d)())return Object(g.g)(!0),void Object(m.d)()}else Object(c.a)({eventName:"AADAcquireTokenFailure",eventType:"error_event",extraData:n});(function(t){var e=$.Deferred();return function(t){var e=function(n){switch(n.data){case"TPC:NotSupported":t(!1),window.removeEventListener("message",e);break;case"TPC:Supported":t(!0),window.removeEventListener("message",e)}};window.addEventListener("message",e,!1);$("body").append('<iframe id="detectThirdPartyCookieFrame" style="display:none;" src=https://controls.officeppe.com/thirdpartycookie/check.html><iframe>')}((function(n){Object(c.a)({eventName:"Auth.ThirdPartyCookieSupport",eventType:"engagement_event",extraData:{allow:n}});var r=new Error(t);r.name=n?"LoginIECrossZoneError":"ThirdPartyCookieBlockedError",e.resolve(r)})),e.promise()})(n).done((function(t){return e.reject(t)}))})),e.promise()):(e.resolve(null),e.promise())}function M(){if(null!=y){var t=y.getAccessToken();O(t).always((function(){return w.resolve(t)}))}else F<10?(F++,window.setTimeout(M,1e3)):(F=0,w.resolve(null))}var L=function(){function t(t){this.Le=t;this.De=(new Date).getTime()+33e5}var e=t.prototype;return e.getAccessToken=function(){return this.Le},e.isAccessTokenFromHostValid=function(){return!!this.Le&&(new Date).getTime()<this.De},t}()},function(t,e,n){"use strict";var r=n(2),i=n(3),o=n(4),c=n(1),s=n(100),u=n(23),a=n(14),f=n(54),l=function(){function t(t){this.W=t,this.I=Object(u.b)(this.W.Form)}var e=t.prototype;return e.add=function(t){var e=this;if(this.W.Form.SyncContext!==a.a.DesignTimeForm)return $.Deferred().resolve().promise();var n=this.W.Form;return n?n.Synchronizer.existingInDataSource().then((function(){var n,r=[];for(n in t)if(t.hasOwnProperty(n)){var o=Object(f.d)(i.pick(t,[n]));null!==o.elementKey&&"localename"!==o.elementKey&&(o.locale=e.W.Model.localeId,o.questionId="",r.push(Object(s.a)(o,e.W.FormId)))}return $.when.apply($,r).then((function(t){}))})):$.Deferred().reject().promise()},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||this.W.Form.SyncContext!==a.a.DesignTimeForm)return $.Deferred().resolve().promise();var n,r=[];for(n in t)if(t.hasOwnProperty(n)){var o=null!==e.ValuesBefore[n],c=Object(f.d)(i.pick(t,[n]));c.locale=this.W.Model.localeId,c.questionId="",r.push(o?this.I.updateLocaleItem(this.W.FormId,c):this.I.createLocaleItem(this.W.FormId,c))}return $.when.apply($,r).then((function(t){}))},t}(),h=n(36);n.d(e,"a",(function(){return m}));var d={footerText:c.a.string(),formCloseMessage:c.a.string(),formsprortlocalesubtitle:c.a.string(),formsprortlocaletitle:c.a.string(),localeId:c.a.string({IsKeyField:!0}),localeName:c.a.string(),questionResources:c.a.collectionOf((function(){return h.a})),subtitle:c.a.string(),thankYouMessage:c.a.string(),title:c.a.string()},m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LocaleId",{get:function(){return this.Model.localeId},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LocaleName",{get:function(){return this.Model.localeName},enumerable:!0,configurable:!0}),e.getFormResourceMaster=function(t,e){var n=i.find(e.Model.LocalizedResources,(function(e){return e.localeId===t}));if(n)return o.a.getObjectMasterFromModel(n);throw Error("This locale does not exist in form.")},e.getQuestionResourceMaster=function(t,e,n){var r=n.Model.LocalizedResources,i=o.a.Collection.getItemWithKeyFields(r,{localeId:t});if(i){if(i.questionResources||(i.questionResources=[]),i.questionResources.length>0){var c=o.a.Collection.getItemWithKeyFields(i.questionResources,{localeId:t,questionId:e});if(c)return o.a.getObjectMasterFromModel(c)}return Object(f.c)({localeId:t,localeName:i.localeName},e,i,n)}throw Error("This locale does not exist in form.")},e}(o.a.createObjectMasterClass("FormLocalizedItemMaster",d,(function(t){return new l(t)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return s}));var r=n(28),i=n(20);function o(){return i.a.Resolve("IAWTLogger")}function c(){o().initialize(),Object(r.a)(u)}function s(){var t=o();return t&&t.SessionId}function u(){var t=$.Deferred(),e=o();return e?e.flush((function(){return t.resolve()})):t.resolve(),t.promise()}},,function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return a}));var r=n(5),i=n(15);function o(){if(Object(r.a)().isOembedSPO&&$(".office-form.office-form-theme-shadow").height()&&$(".office-form-footer-container").height()){var t=$(".office-form.office-form-theme-shadow").height()+$(".office-form-footer-container").height()+80;s("ResponsePage",t+=$(".office-form-new-bottom-bar").height()?$(".office-form-new-bottom-bar").height():0)}}function c(t){Object(r.a)().isOembedSPO&&s("ResponsePage",t)}function s(t,e){var n=Object(i.c)().hostId;if(n)parent.postMessage("FormsPageHeight:"+n+":"+e.toString(),"*");else{var r=Object(i.c)().id;parent.postMessage(t+"Height:"+r+":"+e.toString(),"*")}}function u(t){if(Object(r.a)().isOembedSPO){var e=t.Model.Title?t.Model.Title:"",n=t.Model.Description?t.Model.Description:"",o=Object(i.c)().hostId;parent.postMessage("FormsInfo:"+o+":"+encodeURIComponent(e)+":"+encodeURIComponent(n),"*")}}function a(t){if(Object(r.a)().isOembedSPO){var e=t&&(t.innerCode||t.message||""),n=Object(i.c)().hostId;parent.postMessage("FormsError:"+n+":"+encodeURIComponent(e),"*")}}var f=window.onerror;window.onerror=function(t,e,n,r,i){a(i),f&&f.apply(this,arguments)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(4),o=n(1),c=(n(21),n(10)),s=(n(7),n(18)),u={Answer:o.a.reference(),AnswerEntity:o.a.reference(),BranchedElement:o.a.reference(),BranchingType:o.a.string(),NextQuestionInOrder:o.a.reference(),NextQuestionInitialized:o.a.boolean(),QuizResult:o.a.reference(),ShowPhishingFormWarning:o.a.boolean(),Visible:o.a.reference(),FormsProOrdinal:o.a.reference(),FormsProRuntimeTitle:o.a.reference(),FormsProRuntimeSubtitle:o.a.reference(),InitialFormsProLocalizedRuntimeTitle:o.a.reference(),InitialFormsProLocalizedRuntimeSubtitle:o.a.reference(),SelectedChoice:o.a.reference()},a=function(t){function e(e,n){var r=t.call(this)||this;return r.Re=function(){return r.updateBranchedQuestion()},r.gt=e,r.gt.observe(r.Re),r.Ee=n,r.addRule({Name:"UpdateBranchedQuestion",onChange:function(t){return r.updateBranchedQuestion()}}),r}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Question",{get:function(){return this.gt},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SubQuestions",{get:function(){return this.Question.SubQuestionMasters},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SubQuestionRuntimeMasters",{get:function(){var t=this;return this.SubQuestions.map((function(e){return t.getSubQuestionRuntimeById(e.Model.Id)}))},enumerable:!0,configurable:!0}),n.getSubQuestionRuntimeById=function(t){return this.Ee?this.Ee.getOrCreateQuestionRuntimeById(t):null},n.verifyAnswer=function(){if(0===this.SubQuestionRuntimeMasters.length){if(this.Question.Model.IsMathQuiz){var t=Object(c.u)(this.Model.Answer||"{}"),e=null==t.Answer?this.Model.Answer:t.Answer;return this.Question.verify(e)===s.e.Success}return this.Question.verify(this.Model.Answer)===s.e.Success}return this.SubQuestionRuntimeMasters.every((function(t){return t.Question.verify(t.Model.Answer)===s.e.Success}))},n.release=function(){this.gt.unobserve(this.Re)},n.getAnswerEntity=function(){return{Answer:this.Question.getNormalizedAnswer(this.Model.Answer),QuestionId:this.Question.Model.Id}},n.calculateQuizResultFromModel=function(){0===this.SubQuestionRuntimeMasters.length?this.Model.QuizResult=this.Question.createQuizResult(this.Model.Answer):this.Model.QuizResult={IsAnswerCorrect:!1}},n.getScore=function(){var t=this.Model.AnswerEntity,e=t&&t.Score;return null!=e?e:this.Question.autoGradeWithQuizResult(this.Model.Answer,this.Model.QuizResult)},n.updateBranchedQuestion=function(){if(!this.Question.Deleted){var t=this.Model,e=this.Question.getBranchedResult(t.Answer,t.NextQuestionInOrder);this.bulkEdit((function(t){t.BranchedElement=e.TargetElement,t.BranchingType=e.Type}))}},n.Ae=function(){},e}(i.a.createObjectMasterClass("QuestionRuntime",u))},function(t,e,n){"use strict";n.d(e,"c",(function(){return h})),n.d(e,"e",(function(){return d})),n.d(e,"d",(function(){return m})),n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return v}));var r=n(29),i=n(9),o=n(5),c=n(8),s=n(15),u=n(28),a=n(10),f=n(25),l=n(22);function h(t){var e=v(t);return d(e)?$.Deferred().promise():e}function d(t){return 401===t.statusCode&&!Object(r.k)()&&(function(t){if(t){var e=void 0;switch(t.innerCode){case 702:e="Auth.NotOnboardedTenant";break;case 703:e="Auth.DisabledByTenantAdmin";break;case 705:e="Auth.UserNeedMultiFactorAuth"}e&&l.a.logData({extraData:{tenantId:Object(o.a)().userInfo.TenantId},name:e})}}(t),Object(s.c)().embed?(t.innerCode=10001,!1):(700===t.innerCode||701===t.innerCode)&&(Object(a.s)()&&Object(a.j)()&&Object(a.f)()?(t.innerCode=15003,!1):(Object(f.a)().AuthContext.signIn().then((function(){return Object(u.b)()})),!0)))}function m(t){return b(t).value}function b(t){var e={status:0};if(null==t)e.value=t;else{var n=t["@odata.count"]&&parseInt(t["@odata.count"]);isNaN(n)||(e.count=n),e.value=Object(a.u)(void 0===t.value?t:t.value)}return e}function v(t){var e={correlationId:t&&t.response&&t.response.headers&&Object(c.c)(t.response.headers,"X-CorrelationId"),headers:t&&t.response&&t.response.headers,statusCode:t&&t.response&&t.response.statusCode,statusText:t&&t.response&&t.response.statusText},n=t&&t.response&&Object(a.u)(t.response.body),r=n.error&&parseInt(n.error.code);return isNaN(r)?e.innerCode=0===e.statusCode?15001:void 0:e.innerCode=r,e.innerMessage=n.error&&n.error.message,e.type=n.error&&n.error["@ms.form.error.type"],Object(i.b)("FormCustomizedMessage")&&(e.customizedMessage=n.error&&n.error["@ms.form.error.customizedMessage"]),e.isServerError=!0,e}},function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return u}));var r=n(9),i=n(15);function o(t){return/^(https ?\:\/\/)?((www\.)?youtube\.com|youtu\.?be)\/.+$/.test(t)}function c(t){return/^(https ?\:\/\/)?(?:msit|web)\.microsoftstream\.com\/.+$/.test(t)}function s(t){return o(t)||c(t)}function u(t){return Object(r.b)("SupportStreamVideo")?o(t)?a(t):c(t)?function(t){var e=t.indexOf("/video");return t.slice(0,e)+"/embed"+t.slice(e)+"?autoplay=false&amp;showinfo=true&amp;app=forms"}(t):void 0:a(t)}function a(t){var e=document.createElement("a");e.href=t;var n=e.pathname.split("/"),r=t.substring(t.indexOf("?")+1);return"https://www.youtube.com/embed/"+(Object(i.c)(r).v||n[0]||n[1])+"?feature=oembed&modestbranding=1&rel=0"}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return a}));var r=n(3),i=n(12),o=n(5),c=n(109),s=function(){function t(){}return t.SettingsAllowResponderGetAllResponses="Settings.AllowResponderGetAllResponses",t.DisableEditForm="DisableEditForm",t.ResponsePagePollView="ResponsePage.PollView",t}(),u={Poll:[s.SettingsAllowResponderGetAllResponses,s.DisableEditForm,s.ResponsePagePollView],"Teams Poll":[s.DisableEditForm]};function a(t,e){var n;if(Object(c.b)(t))n=t;else if(t){var s=t;if(s.isFieldReady(i.a.Schema.OwnerId)&&!s.IsGroupForm&&s.Model.OwnerId!==Object(o.a)().userInfo.UserId)return!1;n=s.Model.Category}return!!n&&r.contains(u[n],e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));var r=n(2),i=n(0),o=n(3),c=n(90),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._e=i.createRef(),e}Object(r.c)(e,t);var n=e.prototype;return n.render=function(){var t;return(t=o.clone(this.props)||{}).children=this.props.Text,t.ref=this._e,!(t.HTMLAttributes&&t.HTMLAttributes.title)&&this.props.Text&&(t.HTMLAttributes=o.clone(t.HTMLAttributes)||{},t.HTMLAttributes.title=this.props.Text),i.createElement(c.a,Object(r.a)({},t))},n.focus=function(){this._e.current&&this._e.current.focus()},e}(n(16).a);function u(t){return i.createElement(s,Object(r.a)({},t))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(2),i=n(0),o=n(3),c=n(8),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return n.render=function(){var t=o.extend({},this.props.HTMLAttributes);return this.props.ValidationStyle&&(t.className=Object(c.a)(t.className,this.props.ValidationStyle)),this.props.Hidden&&(t.style=t.style||{},t.style.display="none"),i.createElement.apply(i,Object(r.f)(["div",t],this.createReactNodes()))},n.createReactNodes=function(){throw Error("to be overridden.")},e}(i.Component)},function(t,e,n){"use strict";n.d(e,"a",(function(){return S})),n.d(e,"b",(function(){return I}));var r,i=n(3),o=n(56),c=n(11),s=n(29),u=n(9),a=n(95),f=n(34),l=n(5),h=n(46),d=n(8),m=n(28),b=n(25),v=(n(7),n(78)),g=n(58),p=n(102),O=n(76),j=n(53),w=n(62);function S(t,e){e=e||{};var n,d=$.Deferred();(e.disableLog||(n=new v.a(t.qosEventName),i.extend(n.Data,{extraData:i.clone(t.qosExtraData)}),n.start(),t.headers["X-CorrelationId"]=n.CorrelationId,t.headers["X-UserSessionId"]=Object(g.b)()),e.disableXMsHeader)||(t.headers["x-ms-form-request-source"]=function(){var t="ms-formweb";if(Object(s.j)()){var e=Object(s.b)();e&&(t="ms-"+e.toLowerCase()),Object(l.a)().isOembedSPO&&(t="forms-webpart")}return t}(),function(t){if(!r){if(Object(u.b)("LeverageServerRingLogic")&&Object(l.a)().ring&&!Object(c.t)())return $.Deferred().resolve(Object(l.a)().ring.toLowerCase()).promise();r="USGovGccProd"===Object(c.d)()?$.Deferred().resolve("gcc").promise():Object(j.f)()||Object(f.c)()?$.Deferred().resolve("msa").promise():Object(j.g)()||Object(f.d)()?$.Deferred().resolve("msft").promise():Object(j.e)()||Object(f.e)()?$.Deferred().resolve("fastfood").promise():$.Deferred().resolve("business").promise()}return r}().done((function(e){t.headers["x-ms-form-request-ring"]=e})));var S=-1,F=Object(a.a)("DatabaseUnavailableRetryTimes")||100,y=function(){S++,function(t,e,n,r){void 0===r&&(r=!1);t.blobResponseType?function(t,e,n){var r=new XMLHttpRequest,i=t.requestUri;if(r.onreadystatechange=function(){if(null!=r&&4===r.readyState){var o=r.status,c=r.statusText;1223===o&&(o=204,c="No Content");var s=r.response;if(o>=200&&o<=299)r=null,e(s);else{var u=function(t){for(var e={},n=0,r=t.getAllResponseHeaders().split(/\r?\n/);n<r.length;n++){var i=r[n];if(i){var o=i.split(": ");e[o[0]]=o[1]}}return e}(r);r=null,n({message:"HTTP request failed",request:t,response:{requestUri:i,statusCode:o,statusText:c,headers:u,body:s}})}}},r.open(t.method||"GET",i,!0),r.responseType="blob",t.headers)for(var o in t.headers)r.setRequestHeader(o,t.headers[o]);r.send(t.body)}(t,e,r?n:i):odatajs.oData.request(t,e,r?n:i);function i(r){Object(o.c)(r)?Object(b.a)().AuthContext.refreshToken().done((function(){Object(h.e)((function(){t.headers.__RequestVerificationToken=Object(l.a)().antiForgeryToken,function(){var t=$.Deferred();if(Object(l.a)().userInfo.UserId)return t.resolve().promise();return Object(h.g)((function(){return t.resolve()}),(function(){return t.resolve()})),t.promise()}().always((function(){return odatajs.oData.request(t,e,n)}))}),(function(){return Object(m.d)()}))})):n(r)}}(t,(function(t){d.resolve(t)}),(function(e){var r,i=I(t.isSensitiveUri?"":t.requestUri.toString(),e),o=parseInt(i.statusCode),c=i.innerCode,s=!1,u=0;0===o||502===o||503===o?(r="Forms_Http_"+o,s=S<2):6503===c||624===c||647===c?(r="CDB_Http_"+c,s=S<2):645!==c&&646!==c||(Object(b.a)().RetryingRecoverableError=!0,r="CDB_Http_"+c,s=S<F,u=Math.min(1e3*Math.pow(2,S)*(.8+.4*Math.random()),6e4)),s?(n&&n.log({resultCode:r,extraData:{RetryCount:S,ServiceError:i}}),setTimeout(y,u)):d.reject(e)}),e.skipExpiredTokenCheck)};return y(),n?d.promise().done((function(e){var r={};if(r.resultCode=e&&e.response?e.response.statusCode:"",r.resultType="Success","Form.Create"===t.qosEventName){var o=Object(w.d)(e);r.extraData={FormId:o.id,XLWorkbookId:o.xlWorkbookId||void 0,Origin:Object(p.a)()||void 0,RetryCount:S||void 0},i.extend(r.extraData,t.qosExtraData)}n.end(r)})).fail((function(e){var r=I(t.requestUri.toString(),e);n.end({resultCode:e&&e.response?e.response.statusCode:"",resultType:Object(O.b)(r)?"ExpectedFailure":"Failure",extraData:{ServiceError:r,RetryCount:S||void 0}})})):d.promise()}function I(t,e){var n=Object(w.b)(e);return{statusCode:e&&e.response?e.response.statusCode:"",sourceUrl:t,correlationId:e&&e.response?Object(d.c)(e.response.headers,"X-CorrelationId"):"",statusText:e&&e.response?e.response.statusText:"",innerCode:n?n.innerCode:-1,innerMessage:n?n.innerMessage:"",failureReason:e&&e.response?Object(d.c)(e.response.headers,"X-FailureReason"):"",failureType:n?n.type:void 0}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(4),i=0,o=function(){function t(t,e,n){this.W=t,this.Ue=e,this.$e=n.FieldSchemas,this.Be()}var e=t.prototype;return e.serialize=function(){var t=this.W.getSnapshot(this.$e),e=this.W.Schema,n={};this.$e.forEach((function(e){var i=r.a.getFieldSchemaInfo(e).Name;n[i]=r.a.convertToSourceData(t[i],e)}));var o=r.a.getFieldSchemaInfo(this.Ue).Name,s=c(n,e,[]),u=s&&JSON.stringify(s),a=this.W.Model[o]!==u;(a||Math.random()<i)&&(a=!0,u=(s=c(n,e,null))&&JSON.stringify(s)),a&&(this.W.Model[o]=u)},e.deserialize=function(){var t=r.a.getFieldSchemaInfo(this.Ue).Name,e=this.W.Model[t],n=e?JSON.parse(e):{},i={};this.$e.forEach((function(t){var e=r.a.getFieldSchemaInfo(t).Name;i[e]=r.a.convertFromSourceData(n[e],t)})),this.W.setData(i,this.$e)},e.Be=function(){var t=this,e=r.a.getFieldSchemaInfo(this.Ue).Name;this.W.addRule({Name:"Deserialize - "+e,InterestedFields:[this.Ue],onChange:function(e){e.BeingDeleted||t.deserialize()}}),this.W.addRule({Name:"Serialize - "+e,InterestedFields:this.$e,onChange:function(e){e.BeingDeleted||t.serialize()}})},t}();function c(t,e,n){if(null==t)return null;if(Array.isArray(t)){if(t.length){var i=e[0];return t.map((function(t){return c(t,i,n)}))}return n}var o={},s=0;return r.a.getSubFieldSchemas(e).forEach((function(e){var i=r.a.getFieldSchemaInfo(e),u=i.Attributes.SourceFieldName||i.Name,a=t[u];i.IsLeaf||(a=c(a,e,n)),null!=a&&(++s,o[u]=a)})),s>0?o:null}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(3),i=n(4),o=n(109),c=function(){function t(t){this.qe=t.concat(),this.Qe=t.map((function(t){return i.a.getFieldSchemaInfo(t).Name}))}var e=t.prototype;return Object.defineProperty(e,"FieldSchemas",{get:function(){return this.qe.concat()},enumerable:!0,configurable:!0}),e.covers=function(t){return Object(o.b)(t)?r.contains(this.Qe,t):r.contains(this.qe,t)},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),i=n(0),o=(n(7),n(81)),c=n(66),s=n(99);function u(t){return i.createElement(a,t)}var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ze=!1,e.He=!1,e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.He=!0,this.ze||window.setTimeout((function(){t.ze=!0,t.He&&t.forceUpdate()}))},n.componentWillUnmount=function(){this.He=!1},n.createReactNodes=function(){var t=this.props,e=t.ShowRequiredStar?i.createElement(s.a):void 0,n=t.ShowOrdinal?i.createElement("span",{className:"ordinal-number",key:"ordinalNumber"},this.props.Ordinal+"."):void 0;if(!t.Alert||this.ze)var r=Object(o.a)({ContainsHtml:!1,Text:t.Label,RenderMode:"RichText"});return t.Bold?[i.createElement("b",void 0,n,r,e),t.children]:[n,r,e,t.children]},e}(c.a)},function(t,e,n){"use strict";function r(t){return $.Deferred().reject(t).promise()}function i(t){return $.Deferred().resolve(t).promise()}function o(t){return t?t.then(null,(function(){return i()})):i()}n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return f}));var r=n(17),i=n(5),o=Date.now(),c={},s={},u=function(){try{var t="FormsVersion"+window.location.pathname,e=window.localStorage.getItem(t),n=Object(i.a)().version;return e===n||(window.localStorage.setItem(t,n),!1)}catch(t){return!1}}();function a(t,e){var n=Date.now(),r={sa:n-o};return c[t]=r,e.done((function(){r.d=Date.now()-n})).fail((function(){r.d=Date.now()-n,r.f=1}))}function f(){var t=window.NavKeyPoints;Object(r.a)({eventName:"Forms.PerformanceAnalysis",eventType:"engagement_event",extraData:{checkPoints:s,requests:c,requestsAll:Date.now()-o,scriptCached:u,scriptDownload:t&&t.PageStartTime&&o-t.PageStartTime,version:1}})}},function(t,e,n){"use strict";function r(t){var e=(t||"").trim().replace(/[,]/g,"");return $.isNumeric(e)}function i(t){var e=(t||"").trim().replace(/[,]/g,"");return $.isNumeric(e)?parseFloat(e).toString():""}function o(t){return Math.floor(t)===t}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return u}));var r,i=n(46),o=n(50),c="Customized Theme",s={BackgroundColor:"#E8F2F4",BackgroundImage:null,Name:"Default Theme",PrimaryColor:"#008272",SecondaryColor:"#004B50",Thumbnail:Object(o.a)("/Images/Theme/teal-thumbnail.png")};function u(t){return function(t){return r||(r=Object(i.c)(t||s.Name).then(JSON.parse)),r}(t).then((function(e){return function(t){if(!t)return t;var e=t.BackgroundImage;null!=e&&/^\/Images\//i.test(e)&&(t.BackgroundImage=Object(o.a)(e));var n=t.Thumbnail;null!=n&&/^\/Images\//i.test(n)&&(t.Thumbnail=Object(o.a)(n));return t}(e[t])||s}))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return l})),n.d(e,"f",(function(){return h})),n.d(e,"e",(function(){return d}));function r(t){var e=[t.R,t.G,t.B].map((function(t){return(t/=255)<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}));return.2126*e[0]+.7152*e[1]+.0722*e[2]}function i(t){return(r({R:255,G:255,B:255})+.05)/(r(t)+.05)>4.5}function o(t){return i(t)?{R:255,G:255,B:255}:{R:0,G:0,B:0}}function c(t){var e=t.toString(16);return 1===e.length?"0"+e:e}function s(t){return"#"+c(t.R)+c(t.G)+c(t.B)}function u(t){var e,n=t.R,r=t.G,i=t.B,o=Math.max(n,r,i),c=Math.min(n,r,i),s=o-c,u=0===o?0:s/o,a=o/255;switch(o){case c:e=0;break;case n:e=r-i+s*(r<i?6:0),e/=6*s;break;case r:e=i-n+2*s,e/=6*s;break;case i:e=n-r+4*s,e/=6*s}return{H:e,S:u,V:a}}function a(t){var e,n,r,i,o,c,s,u,a=t.H,f=t.S,l=t.V;switch(c=l*(1-f),s=l*(1-(o=6*a-(i=Math.floor(6*a)))*f),u=l*(1-(1-o)*f),i%6){case 0:e=l,n=u,r=c;break;case 1:e=s,n=l,r=c;break;case 2:e=c,n=l,r=u;break;case 3:e=c,n=s,r=l;break;case 4:e=u,n=c,r=l;break;case 5:e=l,n=c,r=s}return{R:Math.round(255*e),G:Math.round(255*n),B:Math.round(255*r)}}function f(t){t.startsWith("#")&&(t=t.substring(1));var e=parseInt(t,16);return{R:e>>16&255,G:e>>8&255,B:255&e}}function l(t){var e=f(t),n=u(e);return r(e)>186&&(n.V=.45,e=a(n)),s(e)}function h(t){var e=u(f(t));return s(a({H:e.H,S:e.S,V:e.V-.1}))}function d(t){var e,n=u(f(t));return e=n.S>.05?.05:0,s(a({H:n.H,S:e,V:.95}))}},function(t,e,n){"use strict";function r(t,e){return c(e,t&&t.type,t&&t.statusCode)}function i(t,e){return c(e,t&&t.failureType,t&&t.statusCode)}function o(t){var e=t;if(e&&e.statusCode)return JSON.stringify({correlationId:e.correlationId,innerCode:e.innerCode,innerMessage:e.innerMessage,isServerError:e.isServerError,statusCode:e.statusCode,statusText:e.statusText,type:e.type});var n=t;return n&&n.message?JSON.stringify({message:n.message,name:n.name,stack:n.stack}):JSON.stringify(t||"")}function c(t,e,n){switch(t){case"Information":case"FormsProInformation":return!0;case"Error":return!1;default:switch(e){case"Failure":return!1;case"ExpectedFailure":return!0;default:var r=parseInt(n);if(r>=0&&r<500)return!0}}return!1}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o}))},function(t,e,n){"use strict";var r=n(34),i=n(20);var o=n(17),c=n(9),s=n(95);function u(t){Object(r.c)()||i.a.Resolve("IThirdPartyLinkify").then((function(){return function(t){if(t.linkify(),Object(c.b)("LinkifyEscape")){var e=/^[a-z0-9]\.|\.xxx/i,n=Object(s.a)("LinkifyEscapeRegex");n&&(e=new RegExp(n,"i")),t.find("a.linkified").each((function(t,n){$(n).text().match(e)&&$(n).contents().unwrap()}))}t.find("a.linkified").length&&Object(o.a)({eventName:"NeedLinkify",eventType:"engagement_event"})}(t)}))}n.d(e,"a",(function(){return u}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(3),i=n(30),o=n(88),c=function(){function t(t){this.Ve=null,this.Ge={CorrelationId:Object(i.b)(),Data:{},Duration:0,Name:t},this.Ve=new o.a(t)}var e=t.prototype;return Object.defineProperty(e,"Name",{get:function(){return this.Ge.Name},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Duration",{get:function(){return this.Ge.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CorrelationId",{get:function(){return this.Ve.CorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Data",{get:function(){return this.Ge.Data},enumerable:!0,configurable:!0}),e.start=function(){this.Ve.ExtraData=this.Data.extraData,this.Ve.start()},e.end=function(t){var e=this.We(t);this.Ve.end({extraData:e.Data.extraData,logLevel:"Info",resultCode:e.Data.resultCode,resultType:e.Data.resultType})},e.log=function(t){var e=this.We(t);this.Ve.log({extraData:e.Data.extraData,logLevel:"Info",resultCode:e.Data.resultCode,resultType:e.Data.resultType})},e.We=function(t){var e=r.clone(this.Ge);return e.Data=r.extend({},this.Ge.Data,t),e},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(0),o=n(3),c=n(8),s=(n(7),n(90)),u=n(24);function a(t){var e,n,a=o.clone(t)||{};switch(a.HTMLAttributes=o.clone(a.HTMLAttributes)||{},t.GlyphButtonStyle){case 1:case"Vertical":a.HTMLAttributes.className=Object(c.a)(a.HTMLAttributes.className,"glyph-button-control-vertical");break;case 2:case"GlyphOnly":case 0:case"Horizontal":default:a.HTMLAttributes.className=Object(c.a)(a.HTMLAttributes.className,"glyph-button-control-horizontal")}if(!a.HTMLAttributes.title&&t.Text&&(a.HTMLAttributes.title=t.Text),!a.HTMLAttributes["aria-label"]&&t.Text&&(a.HTMLAttributes["aria-label"]=t.Text),t.Icon){var f={HTMLAttributes:{className:t.IconClassName},IconName:t.Icon,key:"icon"};e=i.createElement(u.a,Object(r.a)({},f))}switch(a.ButtonStyle=t.ButtonStyle,"GlyphOnly"!==t.GlyphButtonStyle&&2!==t.GlyphButtonStyle&&(n=i.createElement("span",{className:t.TextClassName,key:"text"},t.Text)),t.GlyphLocation){case 1:case"Right":a.children=[n,t.children,e];break;case 0:default:a.children=[e,n,t.children]}return Object(s.b)(a)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return a}));var r,i=n(11),o=n(5),c=n(72),s=n(50);function u(t){return $.when.apply($,t.map(a))}function a(t){return v[t]||(v[t]=u(m[t]||[]).then((function(){return function(t){var e=$.Deferred();void 0===r&&(r=function(t){return Object.keys(t).reduce((function(e,n){return e[n]=function(t,e){if(d.indexOf(t)>=0)return e||"";return Object(s.b)(e,!1)}(n,t[n]),e}),{})}(h));var n=r[t];if(!n)throw Error("No script path for "+t);var i=document.getElementsByTagName("head")[0];if(!i)return e.reject(Error("No head element found!")).promise();var c=document.createElement("script");c.type="text/javascript",c.async=!0,c.src=n,Object(o.a)().isCdnEnabled&&d.indexOf(t)<0&&(c.crossOrigin="anonymous");return c.onload=function(){e.resolve()},c.onerror=function(t){i.removeChild(c),e.reject(Error("Failed to load javascript file: "+n))},i.appendChild(c),e.promise()}(t)})),"undefined"!=typeof Forms&&Object(c.b)("script:"+t,v[t])),v[t]}var f=Object(o.a)().scriptSuffix,l=Object(o.a)().isCdnEnabled,h={"combined-design":l?"Vendors/combinedmin/design_v3.min.js":"Vendors/combined/design_v3_e982333.js","combined-response":l?"Vendors/combinedmin/response_v2.min.js":"Vendors/combined/response_v2_e8aff49.js",BootStrap:"Vendors/bootstrap/3.4.1/bootstrap."+f,DataTables:"Vendors/DataTables."+f,Chart:"Vendors/Chart-2.6."+f,Clipboard:"Vendors/clipboard-1.7.1.min.js",ColorThief:"Vendors/color-thief/color-thief.min.js",Cropper_Modified:"Vendors/cropper/cropper.modified."+f,D3:"Vendors/d3/d3."+f,FileSave:"Vendors/FileSaver.min.js",Heatmap:"Vendors/highcharts/heatmap.min.js",HighCharts:"Vendors/highcharts/highcharts.min.js",HighCharts_More:"Vendors/highcharts/highcharts-more.min.js",ImmersiveReader:"Vendors/ImmersiveReader/immersive-reader-sdk.0.0.2.min.js",Ivy:"//edera.cloudapp.net/javascripts/api/ivy.js",OfficeBrowserFeedback:"Vendors/officebrowserfeedback/1.4.2/officebrowserfeedback_floodgate.min.js",JQuery_RateIt:"Vendors/rating-1.1.0/jquery.rateit."+f,JQuery_Picker:"Vendors/pickadate-3.5.6/picker."+f,JQuery_Picker_Date:"Vendors/pickadate-3.5.6/picker.date."+f,JQuery_Picker_Time:"Vendors/pickadate-3.5.6/picker.time."+f,JQuery_QRCode:"Vendors/jquery.qrcode.min.js",Linkify:"Vendors/linkify-2.1.8/linkify.min.js",Linkify_JQuery:"Vendors/linkify-2.1.8/linkify-jquery.min.js",MathJax:Object(i.q)()?"../scripts/vendors/mathjax/MathJax.js?config=TeX-AMS_HTML":"//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML",MathQuill:"Vendors/mathquill/mathquill."+f,O365ShellBootstrap:Object(o.a)().o365ShellBootHost?Object(o.a)().o365ShellBootHost.concat("/api/shellbootstrapper/",Object(o.a)().userInfo.IsMsa?"consumer":"business","/oneshell"):"",Pattern_Fill:"Vendors/highcharts/pattern-fill.min.js",Mark:"Vendors/markjs-8.9.0/mark."+f,SignalR:"Vendors/SignalR/jquery.signalR-2.4.1.min.js",Sortable:"Vendors/sortablejs-1.8.4/Sortable.modified."+f,WordCloud:"Vendors/highcharts/wordcloud.min.js",Xlsx:"Vendors/xlsx.core.min.js"};var d=["Ivy","MathJax","O365ShellBootstrap"];var m={};function b(t,e){m[t]=e}b("JQuery_Picker_Date",["JQuery_Picker"]),b("JQuery_Picker_Time",["JQuery_Picker"]),b("Linkify_JQuery",["Linkify"]),b("WordCloud",["HighCharts"]),b("HighCharts_More",["HighCharts"]),b("Heatmap",["HighCharts"]),b("Pattern_Fill",["HighCharts"]);var v={}},function(t,e,n){"use strict";var r=n(2),i=n(0),o=n(7),c=n(16),s=n(123),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=this.props,e=t.Html;!Object(o.b)((function(){return!0}))&&t.RenderHtml||(e=Object(s.a)(t.Html));var n=Object(o.c)((function(){return e}),o.e);return i.createElement("span",{dangerouslySetInnerHTML:{__html:n}})},e}(c.a);function a(t){return i.createElement(f,Object(r.a)({},t))}n.d(e,"a",(function(){return a}));var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=this;return"RichText"===(this.props.RenderMode||"PlainText")?Object(o.c)((function(){return i.createElement(u,{Html:t.props.Text})}),o.e):i.createElement("span",null,this.props.Text)},e}(c.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return l}));var r=n(2),i=n(0),o=n(38),c=i.lazy((function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(2).then(n.bind(null,146))];case 1:return[2,{default:t.sent().MathjaxFormulaRenderer}]}}))}))})),s=i.lazy((function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(2).then(n.bind(null,148))];case 1:return[2,{default:t.sent().VirtualKeyboardControl}]}}))}))})),u=i.lazy((function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(2).then(n.bind(null,147))];case 1:return[2,{default:t.sent().FormulaDesigner}]}}))}))}));function a(t){return i.createElement(o.a,null,i.createElement(s,Object(r.a)({},t)))}function f(t){return i.createElement(o.a,null,i.createElement(c,Object(r.a)({},t)))}function l(t){return i.createElement(o.a,null,i.createElement(u,Object(r.a)({},t)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(2),i=n(0),o=n(26),c=n(3),s=n(27),u=n(8),a=(n(7),n(22)),f=n(16),l=n(66),h=n(99);function d(t){return i.createElement(m,t)}var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Je=i.createRef(),e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.props.AutoFocus&&this.focus()},n.focus=function(){this.Je.current&&this.Je.current.focus()},n.createReactNodes=function(){return[this.Ke(),this.Xe()]},n.Ke=function(){var t=this.props,e=t.Options;if(t.Label||t.ShowRequiredStar)return i.createElement("div",null,i.createElement("span",{className:e&&e.classNameForInnerLabel},t.Label),t.ShowRequiredStar?i.createElement(h.a):void 0)},n.Xe=function(){var t,n,r,c,a=this,f=this.props,l=f.Options,h="DesignPage.ShortCut.Clipboard",d=Object(u.f)(l&&l.HTMLPropsForInnerElement,{value:f.Value||"",className:"office-form-textfield-input form-control border-no-radius",placeholder:f.Placeholder,ref:this.Je,style:{height:f.MinimalHeight+"px",overflowY:1===f.TextFieldType?"auto":void 0},spellCheck:!0,disabled:f.Disabled,onChange:this.Ye.bind(this),maxLength:f.MaxLength?f.MaxLength:Object(s.b)(),onFocus:f.AutoSelection?function(){if(a.Je.current){var t=o.findDOMNode(a.Je.current);t&&t.select()}}:void 0,onKeyDown:Object(u.g)((function(t){if(t.ctrlKey){var n=new Date,r=String.fromCharCode(t.keyCode),i="Ctrl+"+r;switch(r){case"C":case"X":a.Ze(e.prevTimeKeyDown,n.getTime())>e.minDuration&&a.tn(t,h,i),e.prevTimeKeyDown=n.getTime();break;case"V":a.tn(t,h,i);break;case"Y":case"Z":a.tn(t,"DesignPage.ShortCut.UndoRedo",i)}}})),onCopy:function(t){var n=new Date;a.Ze(e.prevTimeOnCopy,n.getTime())>e.minDuration&&a.tn(t,h,"onCopy"),e.prevTimeOnCopy=n.getTime()},onPaste:function(t){a.tn(t,h,"onPaste")},onCut:function(t){var n=new Date;a.Ze(e.prevTimeOnCut,n.getTime())>e.minDuration&&a.tn(t,h,"onCut"),e.prevTimeOnCut=n.getTime()}});switch(f.TextFieldType){case 2:var m=d,v=null==f.MinimalHeight?80:f.MinimalHeight>0?f.MinimalHeight:0;m.MinHeight=v.toString()+"px",t=function(t){return i.createElement(b,t)}(m);break;case 1:n=i.createElement("textarea",d);break;case 0:default:r=i.createElement("input",d)}if(f.ShowCharCounter){var g=!f.Value||d.maxLength>f.Value.length?"office-form-textfield-counter":"office-form-textfield-counter textfield-counter-warning";c=i.createElement("label",{className:g},this.en(f.Value,d.maxLength))}var p=Object(u.a)("office-form-textfield",f.Options&&f.Options.classNameForInnerDiv);return i.createElement("div",{className:p},t,n,r,c)},n.Ye=function(t){if(!this.props.Disabled){var e=t.target,n=e.value;if(n&&n.length>e.maxLength&&(n=n.slice(0,e.maxLength)),this.props.onValueChange(n),this.props.ShowCharCounter){var r=o.findDOMNode(e).nextSibling;r&&(r.innerText=this.en(n,e.maxLength))}}},n.en=function(t,e){return(t||"").length.toString()+" / "+e.toString()},n.tn=function(t,e,n){var r;this.props.HTMLAttributes&&(r=this.props.HTMLAttributes.className),a.a.logData({name:e,extraData:{targetClassName:r,operation:n}})},n.Ze=function(t,e){return e-t},e.prevTimeKeyDown=0,e.prevTimeOnCopy=0,e.prevTimeOnCut=0,e.minDuration=500,e}(l.a);var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Je=i.createRef(),e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.nn(),this.rn=this.nn.bind(this),window.addEventListener("resize",this.rn)},n.componentDidUpdate=function(){this.nn()},n.componentWillUnmount=function(){window.removeEventListener("resize",this.rn)},n.focus=function(){this.Je.current&&this.Je.current.focus()},n.render=function(){var t=c.clone(this.props);return t.ref=this.Je,delete t.MinHeight,i.createElement("textarea",t)},n.nn=function(){var t=o.findDOMNode(this),e=this.props,n=t.parentElement,r=n.style.height;n.style.height=window.getComputedStyle(n).height,t.style.height=e.MinHeight;var i=t.offsetHeight-t.clientHeight;t.style.height=t.scrollHeight+i+"px",n.style.height=r,t.style.minHeight=e.MinHeight},e}(f.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(2),i=n(4),o=n(1),c=n(9),s=n(47),u=n(85),a=n(18),f={TargetQuestionId:o.a.string(),ToTheEnd:o.a.boolean()},l=function(t){function e(n){var r=t.call(this,n)||this;return r.in=!1,r.cn=!1,r.sn=function(t){return r.un()},n.MasterTreeReady.done((function(){r.Deleted||(e.normalize(r,{},!1),r.addRule({Name:"normalize",onChange:function(t){e.normalize(r,t.OldValues,!0)}}),r.observe((function(t){r.Deleted||r.an()})))})),r}Object(r.c)(e,t);var n=e.prototype;return n.getElementMaster=function(){var t=this.Parent;do{if(t instanceof a.d||t instanceof s.a)return t}while(t=t.Parent);return null},n.getTargetElementMaster=function(){if(this.Deleted)return null;var t=this.getElementMaster().Form.FormElementManager;if(!this.Model.TargetQuestionId)return null;var e=t.getElementMasterById(this.Model.TargetQuestionId);return e&&e.Deleted?null:e?u.a.isSection(e.Model.Type)?e:t.findContainerSection(this.getElementMaster())===t.findContainerSection(e)&&e:e},n.resetToDefault=function(){var t=this;this.bulkEdit((function(){t.Model.ToTheEnd=null,t.Model.TargetQuestionId=null}))},n.isDefault=function(){return!this.Model.ToTheEnd&&!this.Model.TargetQuestionId},n.getBranchingResult=function(){var t=this.Model;return this.isValid()?t.ToTheEnd?{Type:"End"}:{Type:"Specified",TargetElement:this.getTargetElementMaster()}:{Type:"Next"}},n.hasSectionBranching=function(){var t=this.getElementMaster(),e=this.getTargetElementMaster();return u.a.isSection(t.Model.Type)||e&&u.a.isSection(e.Model.Type)},e.normalize=function(t,e,n){var r=t.Model;r.ToTheEnd?e.ToTheEnd&&r.TargetQuestionId||(r.TargetQuestionId=null):r.ToTheEnd=null,n&&t.fn()},n.isValid=function(){return this.in||(this.fn(),this.an()),this.cn},n.fn=function(){this.in=!0,this.cn=!(!this.Model.ToTheEnd&&!this.getTargetElementMaster()),this.cn=this.cn||!(!this.Model.TargetQuestionId||!Object(c.c)())},n.an=function(){var t=this.getTargetElementMaster(),e=this.ln;t!==e&&(e instanceof a.d?e.unobserve(this.sn):e instanceof s.a&&e.unobserve(this.sn),this.ln=t,t instanceof a.d?t.observe(this.sn):t instanceof s.a&&t.observe(this.sn))},n.un=function(){if(this.ln.Deleted)this.Model.TargetQuestionId=null;else if(this.ln instanceof a.d){var t=this.getElementMaster().Form.FormElementManager;t.findContainerSection(this.getElementMaster())!==t.findContainerSection(this.ln)&&(this.Model.TargetQuestionId=null)}},e}(i.a.createObjectMasterClass("BranchInfoMaster",f))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(3),i=n(4),o=n(47),c=n(12),s=n(18),u=function(){function t(t){this.formMaster=t}var e=t.prototype;return Object.defineProperty(t,"QuestionOrderFloor",{get:function(){return 500},enumerable:!0,configurable:!0}),Object.defineProperty(t,"QuestionOrderDefaultStep",{get:function(){return 100},enumerable:!0,configurable:!0}),t.isDescriptiveElement=function(t){return"Question.ColumnGroup"===t},t.isSection=function(t){return"Question.ColumnGroup"===t},Object.defineProperty(e,"TopQuestionMasters",{get:function(){return r.filter(this.formMaster.Model.Questions,(function(t){return!t.GroupId})).map(i.a.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"HeaderTopQuestionMasters",{get:function(){var t=this.SectionMasters,e=t.length&&t[0].Model.Order;return e>0?this.hn(null,e):this.TopQuestionMasters},enumerable:!0,configurable:!0}),Object.defineProperty(e,"HeaderQuestionMasters",{get:function(){var t=this.SectionMasters,e=t.length&&t[0].Model.Order;return e>0?this.hn(null,e,!0):this.QuestionMasters},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionMasters",{get:function(){return i.a.convertToArray(this.formMaster.Model.Questions).map(i.a.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DescriptiveElementMasters",{get:function(){return i.a.convertToArray(this.formMaster.Model.DescriptiveElements).map(i.a.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SectionMasters",{get:function(){return r.filter(this.DescriptiveElementMasters,(function(e){return t.isDescriptiveElement(e.Model.Type)}))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AllElementMasters",{get:function(){return this.getAllElements().map(i.a.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"TopElementMasters",{get:function(){return this.dn(!0).map(i.a.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),e.getQuestionById=function(t){var e=i.a.Collection.getItemWithKeyFields(this.formMaster.Model.Questions,{Id:t});return e&&Object(s.h)(e)},e.getElementMasterById=function(t){return this.getQuestionById(t)||this.getDescriptiveElementMasterById(t)},e.getDescriptiveElementMasterById=function(t){var e=i.a.Collection.getItemWithKeyFields(this.formMaster.Model.DescriptiveElements,{Id:t});return e&&Object(o.b)(e)},e.findQuestionsInSection=function(t,e){if(t){var n=this.SectionMasters,i=r.indexOf(n,t);return i>=0?this.hn(n[i].Model.Order,i+1<n.length?n[i+1].Model.Order:null,e):[]}return e?this.HeaderQuestionMasters:this.HeaderTopQuestionMasters},e.findContainerSection=function(t){var e=this.SectionMasters;return e[r.findLastIndex(e,(function(e){return e.Model.Order<=t.Model.Order}))]},e.adjustElementOrders=function(){var e=this;if(this.formMaster.isFieldReady(c.a.Schema.Questions)){var n=this.formMaster.isFieldReady(c.a.Schema.DescriptiveElements),r=this.getAllElements();r.length&&this.formMaster.bulkEdit((function(){r.sort(t.questionComparer),r[0].Order||(r[0].Order=t.QuestionOrderFloor+t.QuestionOrderDefaultStep);for(var i=0,o=r[0].Order,c=1;c<=r.length;++c){var s=r[c]&&r[c].Order;if(!s)break;if(o!==s){var u=(s-o)/(c-i);for(o+=u;++i<c;)r[i].Order=o,o+=u}}for(;++i<r.length;)o+=t.QuestionOrderDefaultStep,r[i].Order=o;e.formMaster.Model.Questions=r.filter((function(e){return!t.isDescriptiveElement(e.Type)})).map((function(t){return t})),n&&(e.formMaster.Model.DescriptiveElements=r.filter((function(e){return t.isDescriptiveElement(e.Type)})))}))}},e.getSectionNodes=function(){var t=this,e=[],n=this.HeaderTopQuestionMasters;return n.length&&e.push({TopQuestionMasters:n}),this.SectionMasters.forEach((function(n){e.push({Section:n,TopQuestionMasters:t.findQuestionsInSection(n)})})),e},e.getAllElements=function(){return this.dn(!1)},e.dn=function(e){var n=i.a.convertToArray(this.formMaster.Model.Questions);e&&(n=r.filter(n,(function(t){return!t.GroupId})));var o=n;return this.formMaster.isFieldReady(c.a.Schema.DescriptiveElements)&&(o=o.concat(i.a.convertToArray(this.formMaster.Model.DescriptiveElements)).sort(t.questionComparer)),o},t.questionComparer=function(t,e){var n=t.Order-e.Order;return t.Order&&e.Order||(n=-n),n||t.Id.localeCompare(e.Id)},e.hn=function(t,e,n){var r;return r=n?this.QuestionMasters:this.TopQuestionMasters,null!==e&&(r=r.filter((function(t){return e>t.Model.Order}))),null!==t&&(r=r.filter((function(e){return e.Model.Order>t}))),r},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(3),i=n(30),o=n(35),c=function(t,e,n){this.answer=t,this.id=e||Object(i.b)(),this.isMath=n},s=function(){function t(e){if(this.bn=[],null!=e.GradingBasis)try{this.bn=JSON.parse(e.GradingBasis)}catch(n){this.bn=[],o.a.logData({errorName:"ShortTextGradingBasisJsonParseFailure",errorInfo:{gradingBasisLength:e.GradingBasis.length,nonAsciiDetected:t.doesContainNonAsciiCharacters(e.GradingBasis)}})}else this.bn=[]}var e=t.prototype;return e.serialize=function(){return JSON.stringify(this.bn)},e.getAnswers=function(){return r.clone(this.bn)},e.areAnyAnswersDefined=function(){return 0!==this.bn.length},e.addAnswer=function(t,e){return!this.vn(t)&&(!this.gn(t)&&(this.bn.push(new c(t,void 0,e)),!0))},e.updateAnswer=function(t,e,n){if(this.vn(e))return!1;if(this.gn(e,t))return!1;var r=this.pn(t);if(r<0)return!1;var i=this.bn[r];return this.bn[r]=new c(e,i.id,n),!0},e.deleteAnswer=function(t){var e=this.pn(t);e>=0&&this.bn.splice(e,1)},e.isCorrect=function(t){return!this.vn(t)&&(t=(t+="").trim().toUpperCase(),null!=r.find(this.bn,(function(e){return e.answer.trim().toUpperCase()===t})))},e.gn=function(t,e){var n=(t+="").toUpperCase();return null!=r.find(this.bn,(function(t){return t.answer.toUpperCase()===n&&t.id!==e}))},e.vn=function(t){return null==t||""===t},e.pn=function(t){return r.findIndex(this.bn,(function(e){return e.id===t}))},t.doesContainNonAsciiCharacters=function(t){for(var e=0;e<t.length;e++)if(t.charCodeAt(e)>127)return!0;return!1},t}()},function(t,e,n){"use strict";var r=n(2),i=n(3),o=n(4),c=n(1),s=n(9),u=(n(8),n(15),n(21)),a=n(73),f=n(89),l=n(7),h=n(12),d=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;n.calculateQuestionRuntimeList=function(t){var e,n=this,r=[];i.forEach(t,(function(t){e=n.formRuntimeMaster.getOrCreateQuestionRuntime(t),r.push(e),t.SubQuestionMasters.forEach((function(t){var e=n.formRuntimeMaster.getOrCreateQuestionRuntime(t);r.push(e)}))})),this.formRuntimeMaster.Model.QuestionRuntimeMasters=r,this.formRuntimeMaster.ensureProRuleManager()},n.getPreviousSection=function(){var t,e=this.formRuntimeMaster,n=e.Model.RuntimeSectionId,r=e.Form.FormElementManager,o=r.getDescriptiveElementMasterById(n),c=r.SectionMasters,s=i.findLastIndex(c,(function(t){return t.Model.Order<o.Model.Order}));if(null==n||s<0)return null;for(;s>=0;){t=c[s];var u=this.getRuntimeQuestionsWithSectionId(t.Model.Id);if(!(u.length>0))break;if((u=u.filter((function(t){return e.formsProQuestionVisiblityCheck(t)}))).length>0)break;s--}return s<0?null:t},n.getNextSection=function(){for(var t,e=this.formRuntimeMaster,n=e.Model.RuntimeSectionId,r=e.Form,o=function(){if(null==n)t=r.hasSection()?i.min(r.FormElementManager.SectionMasters,(function(t){return t.Model.Order})):null;else{var o=r.FormElementManager.getDescriptiveElementMasterById(n);t=i.find(r.FormElementManager.SectionMasters,(function(t){return t.Model.Order>o.Model.Order}))}if(null==t)return"break";var s=c.getRuntimeQuestionsWithSectionId(t.Model.Id);return s.length>0?(s=s.filter((function(t){return e.formsProQuestionVisiblityCheck(t)}))).length>0?"break":void(n=t.Model.Id):"break"},c=this;;){if("break"===o())break}return t}}(function(){function t(){}var e=t.prototype;return e.hasPrevSection=function(){return!!this.formRuntimeMaster.Model.RuntimeSectionId},e.gotoPrevSection=function(){var t=this.getPreviousSection();this.formRuntimeMaster.Model.RuntimeSectionId=null==t?null:t.Model.Id},e.hasNextSection=function(){return!!this.getNextSection()},e.gotoNextSection=function(){var t=this.getNextSection();t&&(this.formRuntimeMaster.Model.RuntimeSectionId=t.Model.Id)},e.getAllSections=function(){var t=this,e=[];e.push({TopQuestionMasters:this.getRuntimeQuestionsWithSectionId()});var n=this.formRuntimeMaster.Form.FormElementManager.SectionMasters.map((function(e){return{Section:e,TopQuestionMasters:t.getRuntimeQuestionsWithSectionId(e.Model.Id)}}));return e=e.concat(n)},e.getCurrentSection=function(){var t=this.formRuntimeMaster,e=t.Model.RuntimeSectionId,n=e?t.Form.FormElementManager.getDescriptiveElementMasterById(e):void 0,r=this.getRuntimeQuestionsWithSectionId(e);return!this.formRuntimeMaster.Form.hasSection()||e||r.length||(n=this.getNextSection(),this.formRuntimeMaster.Model.RuntimeSectionId=n.Model.Id,r=this.getRuntimeQuestionsWithSectionId(n.Model.Id)),{Section:n,TopQuestionMasters:r}},e.isFirstPage=function(){var t=this.formRuntimeMaster.Model.RuntimeSectionId,e=this.formRuntimeMaster.Form.FormElementManager.SectionMasters,n=t&&e.length?e.map((function(t){return t.Model.Id})).indexOf(t):-1;return!t||0===n&&!this.getRuntimeQuestionsWithSectionId().length},e.getRuntimeQuestionsWithSectionId=function(t){var e,n=o.a.convertToArray(this.formRuntimeMaster.Model.QuestionRuntimeMasters).filter((function(t){return!t.Question.Model.GroupId})),r=this.formRuntimeMaster.Form;if(t){var c=r.FormElementManager.getDescriptiveElementMasterById(t);e=n.filter((function(t){return t.Question.Model.Order>c.Model.Order}));var s=i.find(r.FormElementManager.SectionMasters,(function(t){return t.Model.Order>c.Model.Order}));s&&(e=i.filter(e,(function(t){return s.Model.Order>t.Question.Model.Order})))}else{var u=r.FormElementManager.SectionMasters,a=u.length&&u[0].Model.Order;e=n,a>0&&(e=i.filter(e,(function(t){return t.Question.Model.Order<a})))}return e},t}()),n(85)),m=n(18),b=function(){function t(){this.On=[],this.jn=this.jn.bind(this)}var e=t.prototype;return t.getBranchedSections=function(e,n){for(var r=[],o=[],c=0,s=function(){var s=e[c];if(i.findIndex(r,(function(t){return t.Section===s.Section}))>=0)return"break";for(var u=[],a=void 0,f=s.TopQuestionMasters[0],l=function(){if(i.include(o,f))return"break";o.push(f),u.push(f);var t=n(f,s.TopQuestionMasters),r=t.TargetElement;r instanceof m.d?f=r:(r&&d.a.isSection(r.Model.Type)?a=i.findIndex(e,(function(t){return t.Section===r})):"End"===t.Type&&(a=-1),f=null)};f;){if("break"===l())break}r.push({Section:s.Section,TopQuestionMasters:u}),c=void 0!==a?a:t.getNextSectionFromSection(s,e)};c<=e.length-1&&c>=0;){if("break"===s())break}return r},e.calculateQuestionRuntimeList=function(e){var n=[],r=this.wn(e);this.formRuntimeMaster.IsDisableBranching||(r=t.getBranchedSections(r,this.jn));var i=this.On,o=this.Sn(r,n);if(t.isBranchingResultChanged(i,o)){this.On=o;var c=this.formRuntimeMaster.Model;this.formRuntimeMaster.bulkEdit((function(){c.QuestionRuntimeMasters=n,c.BranchChangeVersion=(c.BranchChangeVersion||0)+1}))}},e.hasPrevSection=function(){return this.In()>0},e.gotoPrevSection=function(){var t=this.In();if(t>0){var e=this.On[t-1];this.formRuntimeMaster.Model.RuntimeSectionId=e.Section&&e.Section.Model.Id}},e.hasNextSection=function(){return this.In()<this.On.length-1},e.gotoNextSection=function(){var t=this.Fn();t&&(this.formRuntimeMaster.Model.RuntimeSectionId=t)},e.getAllSections=function(){return this.On},e.getCurrentSection=function(){return this.yn(this.formRuntimeMaster.Model.RuntimeSectionId)},e.isFirstPage=function(){var t=this.getCurrentSection();return 0===this.On.indexOf(t)},t.isBranchingResultChanged=function(t,e){if(t.length!==e.length)return!0;for(var n=0;n<t.length;n++){if(t[n].Section!==e[n].Section||t[n].TopQuestionMasters.length!==e[n].TopQuestionMasters.length)return!0;for(var r=0;r<t[n].TopQuestionMasters.length;r++)if(t[n].TopQuestionMasters[r]!==e[n].TopQuestionMasters[r])return!0}return!1},e.jn=function(t,e){var n=this.formRuntimeMaster.getOrCreateQuestionRuntime(t),r=n.Model.BranchingType,i=n.Model.BranchedElement;return i instanceof m.d&&-1===e.indexOf(i)&&(i=e[e.indexOf(t)+1]),{TargetElement:i,Type:r}},e.Sn=function(t,e){var n=this;return t.map((function(t){return{Section:t.Section,TopQuestionMasters:t.TopQuestionMasters.map((function(t){var r=n.formRuntimeMaster.getOrCreateQuestionRuntime(t);return e.push(r),t.SubQuestionMasters.forEach((function(t){var r=n.formRuntimeMaster.getOrCreateQuestionRuntime(t);e.push(r)})),r}))}}))},t.getNextSectionFromSection=function(t,e){var n=t.Section,r=n&&n.Model.BranchInfo;if(r){if(r.ToTheEnd)return-1;var o=i.findIndex(e,(function(t){return t.Section&&t.Section.Model.Id===r.TargetQuestionId}));if(o>=0)return o}return i.findIndex(e,t)+1},e.yn=function(t){var e=this,n=i.find(this.On,(function(e,n){return t?e.Section&&t===e.Section.Model.Id:0===n}));return t&&!n&&(n=this.On[0],setTimeout((function(){e.formRuntimeMaster.Model.RuntimeSectionId=null}))),n},e.In=function(){return i.indexOf(this.On,this.getCurrentSection())},e.wn=function(t){var e=this.formRuntimeMaster.Form;return e.hasSection()?e.FormElementManager.getSectionNodes():[{TopQuestionMasters:t.filter((function(t){return!t.Model.GroupId}))}]},e.Fn=function(){var t=this.In();if(t<this.On.length-1&&t>=0){var e=this.On[t+1];return e.Section&&e.Section.Model.Id}},t}();function v(t){var e=new b;return e.formRuntimeMaster=t,e}var g=n(61);n.d(e,"a",(function(){return O}));var p={QuestionRuntimeMasters:c.a.collectionOf(c.a.reference()),RuntimeSectionId:c.a.string(),UploadingFileCount:c.a.number(),BranchChangeVersion:c.a.number()},O=function(t){function e(e,n){var r=t.call(this)||this;return r.Nn={},r.Tn=new f.a.CallbackManager,r.Cn=function(){return r.Tn.trigger()},r.Pn=function(t){return r.replaceAnswerTagsWithValue(t.Master)},r.xn=function(t){return r.Mn(t)},r.Ln=function(){return r.Mn()},r.Dn=function(){return r.Rn.callOnceLater()},r.Rn=new f.a.CallLater((function(){return r.En()}),0),r.An=e,r._n=v(r),n=n||{},r.Un=n.disableShuffle,r.$n=n.disableBranching,r.Mn(),r.Rn.callImmediately(),r.Model.UploadingFileCount=0,o.a.getCollectionMasterFromModel(e.Model.Questions).observe(r.xn),e.observe(r.Ln,[h.a.Schema.HasValidBranching,h.a.Schema.Settings.ShuffleQuestionOrder]),r}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.An},enumerable:!0,configurable:!0}),n.ElementManager=function(){return this._n},Object.defineProperty(n,"IsDisableBranching",{get:function(){return this.$n},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Answers",{get:function(){return o.a.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(t){return t.Question.hasAnswer()})).map((function(t){return t.getAnswerEntity()}))},set:function(t){var e=this,n={};i.forEach(t,(function(t){return n[t.QuestionId]=t.Answer})),this.bulkEdit((function(){e.An.FormElementManager.QuestionMasters.map((function(t){return e.getOrCreateQuestionRuntime(t)})).forEach((function(t){t.Model.Answer=n[t.Question.Model.Id]}))})),this.Rn.flush()},enumerable:!0,configurable:!0}),n.TopQuestionRuntimeMasters=function(){return o.a.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(t){return!t.Question.Model.GroupId}))},n.CurrentRuleManager=function(){return!1},n.isDefaultAnswer=function(){var t=this.An.getDefaultResponse();return o.a.convertToArray(this.Model.QuestionRuntimeMasters).every((function(e){var n=e.Question.Model.Id;return t[n]===e.Model.Answer}))},n.updateWithResponse=function(t){var e=this,n={};t&&t.Answers&&i.forEach(t.Answers,(function(t){return n[t.QuestionId]=t})),this.bulkEdit((function(){e.An.FormElementManager.QuestionMasters.map((function(t){return e.getOrCreateQuestionRuntime(t)})).forEach((function(t){var e=t.Question.Model.Id,r=n[e];t.bulkEdit((function(){t.Model.Answer=r&&r.Answer,t.Model.AnswerEntity=r}))}))})),this.Mn()},n.setQuizResults=function(t){var e=this;t.forEach((function(t){var n=e.Nn[t.id];n&&(n.Model.QuizResult={IsAnswerCorrect:t.isAnswerCorrect,AnswerHints:t.answerHints,IsAnswerKeys:t.answerKeys,Choices:i.map(n.Question.Model.Choices,(function(t){return t.Description})),GradingBasis:t.gradingBasis})}))},n.clearQuizResult=function(){for(var t in this.Nn)this.Nn[t].Model.QuizResult=void 0},n.resetQuestions=function(){},n.getQuestionResponseFromQueryString=function(){},n.calculateQuizResultFromModel=function(){o.a.convertToArray(this.Model.QuestionRuntimeMasters).forEach((function(t){return t.calculateQuizResultFromModel()}))},n.formsProQuestionVisiblityCheck=function(t){0},n.getQuestionsWithWrongAnswer=function(t){if(t.length<=0)return[];var e=this.TopQuestionRuntimeMasters(),n=i.findIndex(e,(function(e){return e.Question.Model.Id===t[0].Question.Model.Id}))+1;return t.map((function(t,e){return t.verifyAnswer()?-1:e+n})).filter((function(t){return t>0}))},n.getOrCreateQuestionRuntimeById=function(t){var e=this.An.getQuestionById(t);return e&&this.getOrCreateQuestionRuntime(e)},n.observeAnswerChange=function(t){this.Tn.register(t)},n.unobserveAnswerChange=function(t){this.Tn.unregister(t)},n.release=function(){for(var t in this.Nn){var e=this.Nn[t];e.unobserve(this.Dn),e.unobserve(this.Cn),e.release()}o.a.getCollectionMasterFromModel(this.An.Model.Questions).unobserve(this.xn),this.An.unobserve(this.Ln)},n.getOrCreateQuestionRuntime=function(t){var e=t.Model.Id;return this.Nn[e]||(this.Nn[e]=this.Bn(t)),this.Nn[e]},n.Bn=function(t){var e=new g.a(t,this);return e.observe(this.Dn,[g.a.Schema.BranchedElement,g.a.Schema.BranchingType]),e.observe(this.Cn,[g.a.Schema.Answer]),e},n.Mn=function(t){var e,n=this,o=this.An.Model.Settings,c=this.An.FormElementManager;this.qn=c.TopQuestionMasters;var s=this.Form.hasSection();if(!s&&!this.Un&&!this.An.Model.HasValidBranching&&o.ShuffleQuestionOrder)if(o.ShuffleAllQuestions||null==o.ShuffleAllQuestions)this.qn=i.shuffle(this.qn);else if(Object(a.c)(o.LockGivenQuestionsStartDisplayOrder)&&Object(a.c)(o.LockGivenQuestionsEndDisplayOrder)){var u=o.LockGivenQuestionsStartDisplayOrder-1,f=o.LockGivenQuestionsEndDisplayOrder-1,l=this.qn.splice(u,f-u+1);this.qn=i.shuffle(this.qn),(e=this.qn).splice.apply(e,Object(r.f)([u,0],l))}s?c.getSectionNodes().forEach((function(t){return n.Qn(t.TopQuestionMasters)})):this.Qn(this.qn),t&&(t.AddedModels.length||t.RemovedModels.length)&&this.Rn.callOnceLater()},n.Qn=function(t){var e=this;t.forEach((function(n,r){var i=e.getOrCreateQuestionRuntime(n);i.bulkEdit((function(e){e.NextQuestionInOrder=t[r+1],e.NextQuestionInitialized=!0})),"Specified"===i.Model.BranchingType&&!i.Model.BranchedElement&&Object(s.c)()&&i.updateBranchedQuestion(),n.SubQuestionMasters.forEach((function(t){return e.getOrCreateQuestionRuntime(t)}))}))},n.ensureProRuleManager=function(){var t=this,e=this.An;return this.zn?$.Deferred().resolve("").promise():l.a.getFormsProBranching(e,Object(u.b)().Model,!0,!0).done((function(){t.zn=FormsPro.getRuleManager(t.An,t.Model.QuestionRuntimeMasters,t)}))},n.Hn=function(t,e,n){},n.En=function(){this._n.calculateQuestionRuntimeList(this.qn)},n.replaceAnswerTagsWithValue=function(t){},n.clearFileUploadAnswers=function(){this.Model.UploadingFileCount=0;var t=this.Model.QuestionRuntimeMasters;o.a.convertToArray(t).filter((function(t){return"Question.FileUpload"===t.Question.Model.Type})).forEach((function(t){return t.Model.Answer=void 0}))},e}(o.a.createObjectMasterClass("FormRuntime",p))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(3),i=n(41),o=n(30),c=n(17),s=function(){function t(t){this.Vn={correlationId:Object(o.b)(),duration:0,eventName:t,eventType:"qos_event",extraData:void 0},this.Gn=null}var e=t.prototype;return Object.defineProperty(e,"CorrelationId",{get:function(){return this.Vn.correlationId},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ExtraData",{get:function(){return this.Vn.extraData},set:function(t){this.Vn.extraData=t},enumerable:!0,configurable:!0}),e.start=function(){this.Gn=Object(i.b)();var t=this.We(this.Vn,"Start");Object(c.a)(t)},e.end=function(t){var e=this.We(t,"End");Object(c.a)(e)},e.log=function(t){var e=this.We(t,"Log");Object(c.a)(e)},e.We=function(t,e){var n=r.clone(this.Vn);switch(null!==this.Gn&&"Start"!==e&&(n.duration=Object(i.b)()-this.Gn),t.logLevel&&(n.logLevel=t.logLevel),t.extraData&&(n.extraData=t.extraData),e){case"Start":n.eventName+="."+e;break;case"Log":n.eventName+="."+e,t.resultCode&&(n.eventName+="."+t.resultCode);break;case"End":t.resultType&&(n.eventName+="."+t.resultType)}return n},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),i=function(){};!function(t){var e=function(){function t(t,e){void 0===e&&(e=0),this.Wn=t,this.Jn=e}var e=t.prototype;return e.callOnceLater=function(){var t=this;0!==this.Jn&&null!=this.Kn&&this.clear(),null==this.Kn&&(this.Kn=window.setTimeout((function(){t.callImmediately()}),this.Jn))},e.flush=function(){null!=this.Kn&&(this.clear(),this.Wn())},e.callImmediately=function(){null!=this.Kn&&this.clear(),this.Wn()},e.clear=function(){clearTimeout(this.Kn),this.Kn=void 0},t}();t.CallLater=e;var n=function(){function t(){this.Xn=[]}var e=t.prototype;return e.register=function(t){this.Xn.push(t)},e.unregister=function(t){this.Xn=r.without(this.Xn,t)},Object.defineProperty(e,"trigger",{get:function(){return this.Yn},enumerable:!0,configurable:!0}),e.clear=function(){this.Xn=[]},e.Yn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.Xn.forEach((function(e){return e.apply(void 0,t)}))},t}();t.CallbackManager=n}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return a}));var r=n(2),i=n(0),o=n(26),c=n(3),s=n(8);function u(t){return i.createElement(a,Object(r.a)({},t))}var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return n.render=function(){var t=c.extend({},this.props.HTMLAttributes);switch(t.className=Object(s.a)(t.className,"button-control"),t["aria-pressed"]=this.props.ToggleActive,this.props.ToggleActive&&(t.className=Object(s.a)(t.className,"active")),this.props.ButtonStyle){case"LightBackground":t.className=Object(s.a)(t.className,"light-background-button");break;case"DarkBackGround":t.className=Object(s.a)(t.className,"dark-background-button")}return i.createElement("button",Object(r.a)({},t),i.createElement("div",{className:"button-content"},this.props.children))},n.focus=function(){o.findDOMNode(this).focus()},n.setTabIndex=function(t){o.findDOMNode(this).setAttribute("tabIndex",t.toString())},e}(n(16).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return l}));var r=n(2),i=n(3),o=n(4),c=n(6),s=n(7),u=n(39),a=n(18),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(e,"MinimumOptionsForDropDown",{get:function(){return 7},enumerable:!0,configurable:!0}),e.getElementTypeName=function(){return"Question.Choice"},e.createDefaultDefinition=function(){var t=[{Description:Object(c.a)().Designer_Choices_DefaultDescription.format(1),IsGenerated:!0},{Description:Object(c.a)().Designer_Choices_DefaultDescription.format(2),IsGenerated:!0}];return{Type:e.getElementTypeName(),Title:Object(c.a)().Question_DefaultTitle,Choices:t,ChoiceType:a.a.SingleChoice,OptionDisplayStyle:a.c.ListAll,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)&&t.OptionDisplayStyle!==a.c.Dropdown},n.verify=function(t){return!this.Model.Required||t&&"[]"!==t?t&&t.length>e.MaxAnswerLength?a.e.MultiChoiceQuestionLengthLimitError:a.e.Success:a.e.RequiredError},n.isEmpty=function(t){return this.Model.ChoiceType===a.a.SingleChoice?!t:!t||"[]"===t},n.getTypeDisplayName=function(){switch(this.Model.ChoiceType){case a.a.SingleChoice:return Object(c.a)().QuestionType_SingleChoice;case a.a.MultiChoice:return Object(c.a)().QuestionType_MultiChoice;default:throw Error("Choice Question Type Not Supported")}},n.supportsQuestionLevelBranching=function(){return this.Model.ChoiceType!==a.a.SingleChoice},n.supportsChoiceLevelBranching=function(){return this.Model.ChoiceType===a.a.SingleChoice},n.getSnapshotWithoutBranchInfo=function(){var e=t.prototype.getSnapshotWithoutBranchInfo.call(this);return e.Choices=o.a.convertToArray(e.Choices).map((function(t){return delete(t=i.clone(t)).BranchInfo,t})),e},n.resetBranchInfo=function(){var e=this;t.prototype.resetBranchInfo.call(this),o.a.convertToArray(this.Model.Choices).filter((function(t){return e.getBranchInfoMaster(t.BranchInfo).resetToDefault()})),this.getBranchInfoMaster(this.Model.BranchInfoForOtherChoice).resetToDefault()},n.insertChoice=function(t,e){var n=this.Model.Choices,r=i.find(n,(function(t){return t.IsGenerated}));if(!r||e&&""!==r.Description){var c=o.a.Collection.addItems(n,[{Description:t,IsMathOption:e}]);r=c[0]}else{var u=o.a.getObjectMasterFromModel(r);Object(s.c)((function(){u.bulkEdit((function(){r.Description=t,r.IsGenerated=null,r.IsMathOption=e}))}),s.e)}return r},n.hasCorrectAnswers=function(t){return t?i.some(t.IsAnswerKeys):i.some(this.Model.Choices,(function(t){return t.IsAnswerKey}))},n.isCorrectAnswer=function(t){var e=l(t,this.Model),n=o.a.convertToArray(this.Model.Choices).filter((function(t){return t.IsAnswerKey})).map((function(t){return t.Description})).sort();return i.isEqual(n,e.SelectedOptions.sort())},n.justifyQuestionInfo=function(){var t=this.Master.Model;if(null==t.OptionDisplayStyle){var n=t.ChoiceType===a.a.SingleChoice&&!t.IsMathQuiz&&!t.AllowOtherAnswer&&t.Choices.length>=e.MinimumOptionsForDropDown;t.OptionDisplayStyle=n?a.c.Dropdown:a.c.ListAll}},n.showAsDropdown=function(){return this.Master.Model.OptionDisplayStyle===a.c.Dropdown},n.setAnswerKey=function(t,e){var n=this;this.Master.bulkEdit((function(){t.IsAnswerKey=e,n.Model.ChoiceType===a.a.SingleChoice&&t.IsAnswerKey&&o.a.convertToArray(n.Model.Choices).forEach((function(e){e.IsAnswerKey&&e!==t&&(e.IsAnswerKey=!1)}))}))},n.createQuizResult=function(t){if(this.Model.IsQuiz){var e=o.a.convertToArray(this.Model.Choices);return e.some((function(t){return t.IsAnswerKey}))?{IsAnswerCorrect:this.isCorrectAnswer(t),AnswerHints:e.map((function(t){return t.AnswerHint})),IsAnswerKeys:e.map((function(t){return t.IsAnswerKey})),Choices:e.map((function(t){return t.Description})),GradingBasis:this.Model.GradingBasis}:void 0}},n.autoGradeAnswer=function(e){if(i.some(this.Model.Choices,(function(t){return t.IsAnswerKey}))){var n=this.Model.Point?this.Model.Point:0;e.Score=this.isCorrectAnswer(e.Answer)?n:0,e.IsAutoGraded=!0}else t.prototype.autoGradeAnswer.call(this,e)},n.autoGradeWithQuizResult=function(t,e){return e?e.IsAnswerCorrect?this.Model.Point:0:null},n.getBranchingResult=function(e){var n=this;if(this.Model.ChoiceType!==a.a.SingleChoice)return t.prototype.getBranchingResult.call(this,e);var r=o.a.convertToArray(this.Model.Choices),c=r.filter((function(t){return t.BranchInfo&&o.a.getObjectMasterFromModel(t.BranchInfo).isValid()})),s=o.a.getObjectMasterFromModel(this.Model.BranchInfoForOtherChoice);if(0===c.length&&!s.isValid())return t.prototype.getBranchingResult.call(this,e);var u,f=r.filter((function(t){return n.Zn(e,t)})),l=i.intersection(f,c);l.length>0||f.length>0?u=(l[0]||f[0]).BranchInfo:this.isEmpty(e)||(u=this.Model.BranchInfoForOtherChoice);return u?this.getBranchInfoMaster(u).getBranchingResult():{Type:"Pending"}},n.Zn=function(t,e){return e.Description===t},e.MaxAnswerLength=4e3,e}(u.a);function l(t,e){var n=e.ChoiceType===a.a.SingleChoice;if(null!=t){var r=o.a.convertToArray(e.Choices).map((function(t){return t.Description}));if(!n||!e.AllowOtherAnswer&&!i.contains(r,t))try{var c=JSON.parse(t);if(Array.isArray(c)){if(!c.some((function(t){return!i.isString(t)})))return{IsSingleChoiceAnswer:!1,IsLegacyChoiceAnswer:!1,SelectedOptions:c}}else if(i.isObject(c)){var s=i.values(c);if(!s.some((function(t){return!i.isString(t)})))return{IsSingleChoiceAnswer:n&&s.length<=1,IsLegacyChoiceAnswer:!0,SelectedOptions:s}}}catch(t){}}return{IsSingleChoiceAnswer:n,IsLegacyChoiceAnswer:!1,SelectedOptions:null==t?[]:[t]}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(2),i=n(0),o=n(75),c=n(5),s=n(6),u=n(10),a=n(74),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.He=!0,e.er=new Image,e}Object(r.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.props.ThemeMaster;e&&(this.nr=function(e){e.NewValues.Name===Object(s.a)().Customized_Theme_Name&&e.NewValues.BackgroundImage!==t.state.ImageUrl?t.setState({ImageUrl:e.NewValues.BackgroundImage,IsBackgroundImgCached:!1}):t.forceUpdate()},e.observe(this.nr))},n.componentWillUnmount=function(){var t=this.props.ThemeMaster;this.He=!1,t&&t.unobserve(this.nr)},n.render=function(){var t,n=this,r=this.props.ThemeMaster;if(!(t=Object(u.n)()&&Object(c.a)().themeInfo?e.getSPOTheme(Object(c.a)().themeInfo):r&&r.Model))return null;var o=t.Name,a=t.PrimaryColor,f=t.SecondaryColor,l=t.BackgroundColor,h=t.BackgroundImage;h&&h.match("url((.*))")&&(h=h.substring(4,h.length-1)),o===Object(s.a)().Customized_Theme_Name&&h&&(this.state.IsBackgroundImgCached||(this.er.src=h,this.er.onload=function(t){n.He&&n.setState({ImageUrl:h,IsBackgroundImgCached:!0})},h+="_mo"));var d="";return d+=".office-form-theme-primary-color { color:"+a+"; }",d+=".office-form-theme-secondary-color { color:"+f+"; }",d+=".office-form-theme-primary-background { background:"+a+"; color:#FFFFFF; }",d+=".office-form-theme-secondary-background { background:"+f+"; }",d+=".office-form-theme-primary-foreground, ",d+=".office-form-theme-primary-foreground a, ",d+=".office-form-theme-primary-foreground.rateit .rateit-selected, ",d+=".office-form-theme-primary-foreground.rateit .rateit-hover",d+="{ color:"+a+"; } ",d+=".office-form-theme-border-top { border-top-color:"+a+"; }",d+=".office-form-theme-border-bottom-for-mobile { border-bottom-color:"+a+"; }",d+=".office-form-theme-border { border-color:"+a+";}",d+=".office-form-theme-interactive-background.active { background-color:"+a+"; }",d+=".office-form-theme-interactive-background:hover { background-color:"+f+"; }",d+=".office-form-theme-interactive-background:focus { background-color:"+f+"; }",d+=".office-form-theme-interactive-background:active { background-color:"+f+"; }",d+=".office-form-theme-button-lightbackground { color:"+a+"; }",d+=".office-form-theme-button-lightbackground.active { background-color:"+f+"; }",d+=".office-form-theme-interactive-color { color:"+a+"; }",d+=".office-form-theme-interactive-color:hover { color:"+f+"; }",d+=".office-form-theme-interactive-color:focus { color:"+f+"; }",d+=".office-form-theme-interactive-color:active { color:"+f+"; }",d+=".office-form-theme-button { color: white; background:"+a+"; }",d+=".office-form-theme-button:hover { background:"+f+"; }",d+=".office-form-theme-button:focus { background:"+f+"; }",d+=".office-form-dark-theme-button {color:"+f+"}",d+=".office-form-dark-theme-button:hover { color:"+f+"; }",d+=".office-form-dark-theme-button:focus { color:"+f+"; }",d+=".office-form-theme-page-background-active.active { background :"+a+"; color: #FFFFFF; }",d+=".office-form-theme-page-foreground-active.active, ",d+=".office-form-theme-select-color.active *{ color: "+a+"; }",d+=".office-form-theme-toggle.active { background: "+a+"; border-color:"+a+"; }",d+=".office-form-theme-border { border-color:"+a+"; }",d+=".office-form-theme-outline { outline-color:"+a+"; }",d+=".office-form-theme-button-foreground.active,.office-form-theme-button-foreground.touch.active:hover { color: white; background: "+a+"; outline-color:"+a+"; }",d+=".office-form-theme-button-foreground.active:hover { background: "+f+"; outline-color:"+f+"; }",d+=".office-form-theme-quiz-point { color:"+f+"; }",d+=".office-form-theme-quiz-totalPoints-bar {color:"+a+"; }",d+=".office-form-theme-image-question-background, .office-form-theme-video-question-background { background-color: "+l+"; outline: 1px solid transparent; }",d+=".office-form-theme-image-container-border { border: 3px solid "+l+"; }",d+=".office-form-sortable-chosen .office-form-sort-item { background: "+a+"; color:white; }",d+=".office-form-theme-sort-item { color: white; background:"+a+"; }",d+=".office-form-theme-sort-item:hover { background:"+f+"; }",d+=".office-form-theme-focus-border .office-form-textfield-input:focus,.office-form-theme-focus-border .form-control:focus,.office-form-theme-focus-border .select-control:focus,.office-form-theme-focus-border .picker--focused .picker__holder:focus{ border-color: "+a+"; outline-color:"+a+"; }",d+=".office-form-theme-bgcolor-hover:hover { background:"+l+"; }",d+=".office-form-theme-button-color:hover *{ color:"+f+"; }",d+=".form-intelligence-question-row.office-form-intelligence-theme-li { outline: 1px solid "+f+"; background-color:"+l+";}",d+=".form-intelligence-question-row.mobile-office-form-intelligence-theme-li { outline: 1px solid "+a+"; background-color:"+l+"; color:"+a+";}",d+=".office-form-insight-theme-control .simple-data-control-content { color : "+a+"; }",d+=".office-form-insight-theme-control .simple-data-control-description { color : "+a+"; }",d+=".office-form-insight-theme-control .simple-data-control-description:hover { color : "+f+"; }",d+=".office-form-insight-theme-control .simple-data-control-description:focus { color : "+f+"; }",d+=".office-form-insight-theme-control .simple-data-control-description:active { color : "+f+"; }",d+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link { color: "+a+"; }",d+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link:hover{color:"+f+"; }",d+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link { color: "+a+"; }",d+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link:hover { color: "+f+"; }",d+=".office-form-theme-spo-link { color:"+a+"; }",d+=".office-form-theme-spo-link:hover { color:"+f+"; }",Object(u.n)()||(h?(d+=".thank-you-page-content { opacity:.97; }",d+=".introduction-for-responser-container { opacity:.97; }",Object(u.k)()?(d+=".office-form-theme-page-background { background-color:"+l+"; }",d+=".office-form-theme-footer { background: rgba(255,255,255,.4); }"):(d+=".office-form-theme-page-background { background-image: url("+h+"); }",d+=".office-form-theme-footer { background: rgba(244,244,244,.8); }"),d+=".preview-mobile-container.office-form-theme-page-background { background:"+l+"; }",d+=".preview-mobile-container .office-form-theme-footer { background: rgba(255,255,255,.4); }"):(d+=".office-form-theme-footer { background : rgba(255,255,255,.4); }",d+=".office-form-theme-page-background { background-color:"+l+"; }")),h&&o!==Object(s.a)().Customized_Theme_Name?d+=".office-form-theme-shadow { box-shadow : none; }":d+=".office-form-theme-shadow { box-shadow: 0 0 11px rgba(0,0,0,.12); }",o===Object(s.a)().Customized_Theme_Name&&(d+=".office-form-body { opacity: 0.97; }"),i.createElement("style",null,d)},e.getSPOTheme=function(t){var e=Object(o.d)(t);return{BackgroundColor:Object(o.e)(e),BackgroundImage:null,Name:a.a,PrimaryColor:e,SecondaryColor:Object(o.f)(e),Thumbnail:null}},e}(n(16).a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return m}));var r=n(2),i=n(0),o=n(26),c=n(11),s=n(9),u=n(21),a=n(60),f=n(32),l=n(22);function h(t){var e;return e=Object(s.b)("FromsSpinnerControl")?"common-spinner-circle":"spinner-tile-animation",i.createElement("div",{className:"image-spinner",id:t&&d(t)},i.createElement("div",{className:e}))}function d(t){return"imageSpinner-"+t.ResourceId}var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.He=!0,e.rr=function(){return e.forceUpdate()},e.ir=function(){return e.or()},e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=Object(u.f)().Schema,e=Object(u.g)().Schema;this.props.ImageSettings.observe(this.rr),this.props.Image.observe(this.rr,[t.ResourceUrl,t.ContentType,t.OriginalFileName]),this.props.ImageSettings.observe(this.ir,[e.ContainerHeight,e.ContainerWidth,e.Left,e.Top]),this.props.Image.observe(this.ir,[t.AltText]),this.cr()},n.componentDidUpdate=function(){this.cr()},n.componentWillUnmount=function(){this.He=!1,this.props.ImageSettings.unobserve(this.rr),this.props.Image.unobserve(this.rr),this.props.ImageSettings.unobserve(this.ir),this.props.Image.unobserve(this.ir)},n.render=function(){var t=this,e=this.props.Image.Model,n=this.props.ImageSettings.validateImageSettings(!0),r=0;return i.createElement("img",{src:e.ResourceUrl,title:e.AltText,alt:e.AltText,height:n.ContainerHeight+"px",width:n.ContainerWidth+"px",style:{visibility:"hidden"},onLoad:function(){l.a.logData({name:"Image.ImageOnLoad.Success",extraData:{imageType:t.props.ImageType,location:"1"}})},onError:function(n){if(r<3&&"Response"===Object(c.n)()){var i=o.findDOMNode(t);r++;var s=e.ResourceUrl+"?"+r;window.setTimeout((function(){$(i).attr("src",s)}),1e3)}else l.a.logData({name:"Image.ImageOnLoad.Failure",extraData:{imageSrc:e.ResourceUrl,imageType:t.props.ImageType,location:"1"}})}})},n.cr=function(){var t=this,e=this.props.Image&&this.props.Image.Model;if(e&&e.ResourceUrl&&!this.sr()){var n=o.findDOMNode(this),r=0;n&&this.props.ImageSettings&&(n.onload=function(){return t.or()},n.onerror=function(i){if(r<3&&"Response"===Object(c.n)()){r++;var o=e.ResourceUrl+"?"+r;window.setTimeout((function(){$(n).attr("src",o)}),1e3)}else{l.a.logData({name:"Image.CanvasOnLoad.Failure",extraData:{imageSrc:n.src,imageType:t.props.ImageType,location:"1"}});var s=document.getElementById(d(e));s&&$(s).css("display","none"),$(n).css("visibility","visible")}})}},n.or=function(){if(this.He){var t=this.props.Image&&this.props.Image.Model;if(t&&t.ResourceUrl&&!this.sr()){var e=o.findDOMNode(this);if($(e).siblings("canvas").remove(),e&&this.props.ImageSettings)try{var n=document.createElement("canvas"),r=this.props.ImageSettings.validateImageSettings(!0);null!=t.AltText&&(n.title=t.AltText),n.tabIndex=-1;var i=1*r.NaturalWidth/r.ActualWidth,c=Math.abs(r.Left*i);c=Math.floor(Math.min(c,r.NaturalWidth));var s=Math.abs(r.Top*i);s=Math.floor(Math.min(s,r.NaturalHeight));var u=r.ContainerWidth*i||r.NaturalWidth;u=Math.floor(Math.min(u,r.NaturalWidth));var f=r.ContainerHeight*i||r.NaturalHeight;f=Math.floor(Math.min(f,r.NaturalHeight));try{var h=isNaN(window.devicePixelRatio)?1:window.devicePixelRatio;h=Math.ceil(Math.max(h,i)),n.width=Math.floor(r.ContainerWidth*h),n.height=Math.floor(r.ContainerHeight*h),n.getContext("2d").drawImage(e,c,s,u,f,0,0,n.width,n.height)}catch(t){$(e).css("visibility","visible");var m=t.message||void 0,b=t.stack||void 0;return void l.a.logData({name:"Image.CanvasRender.Failure",extraData:{imageSrc:e.src,imageType:this.props.ImageType,location:"1",error:m+" "+b,Exception:"DrawImageCanvas"}})}var v=document.getElementById(d(t));v&&$(v).css("display","none"),$(e).css("display","none"),$(e).parent().append(n),l.a.logData({name:"Image.CanvasRender.Success",extraData:{imageType:this.props.ImageType,location:"1"}}),Object(a.d)()}catch(t){m=t.message||void 0,b=t.stack||void 0;throw l.a.logData({name:"Image.CanvasRender.Failure",extraData:{imageSrc:e.src,imageType:this.props.ImageType,location:"1",error:m+" "+b,Exception:"CreateImageCanvas"}}),t}}}},n.sr=function(){var t=this.props.Image.Model,e=this.props.ImageSettings.Model;return t.ResourceId!==e.TargetResourceId||t.ImageProcessingStatus!==f.b.Idle},e}(n(16).a)},function(t,e,n){"use strict";var r,i=n(2),o=n(0),c=n(9),s=n(8),u=n(10),a=n(7),f=(n(81),n(37)),l=n(16),h=n(31),d=(n(29),n(34)),m=n(5);var b=function(t){function e(e){var n=t.call(this,e)||this;return n.He=!1,n.state={PrivacyUrl:"https://go.microsoft.com/fwlink/?LinkId=521839"},n.lr=n.lr.bind(n),n}Object(i.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.He=!0,this.lr()},n.componentWillUnmount=function(){this.He=!1},n.render=function(){var t={className:Object(u.n)()?"office-form-theme-spo-link":void 0,href:this.state.PrivacyUrl,target:"_blank"};return o.createElement("div",{className:this.props.Multiline?"office-form-footer-block":"office-form-footer-inline"},o.createElement("a",Object(i.a)({},t),this.props.LocalizedStrings.Form_Footer_PrivacyStatement))},n.lr=function(){var t=this;(function(){if(!r){r=$.Deferred();var t=Object(d.b)();Object(h.b)().getPrivacySettings(t&&t.OrgId,Object(m.a)().userInfo.TenantId).then((function(t){return r.resolve(t&&t.privacyUrl)}),(function(t){return r.resolve(void 0)}))}return r.promise()})().done((function(e){t.He&&t.setState({PrivacyUrl:e||""})}))},e}(l.a),v=n(127);n.d(e,"a",(function(){return g}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dr=!1,e}Object(i.c)(e,t);var n=e.prototype;return n.render=function(){var t=this,e=this.props.TopExtraContent&&o.createElement("div",{className:"office-form-footer-block"},this.props.TopExtraContent),n=Object(s.a)("office-form-footer-container office-form-padding-align",this.props.HTMLAttributes&&this.props.HTMLAttributes.className);this.dr&&Object(c.b)("FormsProCustomFooter"),this.dr&&Object(c.b)("FormsProCustomFooter");return o.createElement(f.a.Consumer,null,(function(r){var i=r.LocalizedStrings;return o.createElement("div",{className:"office-form-footer office-form-theme-footer",role:"contentinfo"},o.createElement("div",{className:n},e,Object(a.c)((function(){return function(t,e,n){switch(n){case"ShowStatement":return o.createElement("div",{className:"office-form-footer-block"},t);case"ShowStatementWithNotice":return o.createElement("div",{className:"office-form-footer-block"},e);default:return null}}(i.Response_Page_Footer_Statement_2,i.Response_Page_Footer_Statement,t.props.FooterType)||!1}),a.e),Object(a.c)((function(){return t.br(i)}),a.e),function(){if(Object(c.c)())return o.createElement("div",{id:"form-bottom-sentinel",className:"office-form-bottom-sentinel"})}()))}))},n.br=function(t){var e,n,r,c;return o.createElement("div",{className:"office-form-footer-block"},(e=t.Form_Footer_Powered,Object(u.n)()?(r=e,c={className:Object(u.n)()?"office-form-theme-spo-link":void 0,href:window.location.origin,target:"_blank"},o.createElement("div",{className:"office-form-footer-inline-without-margin"},o.createElement("a",Object(i.a)({},c),r))):(n=e,o.createElement("div",{className:"office-form-footer-inline-without-margin"},n)))," | ",o.createElement(b,{LocalizedStrings:t})," | ",o.createElement(v.a,{FormMaster:this.props.FormMaster,LocalizedStrings:t,ForceUseCommercialTermsLink:this.props.ForceUseCommercialTermsLink}))},n.vr=function(t){},e}(l.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(5),i=decodeURI(Object(r.a)().webSettings||"{}"),o=JSON.parse(i);function c(t){var e=o[t];return e||(e=""),e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(t){this.prefetchDeferred=$.Deferred(),this.cache=t}var e=t.prototype;return e.init=function(){if(this.cache)switch(this.cache.state){case 3:this.onPrefetchSucceed();break;case 4:this.onPrefetchFaied();break;case 2:this.cache.successCallback=this.onPrefetchSucceed.bind(this),this.cache.errorCallback=this.onPrefetchFaied.bind(this);break;default:this.fallBackToNormalBoot()}else this.fallBackToNormalBoot()},e.getPromise=function(){return this.prefetchDeferred.promise()},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(2),i=n(0),o=n(38),c=i.lazy((function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,149))];case 1:return[2,{default:t.sent().ErrorPage}]}}))}))}));function s(t){return i.createElement(o.a,null,i.createElement(c,Object(r.a)({},t)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(20);function i(){return r.a.Resolve("IThirdPartyRateIt")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),i=n(0),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){return i.createElement("span",{className:"required-star"})},e}(n(16).a)},function(t,e,n){"use strict";var r=n(23),i=(n(122),n(3),n(4),n(29),n(5),n(48),n(21),n(89)),o=(n(14),n(12),n(55),{});new i.a.CallbackManager;var c=function(){function t(t,e){this.gr=[],this.pr=t,e=e||{},this.Or=e.deferredTimeInMs||100,this.jr=e.maxCount||10}var e=t.prototype;return e.insert=function(t){var e=this,n=$.Deferred();return this.gr.push({Arguments:t,Deferred:n}),this.gr.length>=this.jr?this.wr():void 0===this.Sr&&(this.Sr=window.setTimeout((function(){return e.wr()}),this.Or)),n.promise()},e.wr=function(){var t=this.gr;this.gr=[],void 0!==this.Sr&&(window.clearTimeout(this.Sr),this.Sr=void 0),0!==t.length&&this.pr(t.map((function(t){return t.Arguments}))).done((function(e){if(t.length!==e.length)throw Error("All the elements needs to be listed in result array.");e.forEach((function(e,n){e.Succeeded?t[n].Deferred.resolve(e.Value):t[n].Deferred.reject(e.Error)}))})).fail((function(e){t.forEach((function(t){t.Deferred.reject(e)}))}))},t}();n.d(e,"a",(function(){return u}));var s={};function u(t,e){return s.hasOwnProperty(e)||(s[e]=new c((function(t){return function(t,e){var n=t.length,i=(c=e,o[c]);var c;if(i)return Object(r.b)(i).copyLocaleResources(e,t).then((function(){for(var t=[],e=0;e<n;++e)t.push({Succeeded:!0,Value:void 0});return t}),(function(t){for(var e=[],r=0;r<n;++r)e.push({Error:t,Succeeded:!1});return e}));return $.Deferred().resolve().promise()}(t,e)}))),s[e].insert(t)}},function(t,e,n){"use strict";var r,i=n(2),o=n(4),c=n(1),s=n(6),u=n(23);!function(t){t[t.NotStarted=1]="NotStarted",t[t.Opened=2]="Opened",t[t.Expired=3]="Expired",t[t.Closed=4]="Closed"}(r||(r={})),n.d(e,"a",(function(){return f}));var a={LockGivenQuestionsEndDisplayOrder:c.a.number(),LockGivenQuestionsStartDisplayOrder:c.a.number(),FormClosed:c.a.boolean(),FormClosedMessage:c.a.string(),FormClosedMessageChanged:c.a.boolean(),TimerEnabled:c.a.boolean(),TimerEnabledStart:c.a.boolean(),TimerEnabledEnd:c.a.boolean(),StartTime:c.a.string(),EndTime:c.a.string(),RequiresUniqueResponse:c.a.boolean(),IsAnonymous:c.a.boolean(),NotRecordIdentity:c.a.boolean(),ShuffleAllQuestions:c.a.boolean(),ShuffleQuestionOrder:c.a.boolean(),ShowGradedResults:c.a.boolean(),ShowGradedScores:c.a.boolean(),RespondInAppOnly:c.a.boolean(),AllowCopy:c.a.boolean(),ShareToken:c.a.string(),ManualGradingEnabled:c.a.boolean(),IsQuizMode:c.a.boolean(),EmailNotification:c.a.boolean(),AllowResponderGetAllResponses:c.a.boolean(),ShowQuestionNumbers:c.a.boolean(),IsEmailableEntityCreationEnabled:c.a.boolean(),EmailableEntity:c.a.string()},f=function(t){function e(n){var r=t.call(this,n)||this;return r.addRule({Name:"updateClosedMessage",InterestedFields:[r.Schema.FormClosed],onChange:e.updateClosedMessage}),r.addRule({Name:"updateAllowCopy",InterestedFields:[r.Schema.ShareToken],onChange:e.updateAllowCopy}),r}Object(i.c)(e,t);var n=e.prototype;return e.serialize=function(t){var e=o.a.convertToSourceData(t,this.Schema),n=0;return Object.keys(e).forEach((function(t){null==e[t]?delete e[t]:++n})),n>0?JSON.stringify(e):null},n.getFormStatus=function(){var t=this.Model;if(t.FormClosed)return r.Closed;if(t.TimerEnabled){var e=Date.now();if(null!=t.StartTime&&Date.parse(t.StartTime)>e)return r.NotStarted;if(null!=t.EndTime&&Date.parse(t.EndTime)<e)return r.Expired}return r.Opened},n.getFormClosedMessage=function(){var t=this.Model;switch(this.getFormStatus()){case r.Closed:return t.FormClosedMessage;case r.NotStarted:return Object(s.a)().FormSetting_NotStartForm_DefaultMessage.format(new Date(t.StartTime).toLocaleString());case r.Expired:return Object(s.a)().FormSetting_ExpiredForm_DefaultMessage;default:return}},n.setSharingStatus=function(t,e){var n=this,r=this.Parent,i=Object(u.b)(r);return r.existingOnServerSide().then((function(){return i.changeSharingStatus(r.Model.Id,e)})).then((function(t){n.Model.ShareToken=t}))},e.updateClosedMessage=function(t){if(-1===t.FieldSchemas.indexOf(e.Schema.FormClosedMessage)){var n=t.Master.Model;n.FormClosed?null!=n.FormClosedMessage&&Object(s.c)().done((function(t){return n.FormClosedMessage=t.FormSetting_ClosedForm_DefaultMessage})):n.FormClosedMessage=null}},e.updateAllowCopy=function(t){var e=t.Master.Model;e.AllowCopy=!!e.ShareToken},e}(o.a.createObjectMasterClass("FormSettingsMaster",a))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(29),i=n(45),o=n(15);function c(){var t;if(t=Object(r.b)())return t;var e="origin",n=Object(o.c)()[e];return n||(e="oembedsso",Object(o.c)()[e]?"Forms WebPart":Object(i.d)()?"PowerPoint":null)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(29);function i(t,e,n,i){if(Object(r.l)()){var o=$("<a></a>");return o.attr("href",t),e||(e="_blank"),o.attr("target",e),o[0].click(),o.remove(),null}return e||n||i?n||i?i?window.open(t,e,n,i):window.open(t,e,n):window.open(t,e):window.open(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return l}));var r=n(2),i=n(0),o=n(38),c=i.lazy((function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(4).then(n.bind(null,142))];case 1:return[2,{default:t.sent().PhishingReviewPageNavBar}]}}))}))})),s=i.lazy((function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(4).then(n.bind(null,143))];case 1:return[2,{default:t.sent().WarningBar}]}}))}))})),u=i.lazy((function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(4).then(n.bind(null,144))];case 1:return[2,{default:t.sent().PhishingWarningPage}]}}))}))}));i.lazy((function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(4).then(n.bind(null,145))];case 1:return[2,{default:t.sent().PhishingPopUpMessage}]}}))}))}));function a(t){return i.createElement(o.a,null,i.createElement(c,Object(r.a)({},t)))}function f(t){return i.createElement(o.a,null,i.createElement(s,Object(r.a)({},t)))}function l(t){return i.createElement(o.a,null,i.createElement(u,Object(r.a)({},t)))}},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return s}));n(9),n(53);var r={af:"Afrikaans","am-et":"አማርኛ (ኢትዮጵያ)‎",ar:"العربية","as-in":"অসমীয়া (ভাৰত)‎","az-latn-az":"azərbaycan (Azərbaycan)‎",be:"Беларуская",bg:"български","bn-bd":"বাংলা (বাংলাদেশ)‎","bn-in":"বাংলা (ভারত)‎","bs-latn-ba":"bosanski (Bosna i Hercegovina)‎",ca:"català","ca-es-valencia":"valencià (Espanya)‎",cs:"čeština","cy-gb":"Cymraeg (Y Deyrnas Unedig)‎",da:"dansk",de:"Deutsch",el:"Ελληνικά","en-gb":"English (United Kingdom)‎","en-us":"English (United States)‎",es:"español","es-mx":"español (México)‎",et:"eesti",eu:"euskara",fa:"فارسی",fi:"suomi","fil-ph":"Filipino (Pilipinas)‎",fr:"français","fr-ca":"français (Canada)‎","ga-ie":"Gaeilge (Éire)‎",gd:"Gàidhlig",gl:"galego",gu:"ગુજરાતી","ha-latn-ng":"Hausa (Najeriya)‎",he:"עברית",hi:"हिन्दी",hr:"hrvatski",hu:"magyar",hy:"Հայերեն",id:"Indonesia",is:"íslenska",it:"italiano",ja:"日本語",ka:"ქართული",kk:"қазақ тілі","km-kh":"ភាសាខ្មែរ (កម្ពុជា)‎",kn:"ಕನ್ನಡ",ko:"한국어",kok:"कोंकणी",ky:"Кыргыз","lb-lu":"Lëtzebuergesch (Lëtzebuerg)‎",lo:"ລາວ",lt:"lietuvių",lv:"latviešu","mi-nz":"te reo Māori (Aotearoa)‎",mk:"македонски",ml:"മലയാളം",mn:"монгол",mr:"मराठी",ms:"Melayu","mt-mt":"Malti (Malta)‎","nb-no":"norsk bokmål (Norge)‎","ne-np":"नेपाली (नेपाल)‎",nl:"Nederlands","nn-no":"nynorsk (Noreg)‎","or-in":"ଓଡ଼ିଆ (ଭାରତ)‎",pa:"ਪੰਜਾਬੀ",pl:"polski","prs-af":"درى (افغانستان)‏","pt-br":"português (Brasil)‎","pt-pt":"português (Portugal)‎","quz-pe":"Runasimi (Perú)‎",ro:"română",ru:"русский","sd-arab-pk":"سنڌي (پاکستان)‏","si-lk":"සිංහල (ශ්‍රී ලංකාව)‎",sk:"slovenčina",sl:"slovenščina",sq:"shqip","sr-cyrl-ba":"српски (Босна и Херцеговина)‎","sr-cyrl-rs":"српски (Србија)‎","sr-latn-rs":"srpski (Srbija)‎",sv:"svenska",sw:"Kiswahili",ta:"தமிழ்",te:"తెలుగు",th:"ไทย","tk-tm":"Türkmen dili (Türkmenistan)‎",tr:"Türkçe",tt:"Татар",ug:"ئۇيغۇرچە",uk:"українська",ur:"اُردو","uz-latn-uz":"o‘zbek (Oʻzbekiston)‎",vi:"Tiếng Việt","zh-cn":"中文（中国）‎","zh-hk":"中文（香港特別行政區）‎","zh-tw":"中文（台灣）‎"},i=["ar","fa","he","prs-af","sd-arab-pk","ug","ur"];function o(t){return-1!==i.indexOf(t.toLowerCase())}function c(){return r}function s(t){return"zh-hk"===t?"zh-tw":t}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));n(3),n(140);function r(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t&&document.activeElement&&t.contains(document.activeElement)){var r=$(":focusable");e&&e.forEach((function(t){r=r.not((function(e,n){return t.contains(n)}))}));var i=r.index(document.activeElement);if(!(i<0)){for(var c=i+1;c<r.length;++c){var s=r[c];if(!t.contains(s)&&!o(s))return void r[c].focus()}for(c=i-1;c>=0;--c){s=r[c];if(!t.contains(s)&&!o(s))return void r[c].focus()}}}}function i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=$(t).find(":focusable");e&&e.forEach((function(t){r=r.not((function(e,n){return t.contains(n)}))})),r.length>0&&r[0].focus()}function o(t){var e=Number(t.getAttribute("tabindex"));return!isNaN(e)&&e<0}},function(t,e,n){"use strict";var r,i=n(2),o=n(0),c=n(26),s=n(3),u=n(4);!function(t){t[t.DesignPage=0]="DesignPage",t[t.DesignPageRtl=1]="DesignPageRtl",t[t.ResponsePage=2]="ResponsePage",t[t.ResponsePageRtl=3]="ResponsePageRtl",t[t.MobileDesignPage=4]="MobileDesignPage",t[t.MobileDesignPageRtl=5]="MobileDesignPageRtl"}(r||(r={}));var a,f=n(22),l=n(5),h=n(50);function d(t){return function(t){var e=$.Deferred();void 0===a&&(a={DesignPage:Object(h.b)(Object(l.a)().scriptName+".min.css",!0),DesignPageRtl:Object(h.b)(Object(l.a)().scriptName+".rtl.min.css",!0),ResponsePage:Object(h.b)(Object(l.a)().responsePageCssName+"min.css",!0),ResponsePageRtl:Object(h.b)(Object(l.a)().responsePageCssName+"rtl.min.css",!0),MobileDesignPage:Object(h.b)(Object(l.a)().scriptName+".min.css",!0),MobileDesignPageRtl:Object(h.b)(Object(l.a)().scriptName+".rtl.min.css",!0)});var n=a[r[t]];if(!n)throw Error("No path for "+r[t]);var i=document.getElementsByTagName("head")[0];if(!i)return e.reject(Error("No head element found!")).promise();var o=document.createElement("link");o.rel="stylesheet",o.href=n;var c=document.getElementById("form-page-css"),s=$(c).attr("href");if(s&&n.toLowerCase()===s.toLowerCase())return e.resolve().promise();return i.removeChild(c),o.id="form-page-css",o.onload=function(){return e.resolve()},o.onerror=function(){i.removeChild(o),e.reject(Error("Failed to load css file: "+n)),f.a.logData({name:"Error.CssLoadingError.FailedToLoadCss",extraData:{name:r[t],url:n}})},i.appendChild(o),e.promise()}(t)}var m=n(11),b=n(9),v=n(34),g=n(80),p=n(77),O=n(6),j=n(45),w=n(8),S=n(60),I=n(10),F=n(53),y=n(126),N=n(97),k=n(104),T=n(98),C=n(38),P=o.lazy((function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,158))];case 1:return[2,{default:t.sent().ReportPage}]}}))}))}));var x=o.lazy((function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,156))];case 1:return[2,{default:t.sent().ThankYouPage}]}}))}))}));var M=n(14),L=n(12),D=n(57),R=n(87),E=(n(61),n(25)),A=n(7),_=n(35),U=n(17),B=n(66),q=n(99);var Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.c)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t=this.props,e=t.RadioCheckbox?"radio":"checkbox",n=t.Options,r=n&&n.classNameForInnerDiv,i=Object(w.a)(e,n&&n.classNameForInnerLabel),c=t.Disabled,s=t.HelpText||void 0,u=Object(w.f)(n&&n.HTMLPropsForInnerElement,{checked:t.Value,disabled:c,type:e,onChange:this.Ye.bind(this),className:this.props.ClassName,ref:this.props.CheckboxRef,autoFocus:t.CheckboxAutoFocus}),a=o.createElement("div",{className:i},o.createElement("label",{disabled:c},o.createElement("input",u),o.createElement("span",{className:this.props.SpanClassName},t.Description),t.ShowRequiredStar?o.createElement(q.a):void 0));return[o.createElement("div",{className:r,id:t.Id,disabled:c,title:s},a,t.children)]},n.Ye=function(t){this.props.onValueChange(t.nativeEvent.target.checked)},e}(B.a),z=n(24),H=n(121);var V=n(65),G=n(105),W=n(16),J=function(t){function e(e){var n=t.call(this,e)||this;return n.state={LabelDetailLoaded:!1,LabelsLoaded:!1},n.Ir=function(){return n.forceUpdate()},n.props.FormMaster.observe(n.Ir,[n.props.FormMaster.Schema.DataClassificationLabel]),n}Object(i.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.props.DesignTimeView&&Object(F.b)().done((function(e){t.Fr=Object(I.u)(e),t.setState({LabelsLoaded:!0})})),!this.props.DesignTimeView&&this.props.FormMaster.isFieldReady(L.a.Schema.DataClassificationLabel)&&Object(F.a)(this.props.FormMaster.Model.OwnerTenantId,this.props.FormMaster.Model.DataClassificationLabel).done((function(e){t.yr=e,t.setState({LabelDetailLoaded:!0})}))},n.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.Ir,[this.props.FormMaster.Schema.DataClassificationLabel])},n.render=function(){if(!this.props.FormMaster.isFieldReady(L.a.Schema.DataClassificationLabel)||!this.props.FormMaster.Model.DataClassificationLabel||this.props.DesignTimeView&&!this.state.LabelsLoaded||!this.props.DesignTimeView&&(!this.state.LabelDetailLoaded||!this.yr))return null;var t=this.props.FormMaster.Model.DataClassificationLabel;if(this.props.DesignTimeView)for(var e=0,n=this.Fr;e<n.length;e++){var r=n[e];if(r.level===t&&!r.showInFormContent)return null}var i=Object(w.a)(this.props.HTMLAttributes&&this.props.HTMLAttributes.className,"__data-classification-label__");return o.createElement("div",{className:i},t)},e}(W.a),K=n(37);function X(t){return Z(t,6)}function Y(t){var e=Z(t,7);return!e||Object(v.c)()||129!==t&&1!==t&&128!==t||(e=!1),e}function Z(t,e){return!!tt(t,80)||!tt(t,8)&&(128!==t&&tt(t,e))}function tt(t,e){return 0!=(t&e)}function et(t,e){switch(e){case"Design":case"Analyze":case"ShareForm":return function(t){return tt(t,80)?Object(A.c)((function(){return Object(O.a)().Phishing_Form_Warning_Message_100}),A.e):tt(t,4)?Object(A.c)((function(){return Object(O.a)().Phishing_Form_Warning_Message_4}),A.e):tt(t,2)?Object(v.c)()?Object(A.c)((function(){return Object(O.a)().Phishing_Form_Warning_Message_2}),A.e):Object(A.c)((function(){return Object(O.a)().Phishing_Form_Warning_Message_2_AAD}),A.e):tt(t,1)?Object(A.c)((function(){return Object(O.a)().Phishing_Form_Warning_Message_1}),A.e):void 0}(t);case"Response":return function(t){return tt(t,4)?Object(A.c)((function(){return Object(O.a)().Phishing_Form_ResponsePage_Warning_Message_4}),A.e):tt(t,2)?Object(A.c)((function(){return Object(O.a)().Phishing_Form_ResponsePage_Warning_Message_2}),A.e):tt(t,1)?Object(A.c)((function(){return Object(O.a)().Phishing_Form_ResponsePage_Warning_Message_1}),A.e):void 0}(t);default:return}}var nt=n(94),rt=n(28),it=n(111),ot=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._e=o.createRef(),e}return Object(i.c)(e,t),e.prototype.render=function(){var t=o.createElement("div",{className:"introduction-title-container"},o.createElement("div",{className:"introduction-title"},Object(O.a)().Form_Introduction_Title_MSA),o.createElement("a",{className:"office-form-try-link",href:"javascript:void(0)",onClick:ct},Object(O.a)().Form_Introduction_TryText_MSA)),e={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":Object(O.a)().Form_Introduction_CreateButtonText_MSA,className:"introduction-create-form",onClick:st,title:Object(O.a)().Form_Introduction_CreateButtonText_MSA},ref:this._e,Text:Object(O.a)().Form_Introduction_CreateButtonText_MSA},n=o.createElement(V.a,Object(i.a)({},e));return o.createElement("div",{className:"office-form introduction-for-responser-container"},t,o.createElement("div",{className:"introduction-container"},o.createElement("div",{className:"introduction"},o.createElement(it.a,{alt:Object(O.a)().Form_Introduction_MSA_1,className:"introduction-image",key:"introductionImage1",src:"/Images/MSAIntroduction1.png"}),o.createElement("div",{className:"introduction-text"},Object(O.a)().Form_Introduction_MSA_1)),o.createElement("div",{className:"introduction"},o.createElement(it.a,{alt:Object(O.a)().Form_Introduction_MSA_2,className:"introduction-image",key:"introductionImage2",src:"/Images/MSAIntroduction2.png"}),o.createElement("div",{className:"introduction-text"},Object(O.a)().Form_Introduction_MSA_2)),o.createElement("div",{className:"introduction"},o.createElement(it.a,{alt:Object(O.a)().Form_Introduction_MSA_3,className:"introduction-image",key:"introductionImage3",src:"/Images/MSAIntroduction3.png"}),o.createElement("div",{className:"introduction-text"},Object(O.a)().Form_Introduction_MSA_3))),o.createElement("div",{className:"introduction-button"},n))},e}(W.a);function ct(){return Object(U.a)({eventName:"ResponsePage.IntroductionForResponser.TryForms",eventType:"engagement_event"}),Object(rt.c)("/Pages/DesignPage.aspx"),!0}function st(){return Object(U.a)({eventName:"ResponsePage.IntroductionForResponser.Create",eventType:"engagement_event"}),Object(rt.c)("/Pages/DesignPage.aspx"),!0}var ut=n(118),at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),e.prototype.render=function(){var t="form-renderer-section-breaker";return this.props.HasTheme&&(t=Object(w.a)(t,"office-form-theme-page-background")),o.createElement("div",{className:t})},e}(W.a),ft=n(27),lt=n(21),ht=n(112),dt=n(47),mt=n(32),bt=n(40),vt=n(116),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.c)(e,t),e.prototype.render=function(){var t;return t=this.props.ShowVideoUrl?o.createElement(vt.a,{InDesignMode:this.props.InDesignMode,IsMobile:this.props.IsMobile,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:this.props.Url}):o.createElement("iframe",{allowFullScreen:!0,className:this.props.ClassNameForIFrame,frameBorder:"0",height:e.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:this.props.Url,width:"100%"}),o.createElement("div",Object(i.a)({},this.props.HTMLAttributes),t,this.props.children)},e.calcVideoDisplayHeight=function(){if(Object(I.k)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),9*t/16}return Object(ft.c)()},e}(W.a),pt=n(114),Ot=n(115),jt=n(120),wt=n(119),St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.Nr(this.props)},n.componentWillReceiveProps=function(t){this.Nr(t)},n.componentDidMount=function(){var t=this;this.rr=function(){return t.forceUpdate()};var e=this.props.Master,n=dt.a.Schema;e.observe(this.rr,[n.Title,n.Subtitle,n.VideoInfo,n.CoAuthors]),e.Form.observe(this.rr,[L.a.Schema.HasQuestionMedia]);var r=Object(lt.g)().Schema;e.ImageSettingsMaster.observe(this.rr,[r.NaturalWidth,r.NaturalHeight,r.ContainerWidth,r.ContainerHeight,r.Size,r.Layout]);var i=Object(lt.f)().Schema;e.ImageInfoMaster.observe(this.rr,[i.ImageProcessingStatus,i.UploadParameters]),this.pe=Object(lt.b)(),this.pe.observe(this.rr,[this.pe.Schema.FormsTenantSettings])},n.componentWillUnmount=function(){var t=this.props.Master;t.unobserve(this.rr),t.ImageInfoMaster.unobserve(this.rr),t.ImageSettingsMaster.unobserve(this.rr),this.pe.unobserve(this.rr)},n.render=function(){var t,e=this.props.Master,n=e.Model,r="Right",i=n.VideoInfo,c=e.ImageInfoMaster,u=e.ImageSettingsMaster,a=c.Model;if(!this.props.HideMedia)if(a.ErrorType||a.ImageProcessingStatus===mt.b.Idle&&!Object(mt.d)(a))e.hasValidVideoUrl()&&(r="Bottom",t=o.createElement(gt,{ClassNameForIFrame:"design-question-title-video-frame",HTMLAttributes:{className:"design-question-image-title-big-horizontal"},key:"video",Url:i.Url,IsMobile:Object(I.k)(),ShowVideoUrl:Object(ht.a)(i.Url,e.Form),LocalizedStrings:this.props.LocalizedStrings}));else{var f=this.kr(u.Model);r=f.ImageLayout,t=o.createElement(wt.a,{FullFilled:"Bottom"===r,ImageWidth:f.Width,ImageHeight:f.Height,ImageInfoMaster:c,ImageSettingMaster:u,ImageType:"Section",key:"image"})}var l=s.extend({},this.props.HTMLAttributes);l.className=Object(w.a)(l.className,"__section-title__ office-form-section-title",this.props.Master.Form.Model.HasQuestionMedia&&"office-form-theme-image-question-background with-image");var h,d;if(this.Tr){var m=this.Tr.Model;Object(A.c)((function(){h=m.title||"",d=m.subtitle||""}),A.e)}return Object(A.c)((function(){h=h||n.Title,d=d||n.Subtitle}),A.e),o.createElement(jt.a,{Heading:2,HTMLAttributes:l,HTMLPropsForInnerElement:{className:"office-form-theme-primary-color"},MediaLayout:r,ImmersiveReaderToggleProps:{ShouldShowImmersiveReaderButtons:this.props.ShouldShowImmersiveReaderButtons,ToggleImmersiveReaderButtons:null},SubTitle:d,Title:h},t,this.Cr())},n.Nr=function(t){var e=t.Master,n=e.Form,r=t.LocaleId;this.Tr=r?D.a.getQuestionResourceMaster(r,e.Model.Id,n):void 0},n.Cr=function(){var t=this,e=this.props.Master.Model.CoAuthors;if(e&&e.length>0&&e[e.length-1].userId!==Object(l.a)().userInfo.UserId)return o.createElement("div",{className:"question-coAuthor-notification-container-design-mode",key:"coAuthor"},s.map(e,(function(e){return t.Pr(e)})))},n.Pr=function(t){if(t.userId!==Object(l.a)().userInfo.UserId){var e=this.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Section_Screen_Reader.format(t.displayName||t.userId,this.props.Ordinal);return o.createElement(pt.a,{ariaLabel:e,displayText:Object(Ot.a)(t.displayName,t.firstName,t.lastName),email:t.email,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId})}},n.kr=function(t){return this.props.IsMobile||Object(I.r)()||t.Layout===bt.a.Horizontal&&t.Size===bt.c.Large?{ImageLayout:"Bottom"}:{Height:t.ContainerHeight||Object(ft.g)(),ImageLayout:"Right",Width:t.ContainerWidth||Object(ft.h)()}},e}(W.a),It=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.c)(e,t);var n=e.prototype;return n.render=function(){return o.createElement("div",{className:"form-renderer-section-container",role:"region","aria-label":this.props.SectionMaster.Model.Title},this.createSectionTitle(),o.createElement("div",{className:"form-renderer-section-content"},this.props.children))},n.createSectionTitle=function(){var t=this,e=this.props.SectionMaster.Model;return e.Title||e.Subtitle||e.ImageInfo.ResourceUrl||e.VideoInfo.Url?o.createElement(K.a.Consumer,null,(function(e){var n=e.LocalizedStrings;return o.createElement("div",{className:"form-renderer-section-title"},o.createElement(St,{IsMobile:t.props.IsMobile,LocaleId:t.props.LocaleId,LocalizedStrings:n,Master:t.props.SectionMaster,ShouldShowImmersiveReaderButtons:t.props.ShouldShowImmersiveReaderButtons}))})):null},e}(W.a),Ft=n(92),yt=n(131),Nt=n(106),kt=n(43);n.d(e,"b",(function(){return Tt})),n.d(e,"a",(function(){return Ct}));FormsPro.MSRewardsDataState;function Tt(t){return o.createElement(Ct,t)}var Ct=function(t){function e(e){var n=t.call(this,e)||this;n.xr=!1,n.Mr=!1,n.Lr=0,n.defaultLanguageId=n.props.Master.Model.DefaultLanguage,n.Dr=function(t){n.setState({ShouldShowImmersiveReaderButtons:t||!n.state.ShouldShowImmersiveReaderButtons})},n.Rr=o.createRef();var r=Object(G.b)();return n.defaultLanguageName=r[n.defaultLanguageId],n.state={IsSmallScreen:$(window).width()<768,SubmitState:0,ShowDuplicateSpinner:!1,ShowErrorPage:!1,ShowPhishingWarningBar:!0,IsStudentViewMode:null!=n.props.Response,IsReportingView:!1,HideQuestions:!1,EmailReceiptConsent:!1,LocalizedResource:n.props.Master.Model.LocaleList.length&&{localeId:n.defaultLanguageId,localeName:n.defaultLanguageName},ShowSpinnerWhenChangeLanguage:!1,ShowSpinnerForFirstTimeLoadMultilingual:!1,LocalizedStrings:Object(O.a)(),ShouldShowImmersiveReaderButtons:!Object(b.b)("ImmersiveReaderMobileToggle")||!n.isMobile(),ShowLongOperationMessage:!1,ShowCompletionRate:!1,CompletionRate:0,WrongQuestionCount:0,SubmitButtonDependencyReady:!Object(b.a)()},n.Er=n.Er.bind(n),n.rr=n.rr.bind(n),n.Ar=n.Ar.bind(n),n._r=n._r.bind(n),n.Ur=n.Ur.bind(n),n.$r=n.$r.bind(n),n.Br=n.Br.bind(n),n.qr=n.qr.bind(n),n.Qr=n.Qr.bind(n),n.zr=n.zr.bind(n),n.Hr=n.Hr.bind(n),n.onLanguageChange=n.onLanguageChange.bind(n),n.Vr=n.Vr.bind(n),n.Gr=n.Gr.bind(n),n.Wr=n.Wr.bind(n),n.Jr=n.Jr.bind(n),n.Kr=e.PhishingReviewUXFactory,e.IncrementalQuestionLoader&&e.IncrementalQuestionLoader.setQuizRenderer(n),Object(b.a)()&&Promise.all([Object(y.a)(),Object(T.a)()]).then((function(){return n.setState({SubmitButtonDependencyReady:!0})})),n}Object(i.c)(e,t);var a=e.prototype;return a.componentWillMount=function(){if(this.formRuntimeMaster=new R.a(this.props.Master,{disableBranching:this.$n()}),this.state.IsStudentViewMode?this.updateWithResponse(this.props.Response):this.Xr(this.props.PersistedAnswers),this.Yr(this.props.PersistedSectionId),Object(b.b)("ProgressBar")){this.Zr()!=this.state.ShowCompletionRate&&this.setState({ShowCompletionRate:!this.state.ShowCompletionRate});var t=this.ti();t!=this.state.CompletionRate&&this.setState({CompletionRate:t})}this.formRuntimeMaster.observeAnswerChange(this.Ar),this.formRuntimeMaster.observe(this._r,[R.a.Schema.RuntimeSectionId]),this.formRuntimeMaster.observe(this.rr,[R.a.Schema.BranchChangeVersion,R.a.Schema.QuestionRuntimeMasters,R.a.Schema.UploadingFileCount]),window.addEventListener("resize",this.Er)},a.componentDidMount=function(){return Object(i.b)(this,void 0,void 0,(function(){var t,e,n,r,o,c,s,a,f=this;return Object(i.d)(this,(function(i){switch(i.label){case 0:return Object(S.d)(),this.props.ForcedLocaleId?((t=this.props.Master.Model.LocalizedResources)&&t[0]&&t[0].localeId==this.props.ForcedLocaleId&&this.setState({LocalizedResource:t[0],ShowSpinnerForFirstTimeLoadMultilingual:!1}),[3,8]):[3,1];case 1:return this.state.IsStudentViewMode?(e=this.props.Response.SubmitLanguage)?(n=JSON.parse(e).localeId,[4,this.ei(n)]):[3,3]:[3,4];case 2:i.sent(),this.ensureLayout(n),i.label=3;case 3:return[3,8];case 4:return(r=this.props.Master.Model.LocaleList).length>0?(o=this.props.Master.SyncContext===M.a.ResponseTimeForm,c=Object(l.a)().cultureInfo.Name.toLowerCase(),(s=u.a.Collection.getItemWithKeyFields(this.props.Master.Model.LocaleList,{localeId:c}))?[4,this.ei(c)]:[3,6]):[3,8];case 5:return i.sent(),this.ensureLayout(c),[3,7];case 6:this.ensureLayout(this.defaultLanguageId),c!==this.defaultLanguageId&&(a=Object(G.a)(this.defaultLanguageId),Object(O.b)(a).done((function(t){f.setState({LocalizedStrings:t})}))),i.label=7;case 7:o&&Object(U.a)({eventName:"ResponsePage.MultiLingual.OpenForm",eventType:"engagement_event",extraData:{browserLocaleId:c,defaultLocaleId:this.defaultLanguageId,firstRenderMatched:!!s,localeCount:r.length}}),i.label=8;case 8:return this.ni(),this.ri(),[2]}}))}))},a.ni=function(){return Object(i.b)(this,void 0,void 0,(function(){var t,e,n,r,o,c;return Object(i.d)(this,(function(i){switch(i.label){case 0:return[4,this.ii()];case 1:return t=i.sent(),[4,this.oi()];case 2:return e=i.sent(),[4,this.ci()];case 3:return n=i.sent(),[4,this.si()];case 4:return r=i.sent(),[4,this.ui()];case 5:return o=i.sent(),[4,this.ai()];case 6:return c=i.sent(),this.setState({DuplicateNavBar:t,DuplicateMessage:e,MultiLingualSpinner:n,MultiLingualSelect:r,MultiLingualSpinnerForEmailReceipt:o,ResultContainer:c}),[2]}}))}))},a.setResultContainer=function(t){return Object(i.b)(this,void 0,void 0,(function(){var e,n;return Object(i.d)(this,(function(r){switch(r.label){case 0:return e=this.setState,n={},[4,this.ai()];case 1:return e.apply(this,[(n.ResultContainer=r.sent(),n),t]),[2]}}))}))},a.componentDidUpdate=function(){Object(S.d)(),Object(p.a)($(".office-form-answerhint")),this.ri()},a.componentWillUnmount=function(){window.removeEventListener("resize",this.Er),this.formRuntimeMaster.observe(this._r),this.formRuntimeMaster.unobserveAnswerChange(this.Ar),this.formRuntimeMaster.unobserve(this.rr),this.formRuntimeMaster.release()},a.render=function(){var t=this;if(this.state.ShowSpinnerForFirstTimeLoadMultilingual)return this.state.MultiLingualSpinnerForEmailReceipt;var e,n=this.props.Master.SyncContext===M.a.SharedTimeForm;if(this.state.ShowErrorPage)return Object(N.a)({Error:this.error,FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var r={className:Object(A.c)((function(){return"office-form-content office-form-page-padding"}),A.e)};if(this.props.HTMLAttributes&&(r.className=Object(w.a)(r.className,this.props.HTMLAttributes.className)),!this.state.IsReportingView&&this.state.ShowPhishingWarningBar&&Y(this.props.Master.Model.OnlineSafetyLevel)&&(r.className=Object(w.a)(r.className,"height-with-tip-bar")),n&&(r.className=Object(w.a)(r.className,"share-page")),(this.props.ViewMode===kt.a.Mobile||this.state.IsSmallScreen)&&(r.className=Object(w.a)(r.className,"small-screen")),this.isMobile()&&(r.className=Object(w.a)(r.className,"mobile-view")),3===this.state.SubmitState||4===this.state.SubmitState&&!this.state.ShowQuizResult){var c,s;this.props.Master.Model.Settings.RequiresUniqueResponse||(c=function(){return t.li()}),4===this.state.SubmitState&&(s=this.qr);var u=this.state.LocalizedResource.localeId;e=o.createElement(K.a.Consumer,{children:function(e){return n={FormMaster:t.props.Master,LocaleId:u!==t.defaultLanguageId&&u,LocalizedStrings:e.LocalizedStrings,ShowPromotionMessage:!Object(j.d)(),submitAnother:c,viewResultsHandler:s,CustomStyle:!1,msRewardsThankYouProps:!1},o.createElement(C.a,null,o.createElement(x,Object(i.a)({},n)));var n}}),Object(E.a)().Flighting.isEnabled_Deprecated("MSAIntroductionForResponder")&&Object(v.c)()&&!this.isMobile()&&(e=o.createElement("div",null,e,o.createElement(ot)))}else e=this.state.IsReportingView?o.createElement(K.a.Consumer,{children:function(e){return n={LocalizedStrings:e.LocalizedStrings,FormMaster:t.props.Master},o.createElement(C.a,null,o.createElement(P,Object(i.a)({},n)));var n}}):o.createElement("div",null,o.createElement("div",{"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.di(),!this.isMobile()&&this.state.MultiLingualSelect,Object(A.c)((function(){return t.Ie()}),A.e),this.state.ResultContainer,o.createElement("div",{className:"office-form-body"},this.mi(),this.bi(),this.gi(),this.pi(),o.createElement("div",{className:"office-form-button-container"},this.Oi(),this.ji(),this.wi()),this.state.DuplicateMessage,o.createElement("div",{className:this.xr?"office-form-error-message-container compact-view":"office-form-error-message-container"},this.Si(),this.Ii()),this.Fi(),this.yi())),this.Ni());var a="form-content-container";return this.props.ViewMode===kt.a.Mobile?a="form-content-container mobile-view":this.state.IsSmallScreen&&(a="form-content-container small-screen"),o.createElement(K.a.Provider,{value:this.state,children:o.createElement("div",{className:a,ref:this.Rr},this.state.DuplicateNavBar,this.ki(),this.Ti(),this.Ci(),o.createElement("div",r,this.props.HeaderMessage&&this.Pi(),o.createElement(Ft.a,{ThemeMaster:this.props.Master.ThemeMaster}),this.isMobile()&&this.state.MultiLingualSelect,e),this.state.MultiLingualSpinner,this.xi())})},a.updateWithResponse=function(t){t&&(this.Xr(t.Answers),this.formRuntimeMaster.updateWithResponse(t),this.setServerQuizResult(t.QuizResult),this.setState({ShowQuizResult:!0,IsStudentViewMode:!0}))},a.Ni=function(){if(!this.props.MobileReadOnly){var t="ShowStatementWithNotice";return this.props.Master.SyncContext===M.a.ResponseTimeForm&&this.props.Master.Model.Settings.IsAnonymous&&(t="ShowStatement"),o.createElement(nt.a,{FormMaster:this.props.Master,FooterType:t,FooterText:!1})}},a.Ti=function(){if(this.Kr)return this.Kr.createPhishingWarningPage(this.props.Master,this.state.IsReportingView)},a.Ci=function(){var t=this,e=this.props.Master.Model.OnlineSafetyLevel,n=this.Mi()?"ShareForm":"Response";if(Y(e)&&!this.state.IsReportingView&&this.state.ShowPhishingWarningBar&&!this.Li())return o.createElement(K.a.Consumer,{children:function(r){return Object(k.c)({Info:et(e,n),TipBarLocation:"Up",TipBarStyle:X(e)?"RedBackground":"YellowBackground",ShouldClose:!X(e),HrefInfo:!Object(b.b)("RemoveRuntimeWarningbarReportAbuse")&&r.LocalizedStrings.Response_Page_Footer_Report,onClickHref:!Object(b.b)("RemoveRuntimeWarningbarReportAbuse")&&t.Vr,onClose:t.Gr})}})},a.Vr=function(){this.setState({IsReportingView:!0})},a.Gr=function(){this.setState({ShowPhishingWarningBar:!1})},a.ei=function(t){return Object(i.b)(this,void 0,void 0,(function(){var e,n,r=this;return Object(i.d)(this,(function(i){switch(i.label){case 0:return t!==this.defaultLanguageId&&this.props.Master.isFieldReady(L.a.Schema.LocalizedResources)?[4,this.ui(!0)]:[3,2];case 1:e=i.sent(),this.setState({MultiLingualSpinnerForEmailReceipt:e,ShowSpinnerForFirstTimeLoadMultilingual:!0}),this.state.IsStudentViewMode?(n=Object(G.a)(t),Object(O.b)(n).done((function(e){r.setState({LocalizedStrings:e}),r.Di(t)}))):this.Di(t),i.label=2;case 2:return[2]}}))}))},a.Di=function(t){var e=this;this.props.Master.getLocaleResouceById(t).done((function(t){var n=e.props.Master.Model.LocalizedResources,r=t.localizedResources;u.a.Collection.getItemWithKeyFields(n,{localeId:r[0].localeId})||u.a.Collection.itemsAddedInSource(n,r),e.setState({LocalizedResource:t&&r[0],ShowSpinnerForFirstTimeLoadMultilingual:!1})}))},a.bi=function(){return this.state.HideQuestions?null:this.props.Master.hasSection()?this.Ri():o.createElement("div",null,this.Ei(this.formRuntimeMaster.TopQuestionRuntimeMasters()))},a.qr=function(){this.setState({ShowQuizResult:!0})},a.yi=function(){if(this.state.ShowQuizResult&&4===this.state.SubmitState)return o.createElement("div",{className:"office-form-quiz-back-to-result-link"},o.createElement("a",{href:"javascript:void(0)",onClick:this.Qr},Object(O.a)().Response_Page_Quiz_Result_Back_To_Thank_You_Message))},a.Qr=function(){this.setState({ShowQuizResult:!1})},a.Pi=function(){return o.createElement("div",{className:"form-header-text-message"},this.props.HeaderMessage)},a.ii=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return!(this.props.Master.SyncContext===M.a.SharedTimeForm)||this.state.IsReportingView?[2]:[4,n.e(9).then(n.bind(null,152))];case 1:return[2,(0,t.sent().createDuplicateNavBarInternal)(this)]}}))}))},a.ki=function(){var t=this;if(this.Kr)return this.Kr.createAdminPhishingReviewNavBar(this.props.Master,(function(e){t.error=e,t.setState({ShowErrorPage:!0})}))},a.oi=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return this.props.Master.SyncContext!==M.a.SharedTimeForm?[3,2]:[4,n.e(9).then(n.bind(null,152))];case 1:return[2,(0,t.sent().showDuplicateMessageInternal)(this)];case 2:return[2]}}))}))},a.mi=function(){if(4!==this.state.SubmitState&&!this.state.IsStudentViewMode&&!this.props.MobileReadOnly){var t=[this.Ai(),this._i()];return t.some((function(t){return!!t}))?o.createElement.apply(o,Object(i.f)(["div",{className:"office-form-notice-container"}],t)):void 0}},a.Ai=function(){var t=this,e=this.props.Master.Model.Settings,n=this.props.Master.SyncContext===M.a.SharedTimeForm,r=!this.formRuntimeMaster.ElementManager().isFirstPage();return n||r?void 0:o.createElement(K.a.Consumer,{children:function(n){var r;if(e.IsAnonymous||e.NotRecordIdentity||t.props.PrintView)r="";else{var i=Object(l.a)().userInfo.GivenName||Object(l.a)().userInfo.DisplayName;i?r=n.LocalizedStrings.Response_NonAnonymous_Notice.format(i):(_.a.logData({errorName:"MissingUserName",errorInfo:{givenName:!!Object(l.a)().userInfo.GivenName,displayName:!!Object(l.a)().userInfo.DisplayName,userId:!!Object(l.a)().userInfo.UserId}}),r=n.LocalizedStrings.Response_NonName_Notice)}if(4!==t.state.SubmitState)return o.createElement("div",{},o.createElement("span",{className:"office-form-notice-long-text"},r))}})},a._i=function(){if(!this.props.MobileReadOnly){var t=this.props.Master,e=[];return e=t.hasSection()&&!this.Ui()?this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters.map((function(t){return t.Question.Model})):u.a.convertToArray(t.Model.Questions),s.some(e,(function(t){return t.Required}))?o.createElement(K.a.Consumer,{children:function(t){return o.createElement("div",null,o.createElement("span",{className:"office-form-required-notice-star"}),o.createElement("span",null,t.LocalizedStrings.Answer_Required_Notice))}}):void 0}},a.ai=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return this.state.IsStudentViewMode||4===this.state.SubmitState?[4,n.e(7).then(n.bind(null,153))]:[3,2];case 1:return[2,(0,t.sent().createResultContainerInternal)(this)];case 2:return[2]}}))}))},a.Si=function(){var t=this;return o.createElement(K.a.Consumer,{children:function(e){var n,r=t.$i(),i=r.map((function(t){return e.LocalizedStrings.Form_QuestionWithOrdinal.format(t)})).join(e.LocalizedStrings.Common_ItemSeperator);n=t.formRuntimeMaster.ElementManager().hasNextSection()?e.LocalizedStrings.Section_Question_Error_Message.format(r.length,i):e.LocalizedStrings.Form_Question_Error_Message.format(r.length,i);var c=Object(z.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size16x16"},IconName:"Warning"}),s=!!t.state.ShowValidationStyle&&!!r.length;return o.createElement("div",{className:Object(w.a)("office-form-submit-error",s?"":"NotVisible"),role:"alert"},c,o.createElement("span",{className:"error-message"},s?n:""))}})},a.$i=function(){return this.formRuntimeMaster.Form.hasSection()?this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters):this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters())},a.ui=function(t){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(e){switch(e.label){case 0:return this.state.ShowSpinnerForFirstTimeLoadMultilingual||t?[4,n.e(3).then(n.bind(null,154))]:[3,2];case 1:return[2,(0,e.sent().createMultiLingualSpinnerForEmailReceiptInternal)(this)];case 2:return[2]}}))}))},a.si=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return this.showMultiLingualSelect()?[4,n.e(3).then(n.bind(null,154))]:[3,2];case 1:return[2,(0,t.sent().createMultiLingualSelectInternal)(this)];case 2:return[2]}}))}))},a.ci=function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return this.state.ShowSpinnerWhenChangeLanguage?[4,n.e(3).then(n.bind(null,154))]:[3,2];case 1:return[2,(0,t.sent().createMultiLingualSpinnerInternal)(this)];case 2:return[2]}}))}))},a.showMultiLingualSelect=function(){return!(!this.props.Master.Model.LocaleList.length||this.state.IsStudentViewMode||!this.Ui()&&!this.formRuntimeMaster.ElementManager().isFirstPage())},a.di=function(){var t=this.props.Master,e=t.SyncContext===M.a.SharedTimeForm;if(!this.isMobile()&&(this.Ui()||this.formRuntimeMaster.ElementManager().isFirstPage())&&(this.props.PrintView||Object(b.b)("DataClassificationRuntime")&&!Object(l.a)().userInfo.IsMsa&&e&&t.isFieldReady(L.a.Schema.DataClassificationLabel)&&t.Model.DataClassificationLabel)){var n=Object(w.a)(this.showMultiLingualSelect()?"office-form-duplicate-classification-label-with-multilingual":"office-form-duplicate-classification-label-without-multilingual","office-form-duplicate-classification-label","office-form-theme-secondary-background");return o.createElement(J,{FormMaster:this.props.Master,HTMLAttributes:{className:n},DesignTimeView:!1})}},a.Li=function(){return this.props.Master.SyncContext===M.a.AdminPhishingReviewForm},a.Mi=function(){return this.props.Master.SyncContext===M.a.SharedTimeForm},a.ensureLayout=function(t){this.Bi(Object(G.c)(t))},a.Bi=function(t){var e=this,n=this.props.Master.SyncContext===M.a.ResponseTimeForm,i=this.props.Master.SyncContext===M.a.DesignTimeForm&&!Object(I.k)(),o=this.props.Master.SyncContext===M.a.DesignTimeForm&&Object(I.k)(),c=t?"rtl":"ltr";n?($(".form-content").attr("dir",c),d(t?r.ResponsePageRtl:r.ResponsePage).done((function(){return e.forceUpdate()}))):i?($(".form-content").attr("dir",c),d(t?r.DesignPageRtl:r.DesignPage).done((function(){return e.forceUpdate()}))):o&&($(".form-content").attr("dir",c),d(t?r.MobileDesignPageRtl:r.MobileDesignPage).done((function(){return e.forceUpdate()})))},a.onLanguageChange=function(t){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(e){switch(e.label){case 0:return[4,n.e(3).then(n.bind(null,154))];case 1:return(0,e.sent().handleLanguageChange)(t,this),[2]}}))}))},a.Ie=function(){var t=this.state.LocalizedResource.localeId;return Object(yt.a)({Form:this.props.Master,LocaleId:t!==this.defaultLanguageId&&t,IsMobile:this.props.ViewMode===kt.a.Mobile||Object(I.k)(),IsReadOnlyOnMobile:this.props.MobileReadOnly,IsSlimTitle:!this.Ui()&&!this.formRuntimeMaster.ElementManager().isFirstPage(),ImmersiveReaderToggleProps:{ShouldShowImmersiveReaderButtons:this.state.ShouldShowImmersiveReaderButtons,ToggleImmersiveReaderButtons:this.Dr}})},a.qi=function(){},a.Qi=function(t,e){var n=t.Section,r=t.TopQuestionMasters;if(!n)return this.Ei(r);var i=n.Model.Id,c=this.state.LocalizedResource.localeId,s=[];e||s.push(o.createElement(at,{HasTheme:!this.isMobile(),key:"form-section-breaker-"+i}));var u=this.Ei(r);return s.push(o.createElement(It,{children:u,Disabled:!0,DisableShuffle:!0,Expaned:!0,IsMobile:this.props.ViewMode===kt.a.Mobile||Object(I.k)(),LocaleId:c!==this.defaultLanguageId&&c,key:"form-section-container-"+i,SectionMaster:n,ShouldShowImmersiveReaderButtons:this.state.ShouldShowImmersiveReaderButtons})),s},a.Ri=function(){var t=this;return this.Ui()?[this.formRuntimeMaster.ElementManager().getAllSections().map((function(e,n){return t.Qi(e,0===n)}))]:this.Qi(this.formRuntimeMaster.ElementManager().getCurrentSection(),!0)},a.Ei=function(t){var e=this;if(t.length<=0)return null;var n,r=this.state.ShowValidationStyle,i=this.state.ShowQuizResult;Object(A.c)((function(){n=s.indexOf(e.formRuntimeMaster.TopQuestionRuntimeMasters(),t[0])+1}),A.e);var c=this.state.LocalizedResource.localeId;return o.createElement(K.a.Consumer,{children:function(o){return t.map((function(t,s){var u=t.Question.Model.Id,a={Master:t,LocaleId:c!==e.defaultLanguageId&&c,LocalizedStrings:o.LocalizedStrings,Ordinal:n+s,Disabled:4===e.state.SubmitState||e.state.IsStudentViewMode||t.Question.hasRuntimeError(),key:u,IsMobile:e.isMobile(),ShowValidationStyle:r,ShowQuizResult:i,ShowPhishingWarning:e.zi(),ShowFileInfo:!!e.props.HeaderMessage,HideMedia:!1,IsStudentViewMode:e.state.IsStudentViewMode,HideDeleteButton:1===e.state.SubmitState||4===e.state.SubmitState||e.state.IsStudentViewMode,increaseUploadingFileCountCallBack:e.Ur,decreaseUploadingFileCountCallBack:e.$r,setAbuseReportStateCallBack:e.Br,EnableShowHideQuestion:Object(A.c)((function(){return!1}),A.e),ShouldShowImmersiveReaderButtons:e.state.ShouldShowImmersiveReaderButtons};return Object(ut.a)(a)}))},key:"elementRenderers"})},a.wi=function(){var t=this;return this.Hi()?o.createElement(K.a.Consumer,{children:function(e){return o.createElement("div",{className:"office-form-bottom-button-div"},Object(V.b)({HTMLAttributes:{"aria-label":e.LocalizedStrings.Renderer_NextButtonText,className:"section-next-button office-form-bottom-button office-form-theme-button",disabled:!!t.formRuntimeMaster.Model.UploadingFileCount,onClick:t.Hr},ButtonStyle:"LightBackground",Text:e.LocalizedStrings.Renderer_NextButtonText}))}}):null},a.Oi=function(){var t=this;if(this.Ui()||!this.formRuntimeMaster.ElementManager().hasPrevSection())return null;var e=1===this.state.SubmitState||!!this.formRuntimeMaster.Model.UploadingFileCount;return o.createElement(K.a.Consumer,{children:function(n){return o.createElement("div",{className:"office-form-bottom-button-div"},Object(V.b)({HTMLAttributes:{"aria-label":n.LocalizedStrings.Renderer_PrevButtonText,className:"office-form-bottom-button office-form-dark-theme-button gray-background",disabled:e,onClick:t.zr},ButtonStyle:"LightBackground",Text:n.LocalizedStrings.Renderer_PrevButtonText}))}})},a.Ii=function(){var t=this,e=Object(z.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size16x16"},IconName:"Warning"}),n=1===this.state.SubmitState&&this.state.ShowLongOperationMessage;if(2===this.state.SubmitState||n)return o.createElement(K.a.Consumer,{children:function(r){return o.createElement(H.a,{HTMLAttributes:{className:Object(w.a)("office-form-submit-error",n?"submitting-warning":"")},LazyRendering:!0,Role:"Alert"},n?void 0:e,o.createElement("span",{className:"error-message"},n?r.LocalizedStrings.RetryRecoverableErrorMessage_Submitting:t.state.ErrorMessage))}})},a.Hi=function(){return!this.Ui()&&this.formRuntimeMaster.ElementManager().hasNextSection()},a.xi=function(){var t,e,n=this.props.Master;if(3===this.state.SubmitState){if(this.state.LocalizedResource&&this.state.LocalizedResource.localeId!==n.Model.DefaultLanguage)t=D.a.getFormResourceMaster(this.state.LocalizedResource.localeId,n).Model.thankYouMessage;t=t||n.Model.ThankYouMessage||this.state.LocalizedStrings.Renderer_SubmissionSucceeded,e=this.state.LocalizedStrings.Response_Page_Thanks}return o.createElement("div",{className:"office-form-submit-success-hint","aria-live":"polite"},o.createElement("div",null,e),o.createElement("div",null,t))},a.ji=function(){var t=this;if(!(this.Hi()||4===this.state.SubmitState||this.state.IsStudentViewMode||this.props.MobileReadOnly)){var e=1===this.state.SubmitState,r=e||!this.state.SubmitButtonDependencyReady||this.props.Master.SyncContext===M.a.SharedTimeForm||this.props.Master.SyncContext===M.a.AdminPhishingReviewForm||this.props.DisableSubmitButton||Object(I.o)()||this.formRuntimeMaster.Model.UploadingFileCount||X(this.props.Master.Model.OnlineSafetyLevel)||!1;return o.createElement(K.a.Consumer,{children:function(c){return o.createElement("div",{className:"__submit-button-div__ office-form-bottom-button-div"},Object(V.b)({HTMLAttributes:{className:Object(w.a)("__submit-button__ office-form-bottom-button office-form-theme-button",e?"office-form-hide-text":""),disabled:r,title:Object(I.o)()?c.LocalizedStrings.Renderer_SubmitButtonSPODisabledTitle:void 0,onClick:function(){return Object(i.b)(t,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,155))];case 1:return(0,t.sent().default)(c,this),[2]}}))}))}},ButtonStyle:"LightBackground",Text:c.LocalizedStrings.Renderer_SubmitButtonText}),t.Vi())}})}},a.Vi=function(){var t;if(t=Object(b.b)("FromsSpinnerControl")?"common-spinner-circle":"spinner-tile-animation",1===this.state.SubmitState)return o.createElement("div",{className:"submit-spinner"},o.createElement("div",{className:t},o.createElement(H.a,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log",children:Object(O.a)().Response_Page_Submitting_Message})))},a.SetMsRewardsThankyouState=function(t){},a.li=function(){var t=this;f.a.logData({name:"ResponsePage.ThanksView.SubmitAnother"}),this.Xr(),this.Yr(),this.formRuntimeMaster.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,ShowQuizResult:!1,SubmitState:0,ShowLongOperationMessage:!1,IsStudentViewMode:!1,HideQuestions:!0,EmailReceiptConsent:!1},(function(){t.setState({HideQuestions:!1},e.scrollToTop)}))},a.Xr=function(t){this.startTime=new Date,this.formRuntimeMaster.clearQuizResult(),this.formRuntimeMaster.Answers=t||[]},a.Yr=function(t){this.formRuntimeMaster.Model.RuntimeSectionId=t||null},a.setServerQuizResult=function(t){if(t){var e=Object(I.u)(t);Array.isArray(e)&&this.formRuntimeMaster.setQuizResults(e)}else this.formRuntimeMaster.calculateQuizResultFromModel()},a.isMobile=function(){switch(this.props.ViewMode){case kt.a.Desktop:return!1;case kt.a.Mobile:return!0;default:return Object(I.k)()}},a.Ar=function(){var t=this.props.persistAnswer;t&&(this.formRuntimeMaster.isDefaultAnswer()?t(void 0):t(u.a.convertToArray(this.formRuntimeMaster.Answers)));var e=this.$i().length;e!==this.state.WrongQuestionCount&&this.setState({WrongQuestionCount:e})},a._r=function(){var t=this.props.persistSectionId;t&&(null==this.formRuntimeMaster.Model.RuntimeSectionId?t():t(this.formRuntimeMaster.Model.RuntimeSectionId));var e={ShowValidationStyle:!1},n=this.ti();n!=this.state.CompletionRate&&(e.CompletionRate=n),this.setState(e,this.Jr)},a.Jr=function(){Object(Nt.a)(c.findDOMNode(this)),e.scrollToTop()},a.Ur=function(){this.formRuntimeMaster.Model.UploadingFileCount++},a.$r=function(){this.formRuntimeMaster.Model.UploadingFileCount>0&&this.formRuntimeMaster.Model.UploadingFileCount--},a.Br=function(){this.setState({IsReportingView:!0})},a.Er=function(){Object(I.r)()!==this.state.IsSmallScreen?this.setState({IsSmallScreen:!this.state.IsSmallScreen}):Object(S.d)()},a.Fi=function(){var t=this;if(this.zi()){return o.createElement(K.a.Consumer,{children:function(e){return o.createElement("div",{className:"office-form-notice-password"},e.LocalizedStrings.Response_Page_Footer_Notice,o.createElement("a",{className:Object(I.n)()?"office-form-notice-report office-form-theme-spo-link":"office-form-notice-report",href:"javascript:void(0)",onClick:function(){return t.setState({IsReportingView:!0})}},e.LocalizedStrings.Response_Page_Footer_Report))}})}},a.zi=function(){var t=this.props.Master.Model.Settings,e=this.props.Master.SyncContext===M.a.ResponseTimeForm;return!(!t.IsAnonymous||!e||this.state.ShowQuizResult||Object(m.t)()||Object(b.b)("RemoveRuntimeWarningbarReportAbuse")&&X(this.props.Master.Model.OnlineSafetyLevel))},e.scrollToTop=function(){Object(w.h)($(".office-form-title-container"),$(".office-form-content"),void 0,void 0,!0)},e.scrollToShowSubmitError=function(){Object(w.h)($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},a.gi=function(){var t=this,e=this.props.Master.Model,n=e.EmailReceiptEnabled&&!e.Settings.IsAnonymous&&!e.Settings.NotRecordIdentity&&!this.state.ShowQuizResult&&!this.Hi();return o.createElement(K.a.Consumer,{children:function(e){return n&&(r={HTMLAttributes:{className:"office-form-email-receipt-checkbox"},Value:t.state.EmailReceiptConsent,Description:e.LocalizedStrings.Response_Page_EmailReceipt_Checkbox_Description,SpanClassName:"office-form-email-receipt-checkbox-description",onValueChange:function(e){t.setState({EmailReceiptConsent:e})}},o.createElement(Q,r));var r}})},a.pi=function(){var t=this;if(this.state.ShowCompletionRate&&!this.state.ShowQuizResult){var e=o.createElement(K.a.Consumer,{children:function(e){var n,r,i=e.LocalizedStrings.FormsType_Form;return"survey"==t.props.Master.Model.Type?i=e.LocalizedStrings.FormsType_Survey:t.props.Master.SettingMaster.Model.IsQuizMode&&(i=e.LocalizedStrings.FormsType_Quiz),n={percentage:t.state.CompletionRate,lowerText:t.state.CompletionRate+"%",totalWidth:300,tooltipText:e.LocalizedStrings.ResponsePage_ProgressBar.format(t.state.CompletionRate,i)},r=Math.round(n.percentage*n.totalWidth/100),o.createElement("div",{"aria-label":n.tooltipText,title:n.tooltipText},o.createElement("div",{className:"progress-bar",style:{width:n.totalWidth+"px"}},o.createElement("div",{className:"progress-bar-control office-form-theme-primary-background",style:{width:r+"px"}})),o.createElement("div",{className:"progress-bar-text"},n.lowerText))}});return o.createElement("div",{className:"progress-bar-container"},e)}},a.Gi=function(){return!(this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters).length>0)||(this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError),!1)},a.zr=function(){this.formRuntimeMaster.ElementManager().gotoPrevSection()},a.Hr=function(){(this.props.Master.SyncContext===M.a.SharedTimeForm||this.Gi())&&this.formRuntimeMaster.ElementManager().gotoNextSection()},a.Ui=function(){return this.state.ShowQuizResult||this.props.PrintView||this.props.MobileReadOnly},a.rr=function(){this.forceUpdate()},a.Wr=function(){},a.$n=function(){return this.props.PrintView||this.props.MobileReadOnly},a.ri=function(){var t=this;Object(I.h)()||Object(E.a)().Flighting.isEnabled("ImmersiveReaderInForms")&&Object(F.d)().then((function(e){e&&Object(g.a)("ImmersiveReader").done((function(){if(ImmersiveReader){var e=t.Rr.current;if(e){for(var n=e.querySelectorAll(".immersive-reader-button img"),r=0;r<n.length;r++){var i=n[r];i.remove?i.remove():i.parentNode&&i.parentNode.removeChild(i)}ImmersiveReader.renderButtons()}}}))}))},a.Zr=function(){if(Object(b.b)("ProgressBar")){var t=this.props.Master,e=!!t.isFieldReady(L.a.Schema.ProgressBarEnabled)&&"true"===t.Model.ProgressBarEnabled;return this.Wi=t.FormElementManager.SectionMasters,this.Lr=t.FormElementManager.HeaderTopQuestionMasters.length>0?1:0,e&&this.Wi.length+this.Lr>1}return!1},a.ti=function(){var t=0;if(this.state.ShowCompletionRate){var e=this.Ji(),n=this.Wi.length+this.Lr;e&&0!=e&&(t=Math.round(100*e/n)),Object(U.a)({eventName:"ResponsePage.Form.SectionRender",eventType:"engagement_event",extraData:{ProgressBarPercentage:t}})}return t},a.Ji=function(){var t=this.formRuntimeMaster,e=t.Model.RuntimeSectionId;if(!e)return 0;var n=t.Form.FormElementManager.getDescriptiveElementMasterById(e);return n?this.Wi.indexOf(n)+this.Lr:0},e}(W.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(6);function i(t){var e=Object(r.a)();switch(t){case"1001":return e.Error_Message_1001;case"10203":return e.Error_Message_10203;case"10204":return e.Error_Message_10204;case"10205":return e.Error_Message_10205;case"10206":return e.Error_Message_10206;case"10207":return e.Error_Message_10207;case"10208":return e.Error_Message_10208;case"10300":return e.Error_Message_10300;case"10301":return e.Error_Message_10301;case"1204":return e.Error_Message_1204;case"15001":return e.Error_Message_15001;case"15003":return e.Error_Message_15003;case"1624":return e.Error_Message_1624;case"20000":return e.Error_Message_20000;case"20001":return e.Error_Message_20001;case"5001":return e.Error_Message_5001;case"5002":return e.Error_Message_5002;case"5003":return e.Error_Message_5003;case"5004":return e.Error_Message_5004;case"5005":return e.Error_Message_5005;case"5006":return e.Error_Message_5006;case"5109":return e.Error_Message_5109;case"5114":return e.Error_Message_5114;case"5117":return e.Error_Message_5117;case"5203":return e.Error_Message_5203;case"5204":return e.Error_Message_5204;case"5205":return e.Error_Message_5205;case"5206":return e.Error_Message_5206;case"5207":return e.Error_Message_5207;case"5208":return e.Error_Message_5208;case"5209":return e.Error_Message_5209;case"5302":return e.Error_Message_5302;case"532":return e.Error_Message_532;case"533":return e.Error_Message_533;case"534":return e.Error_Message_534;case"535":return e.Error_Message_535;case"536":return e.Error_Message_536;case"537":return e.Error_Message_537;case"5400":return e.Error_Message_5400;case"5401":return e.Error_Message_5401;case"5402":return e.Error_Message_5402;case"5403":return e.Error_Message_5403;case"5501":return e.Error_Message_5501;case"5503":return e.Error_Message_5503;case"5504":return e.Error_Message_5504;case"5550":return e.Error_Message_5550;case"5551":return e.Error_Message_5551;case"5552":return e.Error_Message_5552;case"5553":return e.Error_Message_5553;case"5554":return e.Error_Message_5554;case"5556":return e.Error_Message_5556;case"5557":return e.Error_Message_5557;case"5558":return e.Error_Message_5558;case"5559":return e.Error_Message_5559;case"5560":return e.Error_Message_5560;case"600":return e.Error_Message_600;case"601":return e.Error_Message_601;case"602":return e.Error_Message_602;case"603":return e.Error_Message_603;case"604":return e.Error_Message_604;case"605":return e.Error_Message_605;case"606":return e.Error_Message_606;case"607":return e.Error_Message_607;case"608":return e.Error_Message_608;case"609":return e.Error_Message_609;case"610":return e.Error_Message_610;case"6100":return e.Error_Message_6100;case"6102":return e.Error_Message_6102;case"6103":return e.Error_Message_6103;case"6105":return e.Error_Message_6105;case"611":return e.Error_Message_611;case"613":return e.Error_Message_613;case"614":return e.Error_Message_614;case"615":return e.Error_Message_615;case"620":return e.Error_Message_620;case"624":return e.Error_Message_624;case"625":return e.Error_Message_625;case"6252":return e.Error_Message_6252;case"6254":return e.Error_Message_6254;case"636":return e.Error_Message_636;case"642":return e.Error_Message_642;case"645":return e.Error_Message_645;case"650":return e.Error_Message_650;case"651":return e.Error_Message_651;case"652":return e.Error_Message_652;case"653":return e.Error_Message_653;case"654":return e.Error_Message_654;case"655":return e.Error_Message_655;case"656":return e.Error_Message_656;case"657":return e.Error_Message_657;case"658":return e.Error_Message_658;case"6611":return e.Error_Message_6611;case"6612":return e.Error_Message_6612;case"6613":return e.Error_Message_6613;case"6614":return e.Error_Message_6614;case"6700":return e.Error_Message_6700;case"6701":return e.Error_Message_6701;case"6702":return e.Error_Message_6702;case"6705":return e.Error_Message_6705;case"674":return e.Error_Message_674;case"700":return e.Error_Message_700;case"701":return e.Error_Message_701;case"702":return e.Error_Message_702;case"703":return e.Error_Message_703;case"704":return e.Error_Message_704;case"705":return e.Error_Message_705;case"707":return e.Error_Message_707;case"709":return e.Error_Message_709;case"710":return e.Error_Message_710;case"712":return e.Error_Message_712;case"714":return e.Error_Message_714;case"715":return e.Error_Message_715;case"717":return e.Error_Message_717;case"751":return e.Error_Message_751;case"752":return e.Error_Message_752;case"754":return e.Error_Message_754;case"755":return e.Error_Message_755;case"756":return e.Error_Message_756;case"812":return e.Error_Message_812;case"824":return e.Error_Message_824;default:return""}}},function(t,e,n){"use strict";function r(t){return"number"==typeof t}function i(t){return"string"==typeof t}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},function(t,e,n){"use strict";var r;function i(t){r=t}function o(){return r?r():$.Deferred().reject("GetAddinAccessTokenFailed").promise()}n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2),i=n(0),o=n(50),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=this.props,e=t.src,n=Object(r.e)(t,["src"]);return i.createElement("img",Object(r.a)({src:Object(o.a)(e)},n))},e}(n(16).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n(3);var r=n(63),i=n(113),o=n(9);function c(t,e){return!s(e)&&Object(r.d)(t)}function s(t){return!Object(o.b)("YouTubeAdminControl")||(Object(i.a)().Model.FormsTenantSettings.bingImageSearch||t&&t.isFieldReady(t.Schema.TenantSwitches)&&1===t.Model.TenantSwitches)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(11),i=n(21);function o(){return Object(r.p)()?Object(i.h)():Object(i.b)()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(2),i=n(0),o=n(75),c=n(24),s=function(t){function e(e){return t.call(this,e)||this}Object(r.c)(e,t);var n=e.prototype;return n.render=function(){var t=this.Ki(),e=this.props.displayText?this.props.displayText.toLocaleUpperCase():Object(c.b)({HTMLAttributes:{className:"author-notification-icon"},IconName:"Contact"}),n={backgroundColor:t.backgroundColor,color:t.textColor},o={"aria-label":this.props.ariaLabel||this.props.tooltip,className:"author-notification-content",style:n,title:this.props.tooltip};return i.createElement("div",Object(r.a)({},o),i.createElement("span",{"aria-hidden":!0},e))},e.createColor=function(t){for(var n=0,r=t.length-1;r>=0;r--){var i=t.charCodeAt(r),o=r%8;n^=(i<<o)+(i>>8-o)}var c=n%e.COLOR_SWATCHES_LOOKUP.length;return e.COLOR_SWATCHES_LOOKUP[c]},n.Ki=function(){var t=this.props,n="",r="";t.backgroundColor&&(n=Object(o.a)(t.backgroundColor)),t.textColor&&(r=Object(o.a)(t.textColor));var i=t.email||t.name;return""!==r&&""!==n||!i||(n=n||e.createColor(i),r=r||Object(o.a)(Object(o.b)(Object(o.c)(n)))),{backgroundColor:n=n||e.defaultBackgroundColor,textColor:r=r||e.defaultTextColor}},e.COLOR_SWATCHES_LOOKUP=["#3765E4","#D83B01","#B91C49","#910A19","#E40089","#971497","#8150FD","#562685","#2C5797","#007B8A","#11723F","#6F292A","#A16412"],e.defaultBackgroundColor=e.COLOR_SWATCHES_LOOKUP[0],e.defaultTextColor="#FFFFFF",e}(n(16).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n(10),i=new RegExp("\\(([^)]*)\\)","gi"),o=new RegExp("(?:[\0-/:-@[-^`{-퟿-￿]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]) ","gi"),c=new RegExp("\\s+","gi"),s=new RegExp("[ء-ي٠-٩]"),u=new RegExp("[ᄀ-ᇿ|㄰-㆏|ꥠ-꥿|가-힯|ힰ-퟿]"),a=new RegExp("[一-鿌㐀-䶵﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|[\ud86a-\ud86c][\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]");function f(t,e){var n=t.replace(/\s/,"");return e?n[n.length-1]:n[0]}function l(t,e){var n=t.replace(/\s/,"");return n.length<=2?e?n[0]:n[n.length-1]:e?n.substr(0,2):n.substr(n.length-2,n.length)}function h(t,e){var n="",r=t.split(" ");return 2===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[1].charAt(0).toUpperCase()):3===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[2].charAt(0).toUpperCase()):0!==r.length&&(n+=r[0].charAt(0).toUpperCase()),e&&n.length>1?n.charAt(1)+n.charAt(0):n}function d(t){return t=(t=(t=(t=t.replace(i,"")).replace(o,"")).replace(c," ")).trim()}function m(t,e){return null==t?"":(arguments.length<2&&(e=Object(r.p)()),t=d(t),s.test(t)?f(t,!!e):u.test(t)||a.test(t)?l(t,!!e):h(t,!!e))}function b(t,e,n){return m(t?t.trim():((e||"")+" "+(n||"")).trim())}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n(24);function o(t){var e=r.createRef(),n=r.createRef(),o=t.IsMobile,c=t.VideoUrl,s=o?"mobile-youtube":"pc-youtube";return s=t.InDesignMode?"design-question-title-youtube-placeholder "+s:"office-form-title-youtube-placeholder "+s,r.createElement("div",{className:s},r.createElement("div",{className:"question-title-youtube-title"},r.createElement("a",{className:"question-title-youtube-link",href:c,target:"_blank"},c)),r.createElement("div",{className:"question-title-youtube-tip"},r.createElement("span",{className:"question-title-youtube-tip-text"},t.LocalizedStrings.DesignPage_Youtube_Disabled_Launch_Tip),!o&&r.createElement(i.a,{HTMLAttributes:{className:"forms-icon-size12x12 question-title-youtube-tip-icon",onMouseOver:function(){var t=$(e.current),r=$(n.current);t&&r&&r.css({left:t.offset().left+t.width()/2,top:t.offset().top+t.width()/2})},ref:e},IconName:"Info"}),r.createElement("span",{className:"question-title-youtube-hover-tip ms-Icon",ref:n},t.LocalizedStrings.DesignPage_Youtube_Disabled_Hover_Tip)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2),i=n(0),o=n(29),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){return Object(o.e)()?i.createElement("div",{className:"image-alternative-text"},this.props.children):null},e}(n(16).a)},function(t,e,n){"use strict";var r=n(0),i=n(2),o=n(38),c=r.lazy((function(){return Object(i.b)(this,void 0,void 0,(function(){return Object(i.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(6).then(n.bind(null,159))];case 1:return[2,{default:t.sent().DateTimeRenderer}]}}))}))}));var s=n(3),u=n(4),a=n(64),f=n(9),l=n(27),h=n(30),d=n(8),m=n(10),b=n(82),v=n(91),g=n(18),p=n(36),O=n(61),j=n(7),w=n(70),S=n(128),I=n(83),F=n(81),y=n(24),N=n(16),k=function(t){function e(e){var n=t.call(this,e)||this;return n.Xi=n.Xi.bind(n),n}Object(i.c)(e,t);var n=e.prototype;return n.render=function(){var t=this.props.Choice,e=this.props.ContainerClassName;this.props.IsChecked&&this.props.IsMobile&&(e=Object(d.a)(e,"active"));var n=Object(d.a)("office-form-question-choice-row",this.props.ClassNameForLabel),o=Object(j.c)((function(){return t.Description}),j.e);return r.createElement("div",{className:e},r.createElement("div",{className:this.props.IsSingleChoice?"radio":"checkbox"},r.createElement("label",{className:n},r.createElement("input",Object(i.a)({"aria-checked":this.props.IsChecked,"aria-label":o,checked:this.props.IsChecked,disabled:this.props.Disabled,onChange:this.Xi,type:this.props.IsSingleChoice?"radio":"checkbox",value:t.Description},this.props.HTMLPropsForInput)),this.props.children,this.Yi())),this.Zi())},n.Yi=function(){var t,e;switch(this.props.AnswerType){case"Correct":e="CheckMark",t=this.props.IsMobile&&this.props.IsChecked?"image-button-checked-answerkey-mobile office-form-answerkey":"image-button-answerkey office-form-answerkey";break;case"Wrong":t=this.props.IsMobile?"image-button-checked-wrong-answer-mobile office-form-answerkey":"",e=this.props.IsMobile?"Cancel":""}if(e)return Object(y.b)({HTMLAttributes:{className:Object(d.a)(t,"forms-icon-size20x20"),role:"tooltip",title:this.props.ToolTipForAnswer},IconName:e})},n.Zi=function(){if(this.props.AnswerHint){var t=void 0;return t="Correct"===this.props.AnswerType?this.props.IsMobile?"validation-success-mobile":"validation-success":this.props.IsMobile?"validation-error-mobile":"validation-error",t=Object(d.a)("office-form-answerhint",t),r.createElement("div",{className:t},this.props.AnswerHint)}},n.Xi=function(){this.props.onChange(this.props.Choice.Description)},e}(N.a),T=n(52),C="6c660282-db72-436c-87bb-8272cba504d3",P=function(t){function e(e){var n=t.call(this,e)||this;n.to=r.createRef(),n.eo=Object(h.b)();var i=n.no(),o=n.io(),c=n.oo();return n.state={ChoiceOptions:o,IsOtherOptionSelected:!!i.OtherAnswer,LocalizedOptions:n.questionLocalizedItemMaster&&n.questionLocalizedItemMaster.Model.option,OptionsOrder:c,OrderedChoices:s.map(c,(function(t){return o[t]})),OtherOptionText:i.OtherAnswer,ReachMaxLengthLimit:!1,SelectedOptions:i.SelectedOptions},n.Ye=n.Ye.bind(n),n.co=n.co.bind(n),n.so=n.so.bind(n),n.uo=n.uo.bind(n),n.ao=n.ao.bind(n),n.fo=n.fo.bind(n),n}Object(i.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.props.Master.Question.observe(this.so),this.props.ShowQuizResult&&this.props.Master.observe(this.ao,[O.a.Schema.Answer]),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.uo,[p.a.Schema.choicesV1])},n.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.uo),this.props.Master.Question.unobserve(this.so),this.props.ShowQuizResult&&this.props.Master.unobserve(this.ao,[O.a.Schema.Answer]),t.prototype.componentWillUnmount.call(this)},n.componentWillReceiveProps=function(e){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.uo),t.prototype.componentWillReceiveProps.call(this,e),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.uo,[p.a.Schema.choicesV1])},n.shouldComponentUpdate=function(t,e){var n=!s.isEqual(t,this.props),r=!s.isEqual(e,this.state);return n||r},n.createReactNodes=function(){var t=this.props.Master.Question,e=t.Model,n=e.ChoiceType===g.a.SingleChoice;return this.props.ExpandAll||!t.showAsDropdown()||this.props.IsMobile||e.IsQuiz&&this.props.ShowQuizResult?[this.ho(n),this.do()]:[this.mo()]},n.getFormattedDataForImmersiveReader=function(){var e=t.prototype.getFormattedDataForImmersiveReader.call(this),n=null,r=document.createElement("ul");return s.forEach(this.state.OrderedChoices,(function(t){var e=document.createElement("li"),i=null;if(t.IsMathOption&&"undefined"!=typeof MathJax){n=n||MathJax.Hub.getAllJax(null);var o=s.find(n,(function(e){return e.originalText===t.Description}));if(o){var c=o.root&&o.root.toMathML&&o.root.toMathML();c&&(c=c.replace(/\n\s*/g,""),i="\x3c!--[if mathML]&#62;"+Object(d.b)(c,!0)+"&#60;![endif]--\x3e")}}e.innerHTML=i||Object(d.b)(t.Description,!0),r.appendChild(e)})),r.appendChild(document.createElement("br")),e.splice(e.length-1,0,{content:r.outerHTML,mimeType:"text/html"}),e},n.ao=function(){var t=this.no();this.setState({IsOtherOptionSelected:!!t.OtherAnswer,OtherOptionText:t.OtherAnswer,SelectedOptions:t.SelectedOptions})},n.bo=function(t){},n.vo=function(){var t,e=this,n=[],r=this.props.Master.Question.Model.ChoiceType===g.a.SingleChoice,i=this.state.SelectedOptions;i&&i.forEach((function(t){return n.push(t)}));var o=this.state.OtherOptionText;if(Object(j.c)((function(){e.state.IsOtherOptionSelected&&o&&-1===n.indexOf(o)&&n.push(o)}),j.e),r)t=n[0];else if(n.length){var c=this.po(n);t=JSON.stringify(c)}this.props.Master.Model.Answer=t},n.ho=function(t){var n=this,o=this.props.Master.Question.Model,c=this.state.OrderedChoices.length+(o.AllowOtherAnswer?1:0),u=this.props.Master.Question.Form,f=Object(a.b)(u,a.a.ResponsePagePollView),l=Object(d.a)(this.props.IsMobile&&!f?"office-form-question-choice-mobile office-form-theme-page-background-active":"office-form-question-choice"),h=this.state.OrderedChoices.map((function(i,o){var u,a=-1!==n.state.SelectedOptions.indexOf(i.Description),f=n.props.Master.Question.Model.IsQuiz?"office-form-question-choice-quiz-row":"";if(n.props.Master.Question.Model.IsMathQuiz&&i.IsMathOption){var h=Object(b.c)({DisableLinebreaks:n.props.DisableFormulaLinebreak,Formula:i.Description,onRenderComplete:n.props.onHeightChange});u=r.createElement("div",{className:"office-form-question-choice-formula"},h)}else{f=Object(d.a)(f,"office-form-question-choice-text-row");var m,v=n.questionLocalizedItemMaster;if(v){var g=v.getChoiceV1LocalizedMaster(n.state.OptionsOrder[o]);m=g&&g.Model.description}var p={RenderMode:"RichText",Text:m||i.Description};u=r.createElement("span",{className:"office-form-question-choice-text-span"},Object(F.a)(p))}var O,j=e.getAnswerKeyMark(n.props,i,a);switch(j){case"Correct":O=n.props.LocalizedStrings.Quiz_CorrectAnswer;break;case"Wrong":O=n.props.LocalizedStrings.Quiz_WrongAnswer}var w={name:n.eo};return t&&s.extend(w,{"aria-posinset":o+1,"aria-setsize":c}),r.createElement(k,{AnswerHint:e.getAnswerHintLabel(n.props,i,a),AnswerType:j,ToolTipForAnswer:O,Choice:i,ClassNameForLabel:f,ContainerClassName:l,Disabled:n.props.Disabled,HTMLPropsForInput:w,IsChecked:a,IsMobile:n.props.IsMobile,IsSingleChoice:t,key:o,LocalizedStrings:n.props.LocalizedStrings,onChange:n.Ye},u)})),m=this.getElementProps({key:"choicequestion-choices",role:t?"radiogroup":"group"});return r.createElement("div",Object(i.a)({},m),h,this.Oo(t))},n.jo=function(){this.props.Master.Model.Answer||this.props.Master.Model.Visible||this.so()},n.Oo=function(t){var e=this.props.Master.Question.Form,n=Object(a.b)(e,a.a.ResponsePagePollView);if(this.props.Master.Question.Model.AllowOtherAnswer){var o={className:this.props.IsMobile&&!n?"office-form-other-answer-mobile":"office-form-other-answer",key:"other-answer"};return r.createElement("div",Object(i.a)({},o),this.wo(t),this.So())}},n.wo=function(t){var e=this.state.ChoiceOptions,n={"aria-label":this.props.LocalizedStrings.Response_Page_OtherAnswerTitle,checked:this.state.IsOtherOptionSelected,disabled:this.props.Disabled,name:t?this.eo:void 0,onChange:this.co,ref:"otherAnswerInput",role:"checkbox",type:"checkbox",value:this.state.OtherOptionText||""};return t&&(n.role="radio",n.type="radio",n["aria-posinset"]=e.length+1,n["aria-setsize"]=e.length+1),r.createElement("input",Object(i.a)({},n))},n.co=function(){var t=this,e=this.state.IsOtherOptionSelected,n=s.clone(this.state.SelectedOptions);if(!e){this.props.Master.Question.Model.ChoiceType===g.a.SingleChoice&&(n=[]);var r=this.to.current;r&&r.focus()}this.setState({IsOtherOptionSelected:!e&&!!this.state.OtherOptionText,SelectedOptions:n},(function(){return t.vo()}))},n.So=function(){var t={"aria-label":this.props.LocalizedStrings.Designer_OtherAnswer,className:"office-form-other-answer-textbox"},e={AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"inline-display office-form-other-answer-margin-left-mobile"},MaxLength:Object(l.j)(),onValueChange:this.fo,Options:{HTMLPropsForInnerElement:t},Placeholder:this.props.LocalizedStrings.Designer_OtherAnswer,ref:this.to,Value:this.state.OtherOptionText||""};return Object(I.a)(e)},n.fo=function(t){var e=this,n=this.state.SelectedOptions;this.props.Master.Question.Model.ChoiceType===g.a.SingleChoice&&(n=[]),this.setState({IsOtherOptionSelected:!!t,OtherOptionText:t,SelectedOptions:n},(function(){return e.vo()}))},n.so=function(){var t=this.no();this.setState({ChoiceOptions:this.io(),OptionsOrder:this.oo(),OrderedChoices:this.Io(),OtherOptionText:t.OtherAnswer,SelectedOptions:t.SelectedOptions})},n.uo=function(){this.setState({LocalizedOptions:this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.option})},n.Ye=function(t){var e=this,n=s.clone(this.state.SelectedOptions),r=this.props.Master.Question.Model.ChoiceType===g.a.SingleChoice,i=this.state.IsOtherOptionSelected,o=!1;if(r){if(t===n[0])return;i=!1,n=[t]}else{var c=n.indexOf(t);-1===c?n.push(t):n.splice(c,1),o=JSON.stringify(n).length>v.a.MaxAnswerLength}this.setState({IsOtherOptionSelected:i,ReachMaxLengthLimit:o,SelectedOptions:n},(function(){return e.vo()}))},n.do=function(){if(this.state.ReachMaxLengthLimit)return Object(w.a)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:this.props.LocalizedStrings.Error_Message_Question_Reach_Limit})},n.mo=function(){var t,e,n=this,i=this.props.Master,o=i.Question.Model,c=this.state.OrderedChoices.map((function(t,e){var r,i=n.questionLocalizedItemMaster;if(i){var o=i.getChoiceV1LocalizedMaster(n.state.OptionsOrder[e]);r=o&&o.Model.description}return{DisplayName:r||t.Description,Key:u.a.getObjectMasterFromModel(t).getInstanceId(),Value:t.Description}})),s=i.Model.Answer;o.AllowOtherAnswer&&c.push(this.Fo()),this.state.IsOtherOptionSelected&&(s=C),!this.props.ShowDesignInfo&&this.state.IsOtherOptionSelected&&(t=this.yo()),e=function(t){return n.No(t)};var a=Object(S.a)({AllowWrap:!0,HTMLAttributes:this.getElementProps({className:"office-form-question-dropdown",disabled:this.props.Disabled,title:o.Hint||this.props.LocalizedStrings.Dropdown_DefaultHint}),key:"choicequestion-dropdown",onValueChange:e,Placeholder:o.Hint||this.props.LocalizedStrings.Dropdown_DefaultHint,SelectOptions:c,Value:s});return r.createElement("div",{className:this.getValidationStyle()},a,t)},n.No=function(t){var e=this,n=t===C,r=n?[]:[t];Object(j.c)((function(){e.setState({IsOtherOptionSelected:n,SelectedOptions:r},(function(){return e.vo()}))}),j.e)},n.Fo=function(){return{DisplayName:this.props.LocalizedStrings.Designer_OtherAnswer,Key:C,Value:C}},n.yo=function(){var t=this,e={"aria-label":this.props.LocalizedStrings.TextField_DefaultPlaceholder,className:"office-form-other-answer-textbox"},n={AutoFocus:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"office-form-other-answer office-form-dropdown-other-answer"},onValueChange:function(e){t.setState({OtherOptionText:e,SelectedOptions:[]},(function(){return t.vo()}))},Options:{HTMLPropsForInnerElement:e},Placeholder:this.props.LocalizedStrings.TextField_DefaultPlaceholder,ref:this.to,Value:this.state.OtherOptionText};return Object(I.a)(n)},n.po=function(t){var e=this.props.Master.Question.Model.Choices,n=s.map(e,(function(t){return t.Description}));return t.sort((function(t,e){return n.indexOf(t)-n.indexOf(e)}))},e.isQuizResultAnswerKey=function(t,e){if(!t||!t.IsAnswerKeys)return!1;var n=t.Choices;return!!n&&t.IsAnswerKeys[n.indexOf(e.Description)]},e.getAnswerKeyMark=function(t,n,r){var i=t.Master,o=i.Model.QuizResult,c=i.Question,s=e.isQuizResultAnswerKey(o,n);return n.IsAnswerKey&&t.ShowDesignInfo&&c.Model.IsQuiz||s?"Correct":r&&o&&o.IsAnswerKeys&&o.IsAnswerKeys.some((function(t){return t}))&&!s?"Wrong":"Normal"},e.getAnswerHintLabel=function(t,e,n){var r=t.Master.Model.QuizResult;if(!t.ShowDesignInfo&&n&&r){var i=r.Choices,o=i?i.indexOf(e.Description):-1;return r.AnswerHints&&r.AnswerHints[o]}},n.io=function(){var t=this.props.Master.Question.Model;return this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.getChoiceV1LocalizedMaster(t.Choices.length-1),u.a.convertToArray(t.Choices)},n.Io=function(){var t=this;return s.map(this.state.OptionsOrder,(function(e){return t.state.ChoiceOptions[e]}))},n.oo=function(){for(var t=this.props.Master.Question.Model,e=[],n=0;n<t.Choices.length;n++)e[n]=n;return this.props.ShowQuizResult||!t.ShuffleOptions||this.props.DisableShuffle?e:s.shuffle(e)},n.no=function(){var t,e=this.props.Master,n=e.Model,r=e.Question.Model,i=r.ChoiceType===g.a.SingleChoice,o=[],c=Object(v.b)(n.Answer,r).SelectedOptions;c.length>0&&(i?[n.Answer]:c).forEach((function(e){-1!==s.findIndex(r.Choices,(function(t){return t.Description===e}))?o.push(e):r.AllowOtherAnswer&&(t=e)}));return{OtherAnswer:t,SelectedOptions:o}},e}(T.a),x=n(21),M=n(1),L=n(11),D=n(130),R=n(48),E=n(23),A=n(67),_=Object(L.s)()?"https://graph.microsoft.com/v1.0/":"https://graph.microsoft-ppe.com/v1.0/",U=function(){function t(t){this.To=t.Model.Id,t&&(this.I=Object(E.b)(t))}var e=t.prototype;return e.createFileUploadSession=function(t,e){return this.I.createUploadSession(this.To,t,e).then((function(t){return null==t?$.Deferred().reject(new Error("no data return")).promise():t}))},e.cancelOrDeleteUploadFile=function(t){return this.I.cancelOrDeleteUploadFile(t)},e.uploadBytesToSession=function(t,e,n,r,i,o){return Object(A.a)({body:e,headers:{"Content-Range":"bytes "+r+"-"+i+"/"+o,"Content-Type":"*/*"},method:"PUT",qosEventName:"FileUpload.UploadFile",requestUri:t.uploadUrl})},e.getFileFolder=function(t){var e=this;return Object(D.a)((function(n){return Object(A.a)({headers:{Authorization:n,"Content-Type":"*/*"},method:"GET",qosEventName:"FileUpload.GetOD4BFolderPath",requestUri:_+(r=e.To,i=Object(R.a)(r),o=i.OwnerId,c=i.OrgId,s=i.IsGroupOwner?"groups":"users",c+"/"+s+"/"+o)+"/drive/items/"+t}).then((function(t){return t.webUrl}));var r,i,o,c,s}))},t}();var B={hasFile:M.a.boolean(),uploadSessions:M.a.collectionOf({bytesToSend:M.a.number(),fileName:M.a.string(),fileSize:M.a.number(),key:M.a.string(),uploadState:M.a.reference(),uploadUrl:M.a.string()},{IsLocalField:!0})},q=function(t){function e(e){var n=t.call(this)||this;return n.Co=new U(e),n}Object(i.c)(e,t);var n=e.prototype;return n.uploadFile=function(t,e,n,r,i){var o=this;return this.Co.createFileUploadSession(r,e).then((function(e){return o.Po(t,i,e)}))},n.cancelOrDeleteUploadFile=function(t){return this.Co.cancelOrDeleteUploadFile(t)},n.xo=function(t,e,n,r){var i=this;void 0===r&&(r=0);if(e&&"rejected"!==e.uploadState)if(r>=2)this.Co.cancelOrDeleteUploadFile(e.uploadUrl);else{var o=function(t,e){var n=e.bytesToSend?e.bytesToSend:0,r=Object(l.d)(),i=t.size-e.bytesToSend;i>r&&(i=r);return{chunkSize:i,finalByteIndex:n+i-1,initialByteIndex:n}}(t,e),c=new FileReader;c.onerror=function(){i.Co.cancelOrDeleteUploadFile(e.uploadUrl)},c.onload=function(){i.Mo(c.result,t,e,r,o,n)};var s=t.slice(o.initialByteIndex,o.finalByteIndex+1);c.readAsArrayBuffer(s)}},n.Mo=function(t,e,n,r,i,o){var c=this;return this.Co.uploadBytesToSession(n,t,i.chunkSize,i.initialByteIndex,i.finalByteIndex,e.size).done((function(){i.finalByteIndex<e.size-1?(n.bytesToSend=i.finalByteIndex+1,c.xo(e,n,o)):("rejected"!==n.uploadState&&(n.uploadState="success"),o.resolve(n.uploadUrl))})).fail((function(t){c.xo(e,n,o,r+1)}))},n.Po=function(t,e,n){var r=$.Deferred();if(e.uploadUrl=n,"rejected"!==e.uploadState)return this.xo(t,e,r),r.promise();r.resolve(n)},e}(u.a.createObjectMasterClass("UploadFileProcessMaster",B));var Q=n(12),z=n(17),H=n(51),V=n(79),G=n(106),W=n(65),J=function(t){function e(e){var n=t.call(this,e)||this;return n.Lo=n.Lo.bind(n),n.Do=n.Do.bind(n),n.Ro=n.Ro.bind(n),n.Eo=n.Eo.bind(n),n}Object(i.c)(e,t);var n=e.prototype;return n.render=function(){var t=this.props;if("pending"===t.UploadState){var e=r.createElement(W.a,{ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":t.LocalizedStrings.UploadFile_Cancel_Upload_Label&&t.LocalizedStrings.UploadFile_Cancel_Upload_Label.format(t.FileName),className:"office-form-cancel-fileUpload office-form-theme-primary-foreground office-form-theme-button-color",onClick:this.Lo},Text:t.LocalizedStrings.UploadFile_Cancel_Button});return this.props.IsMobile,r.createElement("div",{className:"office-form-uploadFile"},r.createElement(y.a,{HTMLAttributes:{className:"uploading office-form-theme-primary-color forms-icon-size14x14"},IconName:"Sync"}),Object(H.d)(t.FileName),r.createElement("span",{className:"office-form-uploadFile-text"},t.FileName),e)}var n=Object(V.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{"aria-label":t.LocalizedStrings.UploadFile_Delete_Uploaded_File_Label&&t.LocalizedStrings.UploadFile_Delete_Uploaded_File_Label.format(t.FileName),className:(this.props.AutoFocus?"inline-display":"dn")+" office-form-delete-button",onClick:this.Do,title:this.props.LocalizedStrings.Delete_Button_Narrator},Icon:"Delete",IconClassName:"delete-file-button forms-icon-size16x16"}),i="office-form-upload-done-item";return t.Disabled||(i=Object(d.a)(i,"office-form-upload-done-item-background")),r.createElement("div",{className:i,onBlur:this.Eo},r.createElement("div",{className:"office-form-upload-file-info",onFocus:this.Ro,tabIndex:0},Object(H.d)(t.FileName),t.showFileInfo?r.createElement("a",{className:"office-form-uploadFile-text office-form-uploadFile-name",href:t.FilePath,target:"_blank"},t.FileName):r.createElement("span",{className:"office-form-uploadFile-text office-form-uploadFile-name"},t.FileName)),!this.props.Disabled&&n)},n.Ro=function(){this.props.setFocusOnCurrentItem(this.props.FileName)},n.Eo=function(t){var e=t.currentTarget.parentElement,n=Object(d.d)(t);e&&n&&e.contains(n)||this.props.setFocusOnCurrentItem()},n.Do=function(t){var e=this.props;e.deleteFile(e.FilePath,e.FileName,e.UploadState,e.FileKey),this.props.setFocusOnCurrentItem(),Object(G.b)(t.currentTarget)},n.Lo=function(t){var e=this.props;e.deleteFile(e.FilePath,e.FileName,e.UploadState,e.FileKey),this.props.setFocusOnCurrentItem(),Object(G.b)(t.currentTarget)},e}(N.a),K=function(t){function e(e){var n=t.call(this,e)||this;n.Ao=1e3,n._o=r.createRef(),n.Uo=function(){return n.forceUpdate()},n.$o=n.$o.bind(n),n.Do=n.Do.bind(n),n.Ye=n.Ye.bind(n),n.Bo=n.Bo.bind(n),n.qo=n.qo.bind(n);var i=e.Master;return i&&(n.Qo(),i.observe(n.Uo,[i.Schema.Answer])),n}Object(i.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){t.prototype.componentDidMount.call(this),0===this.zo&&Object(H.f)(this.props.Master.Question)},n.syncAnswerAndSession=function(){var t=this.props.Master;if(!this.Ho){var e=t.Question.Form;if(!e.isFieldReady(e.Schema.Id))return!1;this.Ho=new q(e)}var n=this.Ho,r=this.Vo(),i=n.Model.uploadSessions,o=s.filter(i,(function(t){return"pending"===t.uploadState||!!s.find(r,(function(e){return e.uploadUrl===t.uploadUrl}))}));return s.forEach(r,(function(t){s.find(o,(function(e){return e.uploadUrl===t.uploadUrl}))||o.push(t)})),n.Model.uploadSessions=o,!0},n.createReactNodes=function(){if(!this.syncAnswerAndSession())return null;var t=this.props.Master;return[r.createElement("div",{key:t.Question.Model.Id,className:"office-form-uploadFile-container"},this.Go(),this.Wo(),this.Jo(),this.Ko(),this.Ii(),this.Xo())]},n.createQuestionContent=function(){var e,n=this.props.Master.Question.Form;n.isFieldReady(Q.a.Schema.Id)&&(e=Object(H.e)(n.Model.Id));var i=n.IsGroupForm?this.props.LocalizedStrings.UploadFile_GroupForm_Warning_Text:this.props.LocalizedStrings.UploadFile_Warning_Text;if(e&&this.props.designElement){var o=Object(x.c)();return[r.createElement(o,{clickNoButton:function(){},clickContinueButton:this.Bo,description:i,key:"dialog"})]}return t.prototype.createQuestionContent.call(this)},n.Vo=function(){return this.Yo().map((function(t){return{fileName:t.name,key:t.link,uploadState:"success",uploadUrl:t.link}}))},n.Wo=function(){var t=this.props,e=this.Ho.Model.uploadSessions.length,n=this.props.LocalizedStrings;if(!t.IsStudentViewMode&&e<t.Master.Question.Model.MaxFileCount&&!t.ShowQuizResult){var r="office-form-upload-container office-form-theme-primary-foreground";this.props.IsMobile&&(r=Object(d.a)(r,"office-form-upload-container-width"));var i={className:r,disabled:t.Disabled,onClick:this.$o};Object(f.b)("ResponderFileUpload")||(i.disabled=!0,i.title=t.LocalizedStrings.UploadFile_Service_Unavailable_Warning);var o=this.props.LocalizedStrings.UploadFile_Button+"\n            "+n.UploadFile_Max_File_Number.format(t.Master.Question.Model.MaxFileCount)+"\n            "+n.UploadFile_Single_File_Size.format(this.Zo())+"\n            "+n.UploadFile_Allowed_File_Type.format(this.tc());return i["aria-label"]=o,Object(V.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",HTMLAttributes:i,Icon:"Upload",IconClassName:"forms-icon-size18x18",Text:this.props.LocalizedStrings.UploadFile_Button,TextClassName:"office-form-upload-text"})}},n.$o=function(t){$(this._o.current).val("").click()},n.Jo=function(){var t=Object(H.c)(this.props.Master.Question.Model.FileTypes),e="";t.forEach((function(t){e+="."+t+","}));var n={accept:e,className:"file-upload-question-file-reader",multiple:!0,onChange:this.Ye,ref:this._o,type:"file"};return r.createElement("input",Object(i.a)({},n))},n.Ye=function(t){var e=this,n=t&&t.target,r=n&&n.files;if(this.Ho.Model.uploadSessions.length+r.length<=this.props.Master.Question.Model.MaxFileCount){if(this.ec(r)&&this.rc(r)&&this.ic(r)){this.setState({ErrorMessage:""});var i=[];s.forEach(r,(function(t){var n=t.name.replace(/^.*[\\\/]/,"");n=n.replace(/[%#]/g,"-"),e.oc(t,n),i.push(n)}));var o=i.join(" ");this.setState({ToolTip:this.props.LocalizedStrings.UploadFile_Uploading_Text.format(o)})}}else this.cc(this.props.LocalizedStrings.UploadFile_ExceedFileNumber_ErrorMessage)},n.ic=function(t){var e=this.Ho.Model.uploadSessions;return void 0===s.find(t,(function(n){return void 0!==s.find(t,(function(t){return t!==n&&t.name===n.name}))||void 0!==s.find(e,(function(t){return t.fileName===n.name}))}))||(this.cc(this.props.LocalizedStrings.UploadFile_FileNameExisted_ErrorMessage),!1)},n.ec=function(t){var e=this,n=s.find(t,(function(t){return 0===t.size}));return n?(this.cc(this.props.LocalizedStrings.UploadFile_Error_Empty_File),!1):!(n=s.find(t,(function(t){return t.size>1024*e.props.Master.Question.Model.MaxFileSize*1024})))||(this.cc(this.props.LocalizedStrings.UploadFile_ExceedMaxsize_ErrorMessage),!1)},n.rc=function(t){var e=Object(H.c)(this.props.Master.Question.Model.FileTypes);return!s.find(t,(function(t){var n=t.name.split("."),r=n[n.length-1].toLowerCase();return-1===e.indexOf(r)}))||(this.cc(this.props.LocalizedStrings.UploadFile_WrongFileType_ErrorMessage),!1)},n.Go=function(){var t,e=this,n=this.props,i=[];return(null===(t=this.Ho)||void 0===t?void 0:t.Model)&&(i=u.a.convertToArray(this.Ho.Model.uploadSessions)),s.map(i,(function(t){return r.createElement(J,{AutoFocus:t.fileName===e.state.SelectedFileName,Disabled:n.Disabled,FileKey:t.key,FileName:t.fileName,FilePath:t.uploadUrl,FileUploadProcessMaster:e.Ho,key:t.key,LocalizedStrings:n.LocalizedStrings,increaseUploadingFileCountCallBack:n.increaseUploadingFileCountCallBack,decreaseUploadingFileCountCallBack:n.decreaseUploadingFileCountCallBack,deleteFile:e.Do,UploadState:t.uploadState,setFocusOnCurrentItem:e.qo,showFileInfo:n.ShowFileInfo,IsMobile:n.IsMobile})}))},n.Xo=function(){var t=this.props,e=t.Master.Question.Model,n=this.Yo().length+this.Ho.Model.uploadSessions.length,i=this.props.LocalizedStrings;if(!t.Disabled&&n<t.Master.Question.Model.MaxFileCount||t.ShowDesignInfo)return r.createElement("div",{className:"office-form-upload-restriction"},r.createElement("span",{className:"office-form-upload-restriction-text"},i.UploadFile_Max_File_Number.format(e.MaxFileCount)),r.createElement("span",{className:"office-form-upload-restriction-text"},i.UploadFile_Single_File_Size.format(this.Zo())),r.createElement("span",{className:"office-form-upload-restriction-text"},i.UploadFile_Allowed_File_Type.format(this.tc())))},n.Ii=function(){var t=this.state.ErrorMessage;if(t)return r.createElement("div",{className:"office-form-upload-file-error-message-container"},t)},n.Ko=function(){return r.createElement("div",{"aria-live":"assertive",className:"office-form-uploading-tip"},r.createElement("span",null,this.state.ToolTip))},n.tc=function(){var t=this;this.zo=0;var e=[],n=[],r=this.props.Master.Question.Model.FileTypes,i=this.props.LocalizedStrings;return Object.keys(r).forEach((function(o){var c=Object(H.a)(i,o);n.push(c),r[o]&&(t.zo++,e.push(c))})),0===this.zo?n.join(i.UploadFile_Comma):e.join(i.UploadFile_Comma)},n.oc=function(t,e){var n=this;this.props.increaseUploadingFileCountCallBack&&this.props.increaseUploadingFileCountCallBack();var r=this.Ho,i=this.props.Master.Question,o={bytesToSend:0,fileName:e,fileSize:t.size,key:Date.now().toString(),uploadState:"pending"},c=r.Model.uploadSessions,a=u.a.Collection.addItems(c,[o])[0];this.setState({ErrorMessage:""}),r.uploadFile(t,e,i.Form.Model.Id,i.Model.Id,a).done((function(t){"success"===a.uploadState&&(n.sc(t,e),n.props.decreaseUploadingFileCountCallBack())})).fail((function(t){Object(z.a)({eventName:"DesignPage.Questions.FileUpload.UploadFailure",eventType:"engagement_event",extraData:{error:t}}),r.bulkEdit((function(e){n.uc(t),c=s.reject(c,(function(t){return t.key===o.key})),e.uploadSessions=c}))}))},n.Do=function(t,e,n,r){var i="";i="pending"===n?this.props.LocalizedStrings.UploadFile_Cancel_Upload_Label.format(e):this.props.LocalizedStrings.UploadFile_Delete_Uploaded_File_Label.format(e),this.setState({ToolTip:i}),this.props.decreaseUploadingFileCountCallBack();var o=this.Ho.Model.uploadSessions,c=s.find(o,(function(t){return t.key===r}));"rejected"!==c.uploadState&&(c.uploadState="rejected",t&&this.Ho.cancelOrDeleteUploadFile(t)),u.a.Collection.deleteItems(o,[c]);var a=this.Yo(),f=s.findIndex(a,(function(e){return e.link===t}));-1!==f&&(a.splice(f,1),this.ac(a))},n.cc=function(t){var e=this;setTimeout((function(){e.setState({ErrorMessage:t}),e.setState({ToolTip:t})}),this.Ao)},n.uc=function(t){if(t){var e=620===t.innerCode?this.props.LocalizedStrings.Error_Message_620:this.props.LocalizedStrings.UploadFile_Default_ErrorMessage;this.cc(e),this.props.decreaseUploadingFileCountCallBack&&this.props.decreaseUploadingFileCountCallBack()}},n.Qo=function(){var t=this.Yo(),e=t.filter((function(t){return!t.time||Date.now()-t.time<864e5}));t.length!==e.length&&this.ac(e)},n.sc=function(t,e){var n=this.Yo(),r={link:t,name:e,uploadSessionUrl:t,time:Date.now()};n.push(r);var i=this.Ho.Model.uploadSessions;n.sort((function(t,e){return s.findIndex(i,(function(e){return e.uploadUrl===t.link}))-s.findIndex(i,(function(t){return t.uploadUrl===e.link}))})),this.ac(n)},n.ac=function(t){0===t.length?this.props.Master.Model.Answer=void 0:this.props.Master.Model.Answer=JSON.stringify(t)},n.Yo=function(){var t=this.props.Master.Model.Answer,e=[];return t&&(e=JSON.parse(t)),e},n.Bo=function(){var t=this.props.Master.Question;Object(H.g)(t.Form,!1),this.props.designElement(t)},n.Zo=function(){var t=this.props.Master.Question.Model.MaxFileSize,e=H.b,n="";return Object.keys(H.b).forEach((function(r){t===e[r]&&(n=r)})),n},n.qo=function(t){this.setState({SelectedFileName:t})},e}(T.a),X=n(57),Y=function(t){function e(e){var n=t.call(this,e)||this;return n.fc=r.createRef(),n.lc=function(){return n.forceUpdate()},n.state={FocusedIndex:-1},n.hc=n.hc.bind(n),n.dc=n.dc.bind(n),n.mc=n.mc.bind(n),n.bc=n.bc.bind(n),n.vc=!1,n}Object(i.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.props.Disabled||this.props.QuestionRuntimeMasterClass.observe(this.bc,[O.a.Schema.Answer]),this.props.QuestionMasterClass.observe(this.lc,[Object(x.i)().Schema.Title]),this.props.LocaleId&&this.gc(this.props.LocaleId,this.props.QuestionMasterClass.Model.Id,this.props.QuestionMasterClass.Form)},n.componentWillReceiveProps=function(t){this.gc(t.LocaleId,t.QuestionMasterClass.Model.Id,t.QuestionMasterClass.Form)},n.componentWillUnmount=function(){this.props.QuestionRuntimeMasterClass&&this.props.QuestionRuntimeMasterClass.unobserve(this.lc),this.props.QuestionMasterClass.unobserve(this.lc),this.pc&&this.pc.unobserve(this.lc)},n.render=function(){var t=this.props.QuestionMasterClass,e=this.pc&&this.pc.Model.title||t.Model.Title;return this.props.PadView?r.createElement("div",{className:"office-form-mobile-matrix-points",onBlur:this.mc,onFocus:this.hc,ref:this.fc},this.Oc(e)):r.createElement("tr",{className:"office-form-matrix-str",role:"radiogroup",hidden:this.vc},this.jc(e))},n.bc=function(){this.props.QuestionMasterClass.Model.Required?this.props.UpdateTopQuestion():this.forceUpdate()},n.gc=function(t,e,n){this.pc&&(this.props.QuestionMasterClass.unobserve(this.lc),this.pc=void 0),t&&(this.pc=X.a.getQuestionResourceMaster(t,e,n),this.pc&&this.pc.observe(this.lc,[p.a.Schema.title]))},n.hc=function(t){this.props.IsExpanded||this.props.onChange(this.props.QuestionIndex,!0);var e=t.target;this.setState({FocusedIndex:parseInt(e.value,10)})},n.mc=function(t){var e=t.relatedTarget,n=this.fc.current;n&&!n.contains(e)&&this.setState({FocusedIndex:-1})},n.jc=function(t){var e=this,n=[],i=r.createElement("span",{className:"office-form-matrix-subquestion",id:this.wc(this.props.QuestionIndex)},Object(j.c)((function(){return t}),j.e)),o=r.createElement("td",{className:"office-form-matrix-std",key:"subQuestionTitle"},i);n.push(o);var c=s.map(this.props.Choices,(function(t,n){var r=!1;if(!e.props.ShowDesignInfo){var i=e.props.QuestionRuntimeMasterClass&&e.props.QuestionRuntimeMasterClass.Model.Answer;r=i&&s.isEqual(i.id,t.Id)}return e.Sc(e.props.QuestionMasterClass.Model.Id,n,!!r)}));return n=n.concat(c)},n.Sc=function(t,n,i){var o=this.props,c=o.Disabled,u=o.Choices,a=o.PadView,f="subquestion-radio-"+t,l=this.Ic(n),h=r.createElement("input",{"aria-checked":i,"aria-labelledby":l+" "+this.wc(this.props.QuestionIndex),"aria-posinset":n+1,"aria-setsize":u.length,checked:i,disabled:c,name:f,onChange:c?void 0:this.dc,type:"radio",value:n,role:Object(j.c)((function(){return"button"}),j.e)});if(a){var m=this.props.LocalizedChoices,b=u[n],v=void 0;m&&m.length&&(v=s.find(m,(function(t){return t.choiceId===b.Id.toString()})));var g=v&&v.description||b.Description,p=Object(d.a)("office-form-question-matrix-choice","office-form-theme-page-background-active",i?"active":""),O=Object(d.a)("radio-icon "+(this.state.FocusedIndex===n?"focused":""),"ms-Icon ms-Icon--"+(i?"RadioBtnOn":"RadioBtnOff"),c?"disabled":"");return r.createElement("li",{key:n,className:p,role:"listitem"},r.createElement("label",{className:"office-form-question-matrix-choice-row"},h,r.createElement("i",{className:O,"aria-hidden":"true"}),r.createElement("span",{className:"office-form-question-matrix-choice-text",id:l},g)))}return r.createElement("td",{className:"office-form-matrix-radio",key:n,onClick:e.enlargeClickArea},r.createElement("label",{className:"office-form-matrix-label"},h))},e.enlargeClickArea=function(t){var e=t.target;e===t.currentTarget&&e.firstChild.click()},n.Ic=function(t){var e=this;return Object(j.c)((function(){return e.props.QuestionOrdinal+"-col-"+(t+1)}),j.e)},n.Oc=function(t){var e=this,n=this.props,i=n.QuestionMasterClass,o=n.Choices,c=n.QuestionRuntimeMasterClass,u=n.QuestionIndex,a=-1,f=s.map(o,(function(t,n){var r=!1;if(!e.props.ShowDesignInfo){var o=c&&c.Model.Answer;r=o&&s.isEqual(o.id,t.Id)}return r&&(a=n),e.Sc(i.Model.Id,n,r)})),l=r.createElement("ul",{className:"office-form-mobile-matrix-choices",key:"choicelist",role:"radiogroup"},f),h=-1!==a?o[a].Description:"";return[this.Fc(t,h,u),l]},n.wc=function(t){return this.props.QuestionOrdinal+"-row-"+(t+1)},n.Fc=function(t,e,n){var o=this,c={className:"office-form-mobile-matrix-title",id:this.wc(n),key:"subquestion-title",onClick:this.props.PadView?function(){return o.props.onChange(n,!o.props.IsExpanded)}:void 0,ref:function(t){if(t){var e=t.parentElement,n=t.offsetHeight;o.props.IsExpanded&&(n+=t.nextElementSibling.offsetHeight),e&&(e.style.height=n+"px")}}};return r.createElement("div",Object(i.a)({},c),r.createElement("div",{className:"office-form-mobile-matrix-title-header"},r.createElement("span",null,t),r.createElement(y.a,{HTMLAttributes:{className:"select-dropdown-arrow forms-icon-size20x20"},IconName:this.props.IsExpanded?"ChevronUp":"ChevronDown"})),r.createElement("div",{className:"office-form-mobile-matrix-answered-indicator"},r.createElement("span",null,e)))},n.dc=function(t){var e=this.props.QuestionRuntimeMasterClass,n=t.currentTarget,r=n.checked?{id:this.props.Choices[parseInt(n.value,10)].Id}:void 0;e&&(this.props.PadView&&this.props.onChange(this.props.QuestionIndex+1,!0),e.Model.Answer=r)},e}(N.a),Z=function(t){function e(e){var n=t.call(this,e)||this;return n.state={IsSubQuestionsExpanded:[!e.Disabled]},n.yc=n.yc.bind(n),n}Object(i.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){var e=this;t.prototype.componentWillMount.call(this);var n=this.props.Master;this.Nc=function(t){return e.kc(t)},u.a.getCollectionMasterFromModel(n.Question.Form.Model.Questions).observe(this.Nc),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[p.a.Schema.choices])},n.componentWillUnmount=function(){u.a.getCollectionMasterFromModel(this.props.Master.Question.Form.Model.Questions).unobserve(this.Nc),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update),t.prototype.componentWillUnmount.call(this)},n.createReactNodes=function(){var t,e=this.Tc();if(this.Cc()){var n=this.getElementProps({className:"office-form-mobile-matrix-container",key:"Likert",role:"list"});t=r.createElement("div",Object(i.a)({},n),e)}else{var o=this.Pc();t=r.createElement("div",{className:"office-form-matrix-table",key:"Likert"},r.createElement("table",Object(i.a)({},this.getElementProps(),{role:"group"}),o,r.createElement("tbody",{className:"office-form-matrix-stbody"},e)))}return[t]},n.kc=function(t){var e=this.props.Master;t.AddedModels.concat(u.a.convertToArray(t.RemovedModels)).map(u.a.getObjectMasterFromModel).some((function(t){return t.Model.GroupId===e.Question.Model.Id}))&&this.forceUpdate()},n.Pc=function(){var t,e=this,n=this.props.Master.Question.Model,o=this.questionLocalizedItemMaster,c=r.createElement("td",{className:"office-form-matrix-ptd",key:"emptyTd"}),u={className:"office-form-matrix-ptd",width:"width:calc((100% - 180px)/"+n.ChoiceGroup.length+")"},a=n.ChoiceGroup;return t=s.map(a,(function(t,n){var c;o&&o.Model.choices.length&&(c=s.find(o.Model.choices,(function(e){return e.choiceId===t.Id.toString()})));var a=c&&c.description||t.Description;return r.createElement("td",Object(i.a)({},u,{key:n,id:e.Ic(n)}),r.createElement("span",null,a))})),r.createElement("thead",{className:"office-form-matrix-pthead"},r.createElement("tr",{className:"office-form-matrix-ptr"},c,t))},n.Tc=function(){var t,e,n=this,o=this.props.Master,c=o.Question.Model.ChoiceGroup,u=o.SubQuestions,a=this.Cc(),f=this.questionLocalizedItemMaster;if(f){var l=f.Model;t=l.localeId,e=l.choices}return s.map(u,(function(s,u){var f={Choices:c,Disabled:n.props.Disabled,IsExpanded:n.state.IsSubQuestionsExpanded[u],LocaleId:t||"",LocalizedChoices:e,onChange:function(t,e){return n.xc(t,e)},PadView:!!a,QuestionIndex:u,QuestionMasterClass:s,QuestionOrdinal:n.getQuestionId(),QuestionRuntimeMasterClass:o.getSubQuestionRuntimeById(s.Model.Id),ShowDesignInfo:!!n.props.ShowDesignInfo,UpdateTopQuestion:n.yc};return r.createElement(Y,Object(i.a)({},f,{key:s.getInstanceId()}))}))},n.yc=function(){this.update()},n.Cc=function(){return this.props.IsMobile||!this.props.ShowDesignInfo&&Object(m.r)()},n.xc=function(t,e){var n=[];t<this.props.Master.SubQuestions.length&&(n[t]=e),this.setState({IsSubQuestionsExpanded:n})},n.Ic=function(t){return this.getQuestionId()+"-col-"+(t+1)},e}(T.a),tt=n(6),et=function(t){function e(n){var i=t.call(this,n)||this;return i.Mc=r.createRef(),i.Lc=Object(h.b)(),i.Dc=e.createNPSOptions(),i.Rc=function(t){var e=i.props.onValueChange;e&&e(parseInt(t.currentTarget.value,10))},i.Ec=function(t){i.setState({FocusValue:parseInt(t.currentTarget.value,10)})},i.Ac=function(){i.setState({FocusValue:void 0})},i._c=function(t){return i.Uc(t)},i.$c=function(){return i.Bc=!0},i.qc=function(t){i.Bc=!1,i.setState({Touch:-1})},i.Qc=function(t){return i.zc(t)},i}Object(i.c)(e,t);var n=e.prototype;return n.render=function(){var t="nps-control clearfix unselectable-text",e="nps-control-table reset";this.props.Disabled||(e=Object(d.a)(e,"enabled"));var n=this.props.HTMLAttributes,o={};return n&&(t=Object(d.a)(t,n.className),s.extend(o,n)),o.className=e,r.createElement("div",{className:t,role:"radiogroup"},this.Hc(),r.createElement("table",Object(i.a)({},o),this.Vc(),this.Gc()),this.props.LeftLabel||this.props.RightLabel?this.Wc():void 0)},n.Hc=function(){var t=this.state.Touch,e=Object(d.a)(void 0!==t&&-1!==t?"nps-pop-up show":"nps-pop-up",this.props.ClassNameForInnerLabel,t===this.props.Value?"active":"");return r.createElement("div",{className:e,ref:this.Mc},r.createElement("span",{className:"nps-pop-up-text"},this.state.Touch))},n.Wc=function(){var t=this;return Object(j.c)((function(){return r.createElement("div",{className:"nps-control-label-container clearfix"},r.createElement("div",{className:"left-label"},r.createElement("span",null,t.props.LeftLabel)),r.createElement("div",{className:"right-label"},r.createElement("span",null,t.props.RightLabel)))}),j.e)},e.createNPSOptions=function(){for(var t=[],e=0;e<11;e++)t.push({DisplayName:nt(e),Key:e,Value:e});return t},n.Vc=function(){return r.createElement("thead",null,r.createElement("tr",{className:"nps-head-row"},this.Dc.map((function(t){return r.createElement("th",{className:"nps-head-column",key:t.Key},t.Value)}))))},n.Gc=function(){var t=this,e=this.Dc.map((function(e,n){return t.Jc(e,n)}));return r.createElement("tbody",null,r.createElement("tr",null,e))},n.Jc=function(t,e){var n=this.props.Value,o=this.props.Disabled;s.isString(n)&&(n=parseInt(n,10));var c=n===t.Value,u="nps-"+this.Lc+"-"+t.Value,a={"aria-label":t.Value.toString(),"aria-posinset":e+1,"aria-setsize":this.Dc.length,checked:c,disabled:this.props.Disabled,id:u,name:"nps-"+this.Lc,type:"radio",value:t.Value},f={htmlFor:u};return o||(s.extend(a,{onBlur:-1===this.state.Touch?void 0:this.Ac,onChange:this.Rc,onFocus:-1===this.state.Touch?void 0:this.Ec}),s.extend(f,{htmlFor:u,onTouchCancel:this.qc,onTouchEnd:this.Qc,onTouchMove:this.$c,onTouchStart:this._c})),f.className=Object(d.a)("answer-label",void 0!==this.state.Touch?"touch":"",this.props.ClassNameForInnerLabel,c?"active":"",this.state.FocusValue===t.Value?"focus":""),r.createElement("td",{key:t.Key,className:"radio-button-item"},r.createElement("div",{className:"radio-button"},r.createElement("input",Object(i.a)({},a)),r.createElement("label",Object(i.a)({},f),r.createElement("span",{"data-text":t.Value,className:"radio-button-display"}))))},n.Uc=function(t){var e=t.currentTarget,n=this.Mc.current,r=n.parentElement.getBoundingClientRect(),i=e.getBoundingClientRect(),o=i.width/2,c=i.height/2;n.style.left=i.left-r.left-o/2+"px",n.style.top=i.top-r.top-c/2+"px",n.style.width=i.width+o+"px",n.style.height=i.height+c+"px";var s=e.firstElementChild;this.setState({Touch:parseInt(s.dataset.text,10)})},n.zc=function(t){var e=this;if(this.Bc)this.Bc=!1,this.setState({Touch:-1});else{var n=this.state.Touch;this.setState({Touch:-1},(function(){var t=e.props.onValueChange;t&&t(n)}))}t.preventDefault()},e}(N.a);function nt(t){return t<7?Object(tt.a)().NPS_Detractors:t>8?Object(tt.a)().NPS_Promoters:Object(tt.a)().NPS_Passives}var rt=function(t){function e(e){var n=t.call(this,e)||this;return n.Kc=function(t){return n.props.Master.Model.Answer=t},n}Object(i.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){t.prototype.componentWillMount.call(this),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[p.a.Schema.leftDescription,p.a.Schema.rightDescription])},n.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update),t.prototype.componentWillUnmount.call(this)},n.createReactNodes=function(){var t=this.props.Master.Question.Model,e=this.props.Master.Model,n=this.questionLocalizedItemMaster,i=n&&n.Model,o=i&&i.leftDescription||t.LeftDescription,c=i&&i.rightDescription||t.RightDescription;return[r.createElement("div",{key:"nps",className:"office-form-question-nps-container"},r.createElement(et,{ClassNameForInnerLabel:"office-form-theme-button-foreground",Disabled:this.props.Disabled,HTMLAttributes:this.getElementProps(),LeftLabel:o,RightLabel:c,onValueChange:this.Kc,Value:e.Answer}))]},e}(T.a),it=n(80),ot=n(90),ct=function(t){function e(e){var n=t.call(this,e)||this;return n.Xc="office-form-theme-sort-item office-form-selected-item",n.Yc=-1,n.Zc=-1,n.ts=r.createRef(),n.ns=!1,n.rs=!1,n.He=!1,n.os(),n.us=n.us.bind(n),n.fs=n.fs.bind(n),n.ls=n.ls.bind(n),n.hs=n.hs.bind(n),n.ds=n.ds.bind(n),n.bs=n.bs.bind(n),n.vs=n.vs.bind(n),n.gs=n.gs.bind(n),n}Object(i.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){var e=this;t.prototype.componentWillMount.call(this),this.He=!0,Object(it.a)("Sortable").done((function(){e.He&&e.setState({SortableLoaded:!0})})),this.ps=function(){e.os(),e.forceUpdate()},this.props.Master.Question.observe(this.ps,[Object(x.i)().Schema.ChoiceGroup]),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.ps,[p.a.Schema.choices])},n.componentWillUnmount=function(){this.He=!1,this.Os&&(this.Os.destroy(),this.Os=void 0),t.prototype.componentWillUnmount.call(this),this.props.Master.Question.unobserve(this.ps),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.ps)},n.componentWillReceiveProps=function(e){t.prototype.componentWillReceiveProps.call(this,e),e.ShowQuizResult&&this.os(),(e.ShowDesignInfo||e.Disabled)&&this.Os&&(this.Os.destroy(),this.Os=void 0)},n.componentDidMount=function(){t.prototype.componentDidMount.call(this);var e=this.ts.current;!this.props.ShowDesignInfo&&!this.props.Disabled&&this.state.SortableLoaded&&e&&this.bs(e)},n.componentDidUpdate=function(t,e){if(this.ws&&this.ws.length>0&&-1!==this.Yc&&this.Ss(),!this.props.ShowDesignInfo&&!this.props.Disabled&&this.state.SortableLoaded&&!this.Os){var n=this.ts.current;n&&this.bs(n)}},n.createReactNodes=function(){var t=this.Is(),e=this.Fs(),n=this.props.IsMobile?"office-form-mobile-sort-list":"office-form-sort-list",o=this.getElementProps({className:n,onKeyDown:this.ds,ref:this.ts,role:"listbox"});return[r.createElement("div",Object(i.a)({},o,{key:"Ranking"}),t),e]},n.getFormattedDataForImmersiveReader=function(){var e=t.prototype.getFormattedDataForImmersiveReader.call(this),n=null,r=document.createElement("ul");return s.forEach(this.ws,(function(t){var e=document.createElement("li"),i=null;if(t.IsMathOption&&"undefined"!=typeof MathJax){n=n||MathJax.Hub.getAllJax(null);var o=s.find(n,(function(e){return e.originalText===t.Description}));if(o){var c=o.root&&o.root.toMathML&&o.root.toMathML();c&&(c=c.replace(/\n\s*/g,""),i="\x3c!--[if mathML]&#62;"+Object(d.b)(c,!0)+"&#60;![endif]--\x3e")}}e.innerHTML=i||Object(d.b)(t.Description,!0),r.appendChild(e)})),r.appendChild(document.createElement("br")),e.splice(e.length-1,0,{content:r.outerHTML,mimeType:"text/html"}),e},n.bs=function(t){var e={animation:150,chosenClass:"office-form-sortable-chosen",delay:this.props.IsMobile?150:0,fallbackClass:"office-form-sortable-fallback",filter:".office-form-ranking-arrow",forceFallback:!0,ghostClass:"office-form-sortable-ghost",handle:".office-form-sort-item",onEnd:this.gs,onStart:this.vs,preventOnFilter:!1};try{this.Os=Sortable.create(t,e),this.rs||Object(z.a)({eventName:"DesignPage.Questions.SortableInitialization",eventType:"engagement_event",extraData:{Successful:!0}}),this.rs=!0}catch(t){Object(z.a)({eventName:"DesignPage.Questions.SortableInitialization",eventType:"engagement_event",extraData:{Successful:!1}}),this.rs=!1}},n.vs=function(t){if(this.ns=!0,-1!==this.Zc&&this.Zc!==t.oldIndex){var e=this.ts.current;if(e){var n=e.children[this.Zc];n&&$(n.firstElementChild).removeClass(this.Xc)}}},n.gs=function(t){var e=t.oldIndex,n=t.newIndex,r=this.props.Master.Model.Answer;if(this.ns=!1,r&&e===n)t.item.firstChild.focus();else{var i=this.ts.current;e<n?$(i).find(".office-form-sort-item-container:eq("+e+")").before($(t.item)):e>n&&$(i).find(".office-form-sort-item-container:eq("+e+")").after($(t.item)),this.Yc=0,this.ys(e,n)}},n.Is=function(){var t=this,e=this.props.Master.Model.Answer,n=this.Ns(),r=e&&e.length>0;return s.map(this.ws,(function(e,i){return t.ks(e,i,n,r)}))},n.ks=function(t,n,o,c){var u,a,f=this.questionLocalizedItemMaster;if(f){var l=s.find(f.Model.choices,(function(e){return e.choiceId===t.Id+""}));u=l&&l.description||""}if(u=u||t.Description,c&&o){var h=this.props.Master.Model.QuizResult,m=JSON.parse(h.GradingBasis),b=t.Key===m[n];a=r.createElement("span",{className:"office-form-sort-item-icon"},e.getAnswerKeyMark(b))}!this.props.Disabled&&this.props.IsMobile&&(a=e.createDragHandleIcon());var v,g=r.createElement("div",{className:"office-form-sort-item-indicator"},a,r.createElement("span",{className:"office-form-sort-item-ordinal office-form-theme-secondary-color"},c?n+1:void 0)),p=this.getQuestionId()+"-"+n,O={"aria-posinset":n+1,"aria-setsize":this.ws.length,className:"office-form-sort-item",disabled:this.props.Disabled,id:p,role:"option",tabIndex:this.props.Disabled?void 0:0};if(!this.props.Disabled){var j={disabled:!0,tabIndex:-1},w=0===n,S={"aria-describedby":p,"aria-label":this.props.LocalizedStrings.QuestionType_Ranking_ArrowUp_Narrator,className:Object(d.a)("office-form-ranking-arrow",w?"office-sort-disabled-arrow":"office-form-active-arrow"),onClick:w?void 0:this.us,title:this.props.LocalizedStrings.QuestionType_Ranking_ArrowUp_Narrator};S=w?Object(d.f)(S,j):S;var I={ButtonStyle:"LightBackground",children:Object(y.b)({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"Up"}),HTMLAttributes:S,key:"form-up-arrow"+n},F=r.createElement(ot.a,Object(i.a)({},I)),N=n===this.ws.length-1,k={"aria-describedby":p,"aria-label":this.props.LocalizedStrings.QuestionType_Ranking_ArrowDown_Narrator,className:Object(d.a)("office-form-ranking-arrow",N?"office-sort-disabled-arrow":"office-form-active-arrow"),onClick:N?void 0:this.fs,title:this.props.LocalizedStrings.QuestionType_Ranking_ArrowDown_Narrator};k=N?Object(d.f)(k,j):k;var T={ButtonStyle:"LightBackground",children:Object(y.b)({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"Down"}),HTMLAttributes:k,key:"form-down-arrow"+n},C=r.createElement(ot.a,Object(i.a)({},T));O=Object(d.f)(O,{onBlur:this.hs,onFocus:this.ls}),v=r.createElement("div",{className:"office-form-sort-list-arrows"},F,C)}var P=r.createElement("div",Object(i.a)({},O),g,r.createElement("div",{className:"office-form-sort-item-content"},u),v);return r.createElement("div",{className:"office-form-sort-item-container office-form-unselectable",key:t.Key},P)},n.ls=function(t){if(!this.ns){var e=t.currentTarget;$(e).addClass(this.Xc);var n=this.ts.current;if(n){var r=n.children,i=e.parentElement;this.Zc=s.findIndex(r,(function(t){return i===t}))}}},n.hs=function(t){var e=t.currentTarget,n=Object(d.d)(t);this.ns||e&&n&&e.contains(n)||($(e).removeClass(this.Xc),this.Zc=-1)},n.us=function(){this.Ts(0)},n.fs=function(){this.Ts(1)},n.Ts=function(t){var e,n=this.Zc;0===t?(this.Yc=1,e=n-1):(this.Yc=2,e=n+1),this.ys(n,e)},e.getAnswerKeyMark=function(t){return Object(y.b)({HTMLAttributes:{className:Object(d.a)("office-form-judge-icon forms-icon-size16x16",t?"office-form-right-answerkey":"office-form-wrong-answerkey")},IconName:t?"CheckMark":"Cancel"})},e.stringifyAnswer=function(t){return s.map(t,(function(t,e){return{answerOrder:e,id:t.Id}}))},e.createDragHandleIcon=function(){return r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.createElement("circle",{cx:"9.5",cy:"6.5",r:"1.5",fill:"currentColor"}),r.createElement("circle",{cx:"14.5",cy:"6.5",r:"1.5",fill:"currentColor"}),r.createElement("circle",{cx:"9.5",cy:"12.5",r:"1.5",fill:"currentColor"}),r.createElement("circle",{cx:"14.5",cy:"12.5",r:"1.5",fill:"currentColor"}),r.createElement("circle",{cx:"9.5",cy:"18.5",r:"1.5",fill:"currentColor"}),r.createElement("circle",{cx:"14.5",cy:"18.5",r:"1.5",fill:"currentColor"}))},n.Ns=function(){var t=this.props.Master.Question.Model,e=this.props.Master.Model.QuizResult;return!(!this.props.ShowQuizResult||!t.IsQuiz)&&!!e},n.Fs=function(){var t=this.props.Master.Model.QuizResult;if(!this.Cs()){var e=this.props.Master.Question.Model.ChoiceGroup,n=JSON.parse(t.GradingBasis).map((function(t){return s.findWhere(e,{Key:t})})).filter((function(t){return!!t})).map((function(t){return t&&t.Description})).join(this.props.LocalizedStrings.VariousLocations_ItemList_Separator),i=Object(d.a)("office-form-right-answerkey","various-short-text-correct-answer-list-correctness-icon","forms-icon-size14x14"),o=Object(y.b)({HTMLAttributes:{"aria-hidden":!0,className:i,role:"presentation"},IconName:"CheckMark"});return r.createElement("div",{className:"various-short-text-correct-answer-list",key:"correctAnswerList"},o,r.createElement("b",null,this.props.LocalizedStrings.VariousLocations_CorrectAnswerList_Label," "),n)}},n.Cs=function(){var t=this.props.Master.Question.Model,e=this.props.Master.Model.QuizResult;return!(!this.props.ShowDesignInfo&&t.IsQuiz)||!(e&&!e.IsAnswerCorrect)},n.ds=function(t){var e=this.ts.current;if(-1!==this.Zc&&e){var n=e.children,r=n.length,i=this.Zc+r,o=void 0;switch(t.keyCode){case 38:this.Yc=-1,(o=n[--i%r])&&o.firstElementChild.focus();break;case 40:this.Yc=-1,(o=n[++i%r])&&o.firstElementChild.focus()}}},n.Ss=function(){var t=this.Zc,e=this.ts.current;if(e){var n=e.children[t];if(n)if(0===this.Yc)n.firstElementChild.focus();else{var r=".office-form-sort-list-arrows > button:nth-child("+((1===this.Yc?0===t?1:0:n===e.lastElementChild?0:1)+1)+")";n.querySelector(r).focus()}}this.Yc=-1},n.os=function(){var t=this.props.Master,e=t.Question.Model,n=t.Model.Answer;n&&n.length>0?this.ws=s.clone(n).sort((function(t,e){return t.answerOrder-e.answerOrder})).map((function(t){return s.find(e.ChoiceGroup,(function(e){return e.Id===t.id}))||{Description:t.displayText,Id:t.id,Key:t.key,Order:t.order}})):this.props.ShowDesignInfo||!e.IsQuiz||this.props.ShowQuizResult?this.ws=u.a.convertToArray(e.ChoiceGroup).sort((function(t,e){return t.Order-e.Order})):this.ws=s.shuffle(e.ChoiceGroup)},n.ys=function(t,n){var r=this.ws.splice(t,1)[0];this.ws.splice(n,0,r),this.Zc=n,this.props.Master.Model.Answer=e.stringifyAnswer(this.ws),this.forceUpdate()},e}(T.a),st=n(98),ut=n(66);function at(t,e,n,i,o,c,s,u,a,f,l,h){var m,b={className:"office-form-rating-container-"+(m=0===t?"star":"number")+" container-margin-right"},v={className:"office-form-rating-container-"+m+" container-margin-left"};""===n&&(b.className=Object(d.a)(b.className,"container-empty")),u===a&&(b.className=Object(d.a)(b.className,"container-"+m+"-max-width"),v.className=Object(d.a)(v.className,"container-"+m+"-max-width"));Object(F.a)({Text:Object(j.c)((function(){return n}),j.e),RenderMode:"RichText",ContainsHtml:!0}),Object(F.a)({Text:Object(j.c)((function(){return i}),j.e),RenderMode:"RichText",ContainsHtml:!0});var g=Object(j.c)((function(){return r.createElement("div",b,r.createElement("div",{className:"office-form-question-rating-description-"+m},n))}),j.e),p=Object(j.c)((function(){return r.createElement("div",v,r.createElement("div",{className:"office-form-question-rating-description-"+m},i))}),j.e);if(n||i){var O=n,w=i,S=r.createElement("div",{className:"office-form-response-rating-description"},r.createElement("div",{className:"office-form-rating-description-label"},o),r.createElement("div",{className:"rating-option-description"},Object(tt.a)().Colon.format(O))),I=r.createElement("div",{className:"office-form-response-rating-description"},r.createElement("div",{className:"office-form-rating-description-label"},c),r.createElement("div",{className:"rating-option-description"},Object(tt.a)().Colon.format(w))),y=r.createElement("div",{className:"office-form-rating-description-container",id:f},S,I);return[r.createElement("div",{className:"office-form-question-rating-container",key:"container",ref:e},g,s,p),y]}return[r.createElement("div",{className:"office-form-question-rating-container",key:"container",ref:e},g,s,p)]}var ft=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ps=s.uniqueId("ratingAccessibilityLabel."),e}Object(i.c)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t,e=this.props;if(!(null!=e.Value&&""!==e.Value)&&e.ToRenderIfNoRatingAlreadyGiven)return[e.ToRenderIfNoRatingAlreadyGiven];var n=e.MinRating;return null==n&&(n=1),t=e.ShowRatingLabel?at(1,null,e.LeftDescription,e.RightDescription,n.toString(),e.Length.toString(),this.xs(),e.Length,10,null):[r.createElement("div",{className:"office-form-question-rating-container"},this.xs())],e.ShouldAccessibleTextReadSelectedValue?[r.createElement("div",{"aria-labelledby":this.Ps},r.createElement("div",{id:this.Ps,className:"screenReaderVisible"},Object(tt.a)().GradingView_RatingAnswer_LabelFormat.format(this.Ms(),e.Length)),r.createElement("div",{"aria-hidden":"true",role:"presentation"},t))]:t},n.xs=function(){var t=this,e=this.props.MinRating;null==e&&(e=1);var n=s.range(e,this.props.Length+1),i=this.Ms(),o=Object(d.a)("office-form-question-rating-body","Center"===this.props.Layout?"justifyContentSpaceBetween":"");return r.createElement("div",{className:o},n.map((function(e){var o=i===e;return r.createElement("div",{className:"office-form-question-rating-item",key:e},r.createElement("label",{htmlFor:t.Ls(e)},e),r.createElement("input",{id:t.Ls(e),"aria-checked":o,"aria-label":""+e,"aria-posinset":e,"aria-setsize":n.length,type:"radio",disabled:t.props.Disabled,checked:o,onClick:function(){return t.props.onValueChange(e)}}))})))},n.Ls=function(t){return this.Ps+"-number-rating-"+t},n.Ms=function(){return parseInt(this.props.Value)},e}(ut.a),lt=n(26),ht={};function dt(){return ht[t="l"]||(ht[t]=1),t+ht[t]++;var t}var mt=n(20),bt=n(22);function vt(t){return r.createElement(gt,t)}var gt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ds=r.createRef(),e.Rs=e.Es(),e.As=0,e._s=!1,e.Us=!Object(f.a)(),e}Object(i.c)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t=this.props,e={className:"rateit margin-left office-form-theme-primary-foreground","data-rateit-icon":"","data-rateit-iconforempty":"","data-rateit-mode":"font","data-rateit-marginleft":this.Rs.MarginLeft,"data-rateit-marginright":this.Rs.MarginRight,"data-rateit-starwidth":this.Rs.FontSize,"data-rateit-max":t.Length,"data-rateit-value":t.Value,"data-rateit-step":1,"data-rateit-resetable":!1,"data-rateit-ispreset":!0,style:{fontSize:this.Rs.FontSize},ref:"rateit",key:"rateit"},n=r.createElement("div",e,this.$s());return t.ShowRatingLabel?at(0,this.Ds,t.LeftDescription,t.RightDescription,t.LeftDescriptionTitle,t.RightDescriptionTitle,n,t.Length,10,this.Bs):[r.createElement("div",{className:"office-form-question-rating-container",key:"container",ref:this.Ds},n)]},n.componentWillMount=function(){this.Bs=dt(),this.qs=this.qs.bind(this)},n.componentDidMount=function(){var t=this;this.Qs=Object(st.a)(),this.Qs.then((function(){t.Us||(t.Us=!0,t.forceUpdate()),t.zs()})),window.addEventListener("resize",this.qs),this.Hs(null)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.qs)},n.componentDidUpdate=function(t){this.Hs(t)},n.$s=function(){if(!this.Us)return mt.a.Resolve("IRatingStarsFactory").createRatingStar({NumStar:this.props.Length,Config:this.Rs})},n.Hs=function(t){var e=this;this.Vs()?this.forceUpdate():this.Qs.then((function(){return e.Gs(t)}))},n.Vs=function(){var t=this.Ds.current;if(t&&t.clientWidth>0){this.As=t.clientWidth;var e=this.Es();if(!s.isEqual(e,this.Rs))return this.Rs=e,this._s=!0,!0}return!1},n.zs=function(){var t=this,e=this.props,n=$(lt.findDOMNode(this.refs.rateit));n.rateit(),n.on("rated",(function(){return e.onValueChange(n.rateit("value"))})),n.on("over",(function(e,n){return t.Ws(n)}));var r=n.find(".rateit-range");if(r&&e.Options&&e.Options.HTMLPropsForInnerElement)for(var i in r.removeAttr("aria-label"),e.Options.HTMLPropsForInnerElement)r.attr(i,e.Options.HTMLPropsForInnerElement[i]);if(r){var o=r.attr("aria-labelledby");o&&(o=Object(d.a)(o,this.Bs),r.attr("aria-labelledby",o))}},n.qs=function(){var t=this;this.Js||(this.Js=window.setTimeout((function(){t.Js=null,t.Vs()&&t.forceUpdate()}),100))},n.Gs=function(t){var e=$(lt.findDOMNode(this.refs.rateit));if(!this._s&&t&&this.props.Disabled==t.Disabled&&this.props.Value===t.Value&&this.props.Length===t.Length||(this._s=!1,e.rateit("batchUpdate",{value:this.props.Value,max:this.props.Length,readonly:this.props.Disabled,starwidth:this.Rs.FontSize,marginleft:this.Rs.MarginLeft,marginright:this.Rs.MarginRight}),this.Ws()),this.props.NoTabFocus){var n=e.find(".rateit-range");n&&n.removeAttr("tabindex")}e.children(".rateit-range").removeAttr("aria-readonly"),this.Ks()},n.Ws=function(t){t=t||this.props.Value||0;var e=$(lt.findDOMNode(this.refs.rateit)),n=Object(tt.a)().Renderer_RatingControlText.format(t);e.attr("title",n)},n.Es=function(){var t={MarginLeft:4,MarginRight:4,FontSize:24};if(this.As>0)if(this.Xs()){t.MarginLeft=4;var e=this.props.Length,n=e>6?24:28;t.FontSize=n,t.MarginRight=e<4?27:(this.As-t.MarginLeft*(e+1)-n*e)/(e-1)}else if(this.As>380)return{MarginLeft:5,MarginRight:5,FontSize:this.props.Compact?24:28};return t},n.Ks=function(){this.props.Value>this.props.Length&&bt.a.logData({name:"DesignPage.Questions.RatingValueOutOfBounds",extraData:{operation:"RatingValueOutOfBounds"}})},n.Xs=function(){return this.props.IsMobile||Object(m.k)()},e}(ut.a),pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){t.prototype.componentWillMount.call(this),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[p.a.Schema.leftDescription,p.a.Schema.rightDescription])},n.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update),t.prototype.componentWillUnmount.call(this)},n.createReactNodes=function(){var t,e=this,n=this.props.Master,i=n.Question.Model,o=i.Length>3&&(this.props.IsMobile||Object(m.k)()),c=this.questionLocalizedItemMaster,s=c&&c.Model,u=s&&s.leftDescription||i.LeftDescription,a=s&&s.rightDescription||i.RightDescription;switch(i.RatingShape){case g.f.Number:return[(t={Disabled:this.props.Disabled,FormsProRTLeftDescription:void 0,FormsProRTRightDescription:void 0,HTMLAttributes:this.getElementProps(),key:"numberRating",Layout:o?"Center":"Left",LeftDescription:u,Length:i.Length,MinRating:i.MinRating,onValueChange:function(t){return n.Model.Answer=t},RightDescription:a,ShowRatingLabel:i.ShowRatingLabel,Value:n.Model.Answer},r.createElement(ft,t))];case g.f.Smiley:return[FormsPro.createSmileyRating({ContainerClass:o?"smiley-container-centeralign":null,Disabled:this.props.Disabled,Model:i,onValueChange:function(t){return n.Model.Answer=t},Value:n.Model.Answer})];case g.f.Star:default:Object(st.a)().then((function(){$.rateit.aria.ratingLabel=e.props.LocalizedStrings.RateItControl_AriaLabel,Object(m.i)()&&($.rateit.aria.ratingDescription=e.props.LocalizedStrings.RateItControl_AriaDescription)}));return[vt({Compact:!1,Disabled:this.props.Disabled,FormsProRTLeftDescription:void 0,FormsProRTRightDescription:void 0,IsMobile:!!this.props.IsMobile,key:"rating",Label:"",LeftDescription:u,LeftDescriptionTitle:this.props.LocalizedStrings.RatingDescriptionTitle.format(1),Length:i.Length,NoTabFocus:this.props.Disabled,onValueChange:function(t){return n.Model.Answer=t},Options:{HTMLPropsForInnerElement:this.getElementProps()},RightDescription:a,RightDescriptionTitle:this.props.LocalizedStrings.RatingDescriptionTitlePlural.format(i.Length),ShowRatingLabel:i.ShowRatingLabel,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:n.Model.Answer})]}},e}(T.a),Ot=n(73),jt=n(86),wt=g.e,St=!1,It=function(t){function e(e){var n=t.call(this,e)||this;return n.Ys="presentation",n.Zs=n.Zs.bind(n),n.tu=n.tu.bind(n),n.nu=n.nu.bind(n),n.iu=n.iu.bind(n),n.ou(),n}Object(i.c)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t,e,n=this,i=this.props.Master.Model,o=this.props.Master.Question,c=o.Model,s=this.do();if(this.props.PrintView)t=r.createElement("div",{className:"textbox-printview",key:"printView"},i.Answer);else{var u=void 0,a=void 0;if(c.IsMathQuiz&&!c.Multiline){var f=this.cu(!0),h=c.InputSwitcherDisabled||!c.IsMathInputDefault,d=this.props.Disabled||h?void 0:this.su(),v=void 0,g=void 0;if(i.AnswerEntity)v=i.AnswerEntity.IsMathAnswer,g=i.AnswerEntity.Answer;else v=!c.IsAnswerPlainText,g=Object(m.u)(i.Answer||"{}").Answer||"";if(v){var p=c.InputSwitcherDisabled?this.props.LocalizedStrings.TextField_EnterMathAnswer:this.props.LocalizedStrings.TextField_DefaultPlaceholder,O={onBlur:this.nu},w=r.createElement(b.a,{Disabled:this.props.Disabled,HTMLAttributes:O,key:"textmathquestion-mathfield",Location:"TextField.Response",onValueChange:this.Zs,Placeholder:p,QuestionId:c.Id,Value:g},d);a=r.createElement("div",{className:"office-form-response-question-math-container"},w,f)}else{var S=Object(I.a)({AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"design-question-math-plaintext-text",onBlur:this.nu},key:"textmathquestion-textfield",Label:void 0,MaxLength:Object(l.a)(),MinimalHeight:40,onValueChange:this.Zs,Options:{HTMLPropsForInnerElement:this.getElementProps({className:"design-question-math-plaintext-text"})},Placeholder:this.props.LocalizedStrings.TextField_DefaultPlaceholder||"",Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:g});a=r.createElement("div",{className:"office-form-response-question-math-textfield"},S,d,f)}e=r.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},a)}else{p=Object(j.c)((function(){return c.IsNumber?o.getNumberValidationErrorMessage(n.props.LocalizedStrings):c.Placeholder||n.props.LocalizedStrings.TextField_DefaultPlaceholder}),j.e);u=Object(I.a)({Disabled:this.props.Disabled,HTMLAttributes:{onBlur:this.nu,onFocus:this.iu},key:"textquestion-textfield",Label:void 0,MaxLength:Object(l.a)(),onValueChange:function(t){return i.Answer=t},Options:{HTMLPropsForInnerElement:this.getElementProps({className:"office-form-question-textbox"})},Placeholder:p,TextFieldType:c.Multiline?2:0,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:i.Answer});f=this.cu();e=r.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},u,f)}}return[t,e,this.Fs(),s]},n.su=function(){var t,e,n=this.props.Master.Question.Model,r="design-question-choice-to-math-button";return this.props.IsMobile&&(r=Object(d.a)(r,"isMobile")),n.IsAnswerPlainText?(t={"aria-label":this.props.LocalizedStrings.Designer_Question_Equation_Button,className:r,onClick:this.tu(),title:this.props.LocalizedStrings.Designer_Question_Equation_Button_Tooltip},e="NumberField"):(t={"aria-label":this.props.LocalizedStrings.Designer_Question_EquationToText_Button,className:r,onClick:this.tu(),title:this.props.LocalizedStrings.Designer_Question_EquationToText_Button_Tooltip},e="TextField"),Object(V.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:t,Icon:e,IconClassName:"design-question-choice-to-math-button-icon"})},n.tu=function(){var t=this;return function(e){var n=t.props.Master.Question.Model,r=t.props.Master.Model,i=Object(m.u)(r.Answer||"{}");n.IsAnswerPlainText=!n.IsAnswerPlainText;var o={Answer:i.Answer,IsMath:!n.IsAnswerPlainText};r.Answer=JSON.stringify(o),Object(z.a)({eventName:n.IsAnswerPlainText?"DesignPage.Quiz.SwitchMathToTextInput":"DesignPage.Quiz.SwitchTextToMathInput",eventType:"engagement_event",extraData:{location:"TextField.Response",questionId:n.Id}}),t.forceUpdate()}},n.ou=function(){var t=this.props.Master.Question.Model,e=this.props.Master;if(t.IsMathQuiz){if(e.Model.Answer){var n=Object(m.u)(e.Model.Answer||"{}");if(void 0!==n.IsMath)return void(t.IsAnswerPlainText=!n.IsMath)}t.IsAnswerPlainText=!t.IsMathInputDefault}else t.IsAnswerPlainText=!0},n.Zs=function(t){var e=this.props.Master.Model,n={Answer:t,IsMath:!this.props.Master.Question.Model.IsAnswerPlainText};e.Answer=JSON.stringify(n)},n.nu=function(){var t=this.props.Master.Model,e=this.props.Master.Question;if(e.Model.IsNumber){var n=t.Answer;e.verify(n)!==wt.Success||e.Model.IsMathQuiz||Object(j.c)((function(){return t.Answer=Object(Ot.a)(n)}),j.e)}},n.iu=function(){this.props.Master.Model.ShowPhishingFormWarning=!0,St||(St=!0,Object(z.a)({eventName:"ResponsePage.Phshing.Warning",eventType:"engagement_event"}))},n.do=function(){var t=this.props.Master.Model,e=this.props.Master.Question,n=e.verify(t.Answer);if(t.Answer&&n!==wt.Success){var r;switch(n){case wt.NumberValidationError:case wt.RegExValidationError:r=e.getNumberValidationErrorMessage();break;case wt.MathLengthError:r=this.props.LocalizedStrings.Math_Answer_LengthLimit_Message;break;default:return}return Object(w.a)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:r})}},n.cu=function(t){var n=this.props.Master,o=this.props.Master.Question,c=o.Model;if(this.props.ShowQuizResult&&!c.Multiline&&c.IsQuiz){var s=e.isAnswerCorrect(n);if(null!==s&&(s||this.props.IsMobile)){var u=t?"student-feedback-view-short-text-math-correctness-icon-container":"student-feedback-view-short-text-correctness-icon-container";this.props.IsMobile&&(u=Object(d.a)(u,"isMobile"));var a,f=s?this.props.LocalizedStrings.Quiz_CorrectAnswer:this.props.LocalizedStrings.Quiz_WrongAnswer,l={HTMLAttributes:{className:Object(d.a)("student-feedback-view-short-text-correctness-icon forms-icon-size14x14",s?"image-button-answerkey":"image-button-checked-wrong-answer"),title:f},IconName:s?"CheckMark":"Cancel"},v=n.Model.Answer;if(a=v,!v||Object(h.a)(v))a=c.Placeholder||this.props.LocalizedStrings.TextField_DefaultPlaceholder;else if(o.Model.IsMathQuiz){var g=Object(m.u)(v||"{}");a=g.IsMath?Object(b.c)({Formula:null==g.Answer?v:g.Answer}):null==g.Answer?v:g.Answer}var p={"aria-hidden":!0,className:"student-feedback-view-short-text-hidden-text-to-position-correctness-icon",role:this.Ys};return r.createElement("div",{className:u},r.createElement("span",Object(i.a)({},p),a),Object(y.b)(l))}}},e.isAnswerCorrect=function(t){var e=t.Model;return null!=e.QuizResult?e.QuizResult.IsAnswerCorrect:new jt.a(t.Question.Model).areAnyAnswersDefined()?t.Question.isCorrectAnswer(e.Answer):null},n.Fs=function(){var t=this.props.Master.Question.Model,e=this.props.Master.Model.QuizResult;if(this.uu()){var n=null!=e?e:t,i=new jt.a(n);if(i.areAnyAnswersDefined()){var o,c=i.getAnswers();if(c.some((function(t){return t.isMath}))){for(var u=[],a=0,f=c;a<f.length;a++){var l=f[a];if(l.isMath){var h=Object(b.c)({Formula:l.answer});u.push(r.createElement("div",{className:"correct-answer-list-formula-element"},h))}else u.push(l.answer);u.push(this.props.LocalizedStrings.VariousLocations_ItemList_Separator)}u.pop(),o=r.createElement("div",{className:"correct-answer-list-formula-container"},u)}else o=s.map(c,(function(t){return t.answer})).join(this.props.LocalizedStrings.VariousLocations_ItemList_Separator);var d={HTMLAttributes:{"aria-hidden":!0,className:"office-form-right-answerkey various-short-text-correct-answer-list-correctness-icon",role:this.Ys},IconName:""};return r.createElement("div",{className:"various-short-text-correct-answer-list",key:"answerList"},Object(y.b)(d),r.createElement("b",null,this.props.LocalizedStrings.VariousLocations_CorrectAnswerList_Label," "),o)}}},n.uu=function(){var t=this.props.Master.Model,e=this.props.Master.Question.Model,n=this.props.Master.Model.QuizResult;return!(e.Multiline||!e.IsQuiz)&&(!(!this.props.ShowDesignInfo&&null==n)&&((null==n||!n.IsAnswerCorrect)&&!(null==n&&this.props.Master.Question.isCorrectAnswer(t.Answer))))},e}(T.a);function Ft(t){var e,n=t.Master.Question.Model.Type;switch(n){case"Question.Choice":e=P;break;case"Question.TextField":e=It;break;case"Question.Rating":e=pt;break;case"Question.Ranking":e=ct;break;case"Question.NPS":e=rt;break;case"Question.MatrixChoiceGroup":e=Z;break;case"Question.FileUpload":e=K;break;case"Question.DateTime":return function(t){return r.createElement(o.a,null,r.createElement(c,Object(i.a)({},t)))}(t)}if(e)return r.createElement(e,t);throw Error('Type "'+n+'" has not been found.')}n.d(e,"a",(function(){return Ft}))},function(t,e,n){"use strict";var r=n(2),i=n(0),o=n(9),c=n(27),s=n(21),u=n(32),a=n(17),f=n(8),l=n(16),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return n.render=function(){var t,e=this.props.Ignorable?Object(f.a)(this.props.ClassName,"optional-cell"):this.props.ClassName;return t=Object(o.b)("FromsSpinnerControl")?"common-spinner-circle":"loading-spinner-animation",i.createElement("div",{className:e},i.createElement("div",{className:t}),this.au())},n.au=function(){if(this.props.LoadingDescription)return i.createElement("div",{className:"loading-control-description",role:"status"},this.props.LoadingDescription)},e}(l.a),d=n(117);n.d(e,"a",(function(){return m}));var m=function(t){function e(e){var n=t.call(this,e)||this;return n.state={ImageLoadStatus:0,RetryCount:0},n.fu=n.fu.bind(n),n.lu=n.lu.bind(n),n.du=n.du.bind(n),n}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=Object(s.f)().Schema;this.props.ImageInfoMaster.observe(this.du,[t.AltText,t.ResourceId,t.ResourceUrl])},n.componentWillUnmount=function(){this.mu&&window.clearTimeout(this.mu),this.props.ImageInfoMaster.unobserve(this.du)},n.render=function(){var t,n;this.props.FullFilled?(t="100%",n="auto"):(t=this.props.ImageWidth||Object(c.h)(),n=this.props.ImageHeight||Object(c.g)());var r,o,s=this.state.RetryCount,u=this.props.ImageInfoMaster.Model,a=u.ResourceUrl;2===this.state.ImageLoadStatus&&s>0&&(a+="?"+s),this.bu()?o=e.createSpinner():1===this.state.ImageLoadStatus&&(r="visiable");var f=u.AltText||"";return i.createElement("div",{className:"office-form-title-image-box"},i.createElement("img",{alt:f,className:r,height:n,onError:this.lu,onLoad:this.fu,src:a,title:f,width:t}),o,i.createElement(d.a,null,this.props.ImageInfoMaster.Model.AltText))},n.bu=function(){var t=this.props.ImageInfoMaster.Model,e=this.props.ImageSettingMaster.Model;return 1!==this.state.ImageLoadStatus||t.ResourceId!==e.TargetResourceId||t.ImageProcessingStatus!==u.b.Idle},e.createSpinner=function(){var t;if(Object(o.b)("FromsSpinnerControl")){t=i.createElement(h,Object(r.a)({},{ClassName:"designPage-question-titleLoadImage-spinner",Ignorable:!1}))}else t=i.createElement("div",{className:"spinner-tile-animation"});return i.createElement("div",{className:"image-spinner"},t)},n.fu=function(){Object(a.a)({eventName:"Image.ImageOnLoad.Success",eventType:"engagement_event",extraData:{imageType:this.props.ImageType,location:"1"}}),this.setState({ImageLoadStatus:1})},n.lu=function(){var t=this,e=this.state.RetryCount;e<3?this.mu=window.setTimeout((function(){return t.setState({RetryCount:++e})}),1e3):(Object(a.a)({eventName:"Image.ImageOnLoad.Failure",eventType:"engagement_event",extraData:{imageSrc:this.props.ImageInfoMaster.Model.ResourceUrl,imageType:this.props.ImageType,location:"1"}}),this.setState({ImageLoadStatus:2}))},n.du=function(){this.forceUpdate()},e}(l.a)},function(t,e,n){"use strict";var r=n(2),i=n(0),o=n(3),c=n(11),s=n(9),u=n(77),a=n(8),f=n(10),l=n(31),h=n(38),d=i.lazy((function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,n.e(1).then(n.bind(null,157))];case 1:return[2,{default:t.sent().TitleOverflowMenu}]}}))}))}));var m=n(7),b=n(16);n.d(e,"a",(function(){return v}));var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vu=i.createRef(),e.ve=400,e.ge=function(){var t=[];t.push({content:e.props.Title}),t.push({content:"\n"}),t.push({content:e.props.SubTitle});var n={chunks:t,title:""},r={uiLang:Object(c.f)()||navigator.language};Object(l.b)().getImmersiveReaderToken().then((function(t){t&&ImmersiveReader&&ImmersiveReader.launchAsync(t,null,n,r)}))},e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){Object(u.a)($(this.vu.current))},n.componentDidUpdate=function(){Object(u.a)($(this.vu.current))},n.render=function(){var t=o.extend({},this.props.HTMLAttributes);return t.className=Object(a.a)(t.className,"office-form-title-container"),i.createElement("div",Object(r.a)({},t),this.Ie(),this.pu(),"Bottom"===this.props.MediaLayout?this.props.children:void 0,this.Ou())},n.Ie=function(t){var e,n="office-form-title-box";return"Bottom"!==this.props.MediaLayout&&(n=n+" "+this.props.MediaLayout.toLowerCase(),e=this.props.children),i.createElement("div",{className:n},e,this.ju())},n.ju=function(){var t=this,e=o.extend({},this.props.HTMLPropsForInnerElement);return e.className=Object(a.a)("office-form-title",e.className,"heading-"+(this.props.Heading||1),2===this.props.Heading&&"office-form-theme-secondary-color",!this.props.Title&&"empty-title"),Object(m.c)((function(){return i.createElement("div",Object(r.a)({},e),i.createElement("span",null,t.props.Title),t.Te(),e.children)}),m.e)},n.Ou=function(){return Object(s.b)("ImmersiveReaderMobileToggle")?this.props.Heading>1?null:(t={ImmersiveReaderToggleProps:Object(r.a)({},this.props.ImmersiveReaderToggleProps),IsMobile:this.props.IsMobile},i.createElement(h.a,null,i.createElement(d,Object(r.a)({},t)))):null;var t},n.Te=function(){var t;return!Object(f.h)()&&Object(s.b)("ImmersiveReaderInForms")&&(null===(t=this.props.ImmersiveReaderToggleProps)||void 0===t?void 0:t.ShouldShowImmersiveReaderButtons)?i.createElement("button",{className:"immersive-reader-button","data-locale":Object(c.f)()||navigator.language,onClick:o.debounce(this.ge,this.ve,!0)}):null},n.pu=function(){var t=this;return this.props.SubTitle?Object(m.c)((function(){return i.createElement("div",{className:"office-form-subtitle heading-"+(t.props.Heading||1),ref:t.vu},i.createElement("span",null,t.props.SubTitle))}),m.e):void 0},e}(b.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2),i=n(0),o=n(3),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wu=i.createRef(),e}Object(r.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.props.LazyRendering&&(this.wu.current&&console.log(this.wu.current),window.setTimeout((function(){return t.setState({Mounted:!0})})))},n.render=function(){var t=o.clone(this.props.HTMLAttributes||{});switch(this.props.Role){case"Alert":t.role="alert";break;case"Log":t.role="log",t["aria-live"]=t["aria-live"]||"polite",t["aria-relevant"]=t["aria-relevant"]||"additions text";break;case"Marquee":t.role="marquee";break;case"Status":t.role="status"}return this.props.LazyRendering&&!this.state.Mounted?(t["aria-label"]=void 0,t.children=null,t.ref=this.wu,i.createElement("div",Object(r.a)({},t))):i.createElement("div",Object(r.a)({},t),this.props.children)},e}(n(16).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(4),o=n(1),c=n(12),s=n(74),u={BackgroundColor:o.a.string({IsLocalField:!0}),BackgroundImage:o.a.string({IsLocalField:!0}),Name:o.a.string(),PrimaryColor:o.a.string({IsLocalField:!0}),SecondaryColor:o.a.string({IsLocalField:!0}),Thumbnail:o.a.string({IsLocalField:!0})},a=function(t){function e(e){var n=t.call(this,e)||this;if(e.MasterTreeReady){var r=c.a.Schema;e.MasterTreeReady.then((function(){return n.Form.fieldsReady([r.Theme])})).then((function(){return n.Form.ensureFieldsReady([r.PrimaryCustomizedThemeColor,r.SecondaryCustomizedThemeColor,r.TertiaryCustomizedThemeColor,r.Background])})).done((function(){return n.Su()}))}return n}Object(r.c)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent},enumerable:!0,configurable:!0}),n.isCustomized=function(){return this.Model.Name===s.a},n.getCustomizedTheme=function(){var t=this.Form.Model;return{BackgroundColor:t.TertiaryCustomizedThemeColor||s.b.BackgroundColor,BackgroundImage:t.Background.ResourceUrl,Name:s.a,PrimaryColor:t.PrimaryCustomizedThemeColor||s.b.PrimaryColor,SecondaryColor:t.SecondaryCustomizedThemeColor||s.b.SecondaryColor,Thumbnail:null}},n.Su=function(){var t=this;this.addRule({Name:"calculate theme basing on name",onChange:function(e){e.BeingDeleted||t.Iu()}});var e=c.a.Schema;this.Form.observe((function(){return t.Iu()}),[e.PrimaryCustomizedThemeColor,e.SecondaryCustomizedThemeColor,e.TertiaryCustomizedThemeColor,e.Background.ResourceUrl]),this.Iu()},n.Iu=function(){var t=this,e=this.Model.Name;e===s.a?this.setData(this.getCustomizedTheme()):Object(s.c)(e).done((function(e){return t.setData(e)}))},e}(i.a.createObjectMasterClass("FormTheme",u))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3),i=function(){function t(){}return t.tagNames=["strong","em","u","sup","sub","a"],t.openingTags=r.map(t.tagNames,(function(t){return"<"+t+">"})),t.closingTags=r.map(t.tagNames,(function(t){return"</"+t+">"})),t.encodedOpeningTags=r.map(t.tagNames,(function(t){return"&lt;"+t+"&gt;"})),t.encodedClosingTags=r.map(t.tagNames,(function(t){return"&lt;/"+t+"&gt;"})),t}();function o(t){return function(t){var e=document.createElement("span");return e.innerHTML=t,t=e.innerHTML}(function(t){var e=r.escape(t);return i.tagNames.forEach((function(t,n){e=e.replaceAll(i.encodedOpeningTags[n],i.openingTags[n]).replaceAll(i.encodedClosingTags[n],i.closingTags[n])})),e}(t))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return f}));var r=n(11),i=n(9),o=n(5),c=n(15),s=n(28),u=n(56),a=function(){function t(){}var e=t.prototype;return e.getFormApiToken=function(){return Object(u.b)()},e.handleAuthForContentPage=function(t){},e.handleAuthForAddinPage=function(){},e.hasUserLoggedIn=function(){return!!Object(o.a)().userInfo.UserId},e.isValid=function(){return Object(i.b)("CookieAuth")},e.redirectToLogin=function(){var t=encodeURIComponent(window.location.href),e=Object(o.a)().userInfo.IsMsa,n="Response"===Object(r.n)(),i=Object(o.a)().signInLink;return!e||n?i=Object(c.d)(i,"state",t):(i=Object(o.a)().signInLinkMsa,i=Object(c.d)(i,"redirecturl",t)),Object(s.f)(i),$.Deferred().promise()},e.refreshToken=function(){return Object(u.d)()},e.signIn=function(){return this.redirectToLogin()},e.signOut=function(){return Object(s.c)(Object(o.a)().signOutLink).then((function(){return $.Deferred().promise()}))},t}();function f(t){var e;if(t){var n=encodeURIComponent(t);e=window.location.origin+"/?redirecturl="+n+"#Login=True"}else e=window.location.origin+"#Login=True";Object(s.f)(e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(11),i=n(108),o=n(6);function c(t){var e=Object(o.a)(),n="";if(t)if(t.correlationId){var c=t;c.innerCode&&(n=Object(i.a)(""+c.innerCode)||e.Error_Message_Default.format(c.innerCode))}else{switch(t.name){case"LoginIECrossZoneError":n=e.Error_Message_Client_LoginIECrossZoneError.format(window.location.origin,Object(r.b)());break;case"ThirdPartyCookieBlockedError":n=e.Error_Message_Client_ThirdPartyCookieError.format(Object(r.b)());break;case"AuthNoStorageError":n=e.Error_Message_Client_AuthNoStorageError;break;case"AADAcquireTokenMfaCheckError":n=e.Error_Message_705;break;case"TeamSiteNoGroupError":n=e.Error_Message_Client_TeamSiteNoGroupError}}return n}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(20);function i(){return r.a.Resolve("IThirdPartyDateTimePicker")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(0),o=n(11),c=n(14),s=n(16),u="https://go.microsoft.com/fwlink/?linkid=866263",a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r.c)(e,t),e.prototype.render=function(){var t=u;this.props.ForceUseCommercialTermsLink?t=function(){if(Object(o.x)())return"https://portal.office.com/account/#subscriptions";if(Object(o.w)())return"https://portal.office365.us/account/#subscriptions";if(Object(o.v)())return"https://portal.apps.mil/account/#subscriptions";return"http://go.microsoft.com/fwlink/p/?LinkId=2083423"}():this.props.FormMaster&&(t=function(t){if(t.SyncContext!==c.a.AdminPhishingReviewForm&&(t.SyncContext===c.a.SharedTimeForm||t.Model.Settings.IsAnonymous||t.Model.Settings.NotRecordIdentity))return u;return"http://go.microsoft.com/fwlink/p/?LinkId=2083423"}(this.props.FormMaster));var e={href:t,target:"_blank"};return i.createElement("a",Object(r.a)({},e),this.props.LocalizedStrings.TermsLink)},e}(s.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(2),i=n(0),o=n(26),c=n(3),s=n(8),u=n(16),a=n(24);function f(t){return i.createElement(l,Object(r.a)({},t))}var l=function(t){function e(n){var r=t.call(this,n)||this;r.Fu=c.uniqueId(e.name),r.yu=r.Fu+"_placeholder",r.Nu=i.createRef(),r.Eo=r.Eo.bind(r),r.ds=r.ds.bind(r);var o=r.ku(),s=c.findIndex(o,(function(t){return t.Value===r.props.Value}));return r.Tu=s<0?void 0:o[s].Key,r.state={Expanded:!1},r}Object(r.c)(e,t);var n=e.prototype;return n.componentWillUpdate=function(t,n){var r=e.GetSelectOptions(t),i=c.findIndex(r,(function(e){return e.Value===t.Value}));this.Tu=i<0?void 0:r[i].Key},n.componentDidUpdate=function(){if(this.Cu(),this.state.Expanded){this.Pu();var t=this.refs[this.Tu];if(t){var e=o.findDOMNode(t);e&&e.focus()}}},n.Pu=function(){var t=document.getElementById(this.Fu),e=window.getComputedStyle(t),n=t.offsetWidth,r=o.findDOMNode(this.refs.menu);(this.props.AllowWrap||r.offsetWidth<n)&&(r.style.width=n+"px"),r.style.top=t.offsetHeight-parseInt(e.borderTopWidth)+"px",r.style.left="-"+e.borderLeftWidth},n.render=function(){var t=this,e=c.extend({},this.props.HTMLAttributes),n=Object(s.f)(e,{"aria-describedby":this.yu,"aria-expanded":this.state.Expanded,"aria-label":e["aria-label"]||this.props.Label||this.props.Placeholder,className:"select-control",id:this.Fu,onBlur:this.Eo,onClick:e.disabled?void 0:function(){return t.xu()},onKeyDown:this.ds,ref:this.Nu,role:"combobox",tabIndex:e.disabled?-1:0});return i.createElement("div",Object(r.a)({},n),this.Mu(),this.Lu())},e.GetSelectOptions=function(t){var e=t.SelectOptions;if(e)return e;var n=t.SelectOptionGroups;return c.flatten(n.map((function(t){return t.SelectOptions})))},n.ku=function(){return e.GetSelectOptions(this.props)},n.Du=function(){return!!this.Ru()},n.Ru=function(){return this.props.SelectOptionGroups},n.Mu=function(){var t,e=this,n=this.ku(),r=c.findIndex(n,(function(t){return void 0===e.Tu?t.Value===e.props.Value:t.Key===e.Tu}));r>=0&&(t=this.props.DisplayValue?this.props.Value:n[r].DisplayContent||n[r].DisplayName),t||(t=this.props.Placeholder||"");var o=this.Tu?"select-placeholder-text":"select-placeholder-text default",s=this.state.Expanded?"off":"polite",u=this.props.PlaceholderIcon&&i.createElement("div",{className:"select-placeholder-icon"},i.createElement(a.a,{IconName:this.props.PlaceholderIcon}));return i.createElement("div",{className:"select-placeholder"},u,i.createElement("span",{"aria-live":s,id:this.yu,className:o,role:"textbox","aria-label":this.Eu(n[r])},t),this.Au())},n.Eu=function(t){return this.props.DisplayValue&&this.props.Value?this.props.Value.toString():t&&t.DisplayName?t.DisplayName:this.props.Placeholder||""},n.Au=function(){var t={HTMLAttributes:{className:"select-placeholder-arrow forms-icon-size14x14"},IconName:this.state.Expanded?"ChevronUp":"ChevronDown"};return i.createElement(a.a,Object(r.a)({},t))},n.Lu=function(){var t=this;if(this.state.Expanded){var e={className:"select-option-menu-container",ref:"menu",onWheel:function(e){e.preventDefault();var n=e.deltaY,r=o.findDOMNode(t.refs.menu),i=r.scrollTop+n;if(n>=0){var c=r.scrollHeight-r.clientHeight;r.scrollTop=Math.min(i,c)}else r.scrollTop=Math.max(i,0)},role:"listbox"};return i.createElement("ul",Object(r.a)({},e),this._u())}},n._u=function(){var t=this;return this.Du()?this.Ru().map((function(e,n){return t.Uu(e,n)})):this.$u(this.ku())},n.Uu=function(t,e){var n=!(!t.SelectOptions.length||!t.DisplayName)&&i.createElement("h5",{className:"select-group-header office-form-theme-primary-color",key:"group_header"+e},t.DisplayName);return i.createElement(i.Fragment,{key:"group_"+e},n,this.$u(t.SelectOptions))},n.$u=function(t){var e=this;return t.map((function(t){return e.Bu(t)}))},n.Bu=function(t){var e=this,n=t.Key===this.Tu,c={"aria-selected":n,"aria-disabled":t.Disabled,className:this.props.AllowWrap?"select-option-nocheck":"select-option",tabIndex:n?0:-1,key:t.Key,ref:t.Key&&t.Key.toString(),role:"option"};t.AriaLabel&&(c["aria-label"]=t.AriaLabel),t.Disabled?c.className=Object(s.a)(c.className,"disabled"):c.onClick=function(n){o.findDOMNode(e).focus(),e.Tu&&e.Tu===t.Key||e.props.onValueChange(t.Value),e.setState({Expanded:!1}),n.stopPropagation()};var u,f="select-option-state forms-icon-size14x14";this.props.PlaceholderIcon&&(f=Object(s.a)(f,"hasPlaceholderIcon")),this.props.AllowWrap||(u=i.createElement(a.a,{HTMLAttributes:{className:f},IconName:"CheckMark"})),n&&(c.className=Object(s.a)(c.className,"selected"));var l=t.DisplayContent;return l||(l=i.createElement("span",null,t.DisplayName)),i.createElement("li",Object(r.a)({},c),i.createElement("div",{className:"select-option-content"},u,l))},n.Eo=function(t){var e=o.findDOMNode(this),n=Object(s.d)(t);e.contains(n)||this.setState({Expanded:!1})},n.ds=function(t){var e=this;switch(t.stopPropagation(),t.keyCode){case 32:this.setState({Expanded:!0}),t.preventDefault();break;case 13:this.xu(!0),t.preventDefault();break;case 9:this.state.Expanded&&(this.setState({Expanded:!1},(function(){e.Nu.current&&e.Nu.current.focus()})),t.preventDefault());break;case 27:this.state.Expanded&&this.setState({Expanded:!1},(function(){e.Nu.current&&e.Nu.current.focus()})),t.preventDefault();break;case 37:case 39:this.state.Expanded||(37===t.keyCode?this.qu():this.Qu()),t.preventDefault();break;case 38:case 40:t.altKey?this.setState({Expanded:!this.state.Expanded}):38===t.keyCode?this.qu():this.Qu(),t.preventDefault()}},n.qu=function(){for(var t=this,e=this.ku(),n=c.findIndex(e,(function(e){return e.Key===t.Tu}));n>0;){var r=e[n-1];if(!r.Disabled){this.props.onValueChange(r.Value);break}n--}},n.Qu=function(){for(var t=this,e=this.ku(),n=c.findIndex(e,(function(e){return e.Key===t.Tu}));n<e.length-1;){var r=e[n+1];if(!r.Disabled){this.props.onValueChange(r.Value);break}n++}},n.xu=function(t){var e=this.ku();this.state.Expanded?o.findDOMNode(this).focus():t&&void 0===this.Tu&&e[0]&&this.props.onValueChange(e[0].Value);this.setState({Expanded:!this.state.Expanded})},n.Cu=function(){if(this.state.Expanded){var t=$(o.findDOMNode(this.refs.menu)),e=t.find(".select-option.selected");Object(s.h)(e,t)}},n.focus=function(){o.findDOMNode(this).focus()},e}(u.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2),i=n(0),o=n(3);function c(t){return i.createElement(s,Object(r.a)({},t))}var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return n.zu=function(){var t=this.props.content;return(o.isUndefined(this.props.trim)||this.props.trim)&&(t=t.trim()),t.split("\n")},n.render=function(){var t=this.zu();return i.createElement("span",null,t.map((function(e,n){var r=n!==t.length-1?i.createElement("br",null):void 0;return i.createElement("span",null,e,r)})))},e}(n(16).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r,i=n(31);function o(t){return(r&&"rejected"!==r.state()||(r=Object(i.b)().getOD4BToken()),r).then(t).then((function(t){return t}),(function(e){return e&&e.response&&401===e.response.statusCode?(r&&"pending"===r.state()||(r=Object(i.b)().getOD4BToken()),r).then(t):e}))}FormsPro.sendRequestWithToken=o},function(t,e,n){"use strict";var r=n(2),i=n(0),o=n(27),c=n(5),s=n(8),u=n(21),a=n(12),f=n(32),l=n(40),h=n(57),d=n(25),m=(n(7),n(16)),b=n(120),v=n(119),g=n(77),p=n(93),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vu=i.createRef(),e}Object(r.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.rr=function(){return t.forceUpdate()};var e=a.a.Schema;this.props.Form.observe(this.rr,[e.Title,e.Description,e.LogoInfo])},n.componentDidMount=function(){Object(g.a)($(this.vu.current))},n.componentWillUnmount=function(){this.props.Form.unobserve(this.rr)},n.render=function(){var t,e,n=this.props.Form,r=n.Model,o=r.LogoInfo;if(r.Logo&&r.Logo.ResourceUrl&&o.TargetResourceId){var c=n.getImageMaster(a.a.Schema.Logo),u=n.getImageSettingsMaster(a.a.Schema.LogoInfo);t=i.createElement("div",{className:"logo-image-container old"},i.createElement(p.a,{Image:c,ImageSettings:u,ImageType:"Logo"}),Object(p.b)(c.Model))}r.Description&&!this.props.IsSmallSize&&(e=i.createElement("div",{className:"office-form-subtitle heading-1",ref:this.vu},r.Description));var f=Object(s.a)("__title__ office-form-title-container office-form-form-title",!this.props.IsReadOnlyOnMobile&&"office-form-theme-primary-background",this.props.IsSmallSize&&"small-size");return i.createElement("div",{className:f},i.createElement("div",{className:"office-form-logo-title"},t,i.createElement("div",{className:"office-form-title heading-1"},i.createElement("span",{role:"heading","aria-level":1},r.Title))),e)},e}(m.a);n.d(e,"a",(function(){return w}));var j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.rr=function(){return t.forceUpdate()};var e=a.a.Schema;this.props.Form.observe(this.rr,[e.Title,e.Description]);var n=this.props.Form.getImageSettingsMaster(a.a.Schema.LogoInfo),r=Object(u.g)().Schema;n.observe(this.rr,[r.NaturalWidth,r.NaturalHeight]);var i=this.props.Form.getImageMaster(a.a.Schema.Logo),o=Object(u.f)().Schema;i.observe(this.rr,[o.ImageProcessingStatus,o.UploadParameters])},n.componentWillUnmount=function(){this.props.Form.unobserve(this.rr),this.props.Form.getImageSettingsMaster(a.a.Schema.LogoInfo).unobserve(this.rr),this.props.Form.getImageMaster(a.a.Schema.Logo).unobserve(this.rr)},n.render=function(){var t,e,n,o,c=this.props.Form,u=c.Model,l={className:Object(s.a)("__title__ office-form-form-title",!this.props.IsReadOnlyOnMobile&&"office-form-theme-primary-background",this.props.IsSmallSize&&"small-size",this.props.IsSlimTitle&&"slim-size")},d="Left",m=c.getImageMaster(a.a.Schema.Logo),g=c.getImageSettingsMaster(a.a.Schema.LogoInfo),p=m.Model;if(!p.ErrorType&&(p.ImageProcessingStatus!==f.b.Idle||Object(f.d)(p))){var O=this.kr(g);d=O.ImageLayout,t=i.createElement(v.a,{ImageWidth:O.Width,ImageHeight:O.Height,ImageInfoMaster:m,ImageSettingMaster:g,ImageType:"Logo"})}var j=this.props.LocaleId;return j&&(e=(o=h.a.getFormResourceMaster(j,this.props.Form)).Model.title||"",n=o.Model.subtitle||""),e=e||u.Title,n=this.props.IsSlimTitle||this.props.IsSmallSize?"":n||u.Description,i.createElement(b.a,{HTMLAttributes:l,HTMLPropsForInnerElement:{"aria-level":1,role:"heading"},MediaLayout:d,SubTitle:n,Title:e,ImmersiveReaderToggleProps:Object(r.a)({},this.props.ImmersiveReaderToggleProps),IsMobile:this.props.IsMobile},t)},n.kr=function(t){if(t.Model.NaturalWidth){var e=t.calcLogoLayout({isMobile:this.props.IsMobile,isSlimSize:this.props.IsSlimTitle,isSmallSize:this.props.IsSmallSize});return{Height:e.ActualHeight,ImageLayout:e.Layout===l.a.Vertical?"Top":"Left",Width:e.ActualWidth}}return{Height:Object(o.h)(),ImageLayout:"Left",Width:Object(o.g)()}},e}(m.a);function w(t){return Object(d.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")&&Object(c.a)().userInfo.IsMsa?i.createElement(O,Object(r.a)({},t)):i.createElement(j,Object(r.a)({},t))}},function(t,e,n){(function(e,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var r;r=function(){"use strict";function t(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=0,o=void 0,c=void 0,s=function(t,e){m[i]=t,m[i+1]=e,2===(i+=2)&&(c?c(b):j())},u="undefined"!=typeof window?window:void 0,a=u||{},f=a.MutationObserver||a.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(b,1)}}var m=new Array(1e3);function b(){for(var t=0;t<i;t+=2)(0,m[t])(m[t+1]),m[t]=void 0,m[t+1]=void 0;i=0}var v,g,p,O,j=void 0;function w(t,e){var n=this,r=new this.constructor(F);void 0===r[I]&&D(r);var i=n._state;if(i){var o=arguments[i-1];s((function(){return M(i,r,o,n._result)}))}else P(n,r,t,e);return r}function S(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(F);return N(e,t),e}l?j=function(){return e.nextTick(b)}:f?(g=0,p=new f(b),O=document.createTextNode(""),p.observe(O,{characterData:!0}),j=function(){O.data=g=++g%2}):h?((v=new MessageChannel).port1.onmessage=b,j=function(){return v.port2.postMessage(0)}):j=void 0===u?function(){try{var t=Function("return this")().require("vertx");return void 0!==(o=t.runOnLoop||t.runOnContext)?function(){o(b)}:d()}catch(t){return d()}}():d();var I=Math.random().toString(36).substring(2);function F(){}function y(e,n,r){n.constructor===e.constructor&&r===w&&n.constructor.resolve===S?function(t,e){1===e._state?T(t,e._result):2===e._state?C(t,e._result):P(e,void 0,(function(e){return N(t,e)}),(function(e){return C(t,e)}))}(e,n):void 0===r?T(e,n):t(r)?function(t,e,n){s((function(t){var r=!1,i=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,(function(n){r||(r=!0,e!==n?N(t,n):T(t,n))}),(function(e){r||(r=!0,C(t,e))}),t._label);!r&&i&&(r=!0,C(t,i))}),t)}(e,n,r):T(e,n)}function N(t,e){if(t===e)C(t,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(r=e),null===r||"object"!==i&&"function"!==i)T(t,e);else{var n=void 0;try{n=e.then}catch(e){return void C(t,e)}y(t,e,n)}var r,i}function k(t){t._onerror&&t._onerror(t._result),x(t)}function T(t,e){void 0===t._state&&(t._result=e,t._state=1,0!==t._subscribers.length&&s(x,t))}function C(t,e){void 0===t._state&&(t._state=2,t._result=e,s(k,t))}function P(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+1]=n,i[o+2]=r,0===o&&t._state&&s(x,t)}function x(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,i=void 0,o=t._result,c=0;c<e.length;c+=3)r=e[c],i=e[c+n],r?M(n,r,i,o):i(o);t._subscribers.length=0}}function M(e,n,r,i){var o=t(r),c=void 0,s=void 0,u=!0;if(o){try{c=r(i)}catch(t){u=!1,s=t}if(n===c)return void C(n,new TypeError("A promises callback cannot return that same promise."))}else c=i;void 0!==n._state||(o&&u?N(n,c):!1===u?C(n,s):1===e?T(n,c):2===e&&C(n,c))}var L=0;function D(t){t[I]=L++,t._state=void 0,t._result=void 0,t._subscribers=[]}var R=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(F),this.promise[I]||D(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&T(this.promise,this._result))):C(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;void 0===this._state&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===S){var i=void 0,o=void 0,c=!1;try{i=t.then}catch(t){c=!0,o=t}if(i===w&&void 0!==t._state)this._settledAt(t._state,e,t._result);else if("function"!=typeof i)this._remaining--,this._result[e]=t;else if(n===E){var s=new n(F);c?C(s,o):y(s,t,i),this._willSettleAt(s,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;void 0===r._state&&(this._remaining--,2===t?C(r,n):this._result[e]=n),0===this._remaining&&T(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;P(t,void 0,(function(t){return n._settledAt(1,e,t)}),(function(t){return n._settledAt(2,e,t)}))},t}(),E=function(){function e(t){this[I]=L++,this._result=this._state=void 0,this._subscribers=[],F!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){N(t,e)}),(function(e){C(t,e)}))}catch(e){C(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):this.then(e,e)},e}();return E.prototype.then=w,E.all=function(t){return new R(this,t).promise},E.race=function(t){var e=this;return r(t)?new e((function(n,r){for(var i=t.length,o=0;o<i;o++)e.resolve(t[o]).then(n,r)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))},E.resolve=S,E.reject=function(t){var e=new this(F);return C(e,t),e},E._setScheduler=function(t){c=t},E._setAsap=function(t){s=t},E._asap=s,E.polyfill=function(){var t=void 0;if(void 0!==n)t=n;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=E},E.Promise=E,E},t.exports=r()}).call(this,n(137),n(138))},function(t,e){var n;document.currentScript&&(n=document.currentScript.src);var r=function(){if(r.p)return r.p;var t,e,i;if(n)t=n.slice(0,n.split("?")[0].lastIndexOf("/")+1);else{var o=window.OfficeFormServerInfo||{},c=JSON.parse(decodeURIComponent(o.webSettings||"{}")).CdnEndPoint;o.isCdnEnabled&&c?t=c+"/scripts/dists/":(e=window.location.href,t=(i=/[?&]debug(=([^&#]*)|&|#|$)/.exec(e))&&i[2]&&"true"===decodeURIComponent(i[2].replace(/\+/g," "))?location.protocol+"//"+location.host+"/Scripts/dists/Forms/":location.protocol+"//"+location.host+"/Scripts/dists/")}return r.p=t,r.p};r.p=null,window.setPublicPath=r},function(t,e){window.replaceChunkSrc=function(t){return window.OfficeFormServerInfo&&window.OfficeFormServerInfo.ring&&!window.OfficeFormServerInfo.isCdnEnabled?t+"?ring="+window.OfficeFormServerInfo.ring:t}},function(t,e){"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var t=/function\s([^(]{1,})\(/.exec(this.toString());return t&&t.length>1?t[1].trim():""}})},function(t,e){String.prototype.format||(String.prototype.format=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}),String.prototype.trimEnd=function(t){for(var e=this.length;--e>=0&&!(t.indexOf(this.charAt(e))<0););return this.substr(0,e+1)},String.prototype.startsWith=function(t){if(null==t||0===t.length)return!0;return!(null==this||this.length<t.length)&&t===this.substr(0,t.length)},String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),e)}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:c}catch(t){r=c}}();var u,a=[],f=!1,l=-1;function h(){f&&u&&(f=!1,u.length?a=u.concat(a):l=-1,a.length&&d())}function d(){if(!f){var t=s(h);f=!0;for(var e=a.length;e;){for(u=a,a=[];++l<e;)u&&u[l].run();l=-1,e=a.length}u=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function b(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new m(t,e)),1!==a.length||f||s(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=b,i.addListener=b,i.once=b,i.off=b,i.removeListener=b,i.removeAllListeners=b,i.emit=b,i.prependListener=b,i.prependOnceListener=b,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){window.Forms={DesignPage:{},Experimentation:{},Models:{FormManager:{}},UX:{Utilities:{},Controls:{},Analysis:{},FileUpload:{},Intelligence:{},MultiLingual:{},RecycleBin:{},Renderer:{},Designer:{},DesignPage:{},FlexPane:{},FormDesignView:{},Addin:{},PowerPoint:{},TopViews:{},OutlookQuickPoll:{},Phishing:{},Teaching:{},TermsLink:{},TipBar:{},Admin:{},NPS:{}},Mru:{},FileUploadProcess:{},Grading:{},PrintTemplate:{},Common:{PageMethods:{}},Utilities:{FormId:{}},DataProvider:{},Experiment:{},Templates:{},Telemetry:{},Themes:{},FormsProRelated:{},MultilingualBatchRelated:{},MobileDesignPage:{},Routing:{},O365ReactShell:{},FormsCdn:{},Event:{QosEventNames:{},EngagementEventDeprecated:{},QosEventDeprecated:{}}},window.FormsPro={UX:{}}},function(t,e){function n(t){return $.expr.filters.visible(t)&&!$(t).parents().addBack().filter((function(){return"hidden"===$.css(this,"visibility")})).length}$.extend($.expr[":"],{focusable:function(t){
/*!
 * jQuery UI Core @VERSION
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
return function(t,e){var r,i,o,c=t.nodeName.toLowerCase();return"area"===c?(i=(r=t.parentNode).name,!(!t.href||!i||"map"!==r.nodeName.toLowerCase())&&(!!(o=$("img[usemap=#"+i+"]")[0])&&n(o))):(/input|select|textarea|button|object/.test(c)?!t.disabled:"a"===c&&t.href||e)&&n(t)}(t,!isNaN($.attr(t,"tabindex")))}})},function(t,e,n){"use strict";n.r(e);n(133),n(134);var r=/('[^']*'|"[^"]*")/g,i=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;function o(t,e){var n=t.toString();if(t<0)return n;if(e&&e>n.length)for(;e>n.length;)n="0"+n;return n}function c(t){return r.test(t)?t.substr(1,t.length-2):t}function s(t,e,n){var r={};return null==t||null==e||null==n?r:(e.split(i).forEach((function(e){var i;switch(e){case"d":case"dd":case"M":case"MM":case"h":case"hh":case"H":case"HH":case"m":case"mm":case"s":case"ss":i=2;case"yy":case"yyy":case"yyyy":i=i||4,r[e]=function(t,e){e=e||t.length;var n=t.match(/^\d+/g),r=n&&n[0];return r?r.length<=e?r:r.substr(0,e):""}(t,i),i=r[e].length;break;case"tt":i=0,t.toUpperCase().startsWith(n.DateTimeFormat.AMDesignator.toUpperCase())?i=n.DateTimeFormat.AMDesignator.length:t.toUpperCase().startsWith(n.DateTimeFormat.PMDesignator.toUpperCase())&&(i=n.DateTimeFormat.PMDesignator.length),r[e]=t.substr(0,i);break;default:i=0,e=c(e),t.startsWith(e)&&(i=e.length)}t=t.slice(i)})),t.length>0?{}:r)}function u(t,e){var n=parseInt(t.HH||t.H),r=parseInt(t.hh||t.h||t.time||12);if(isNaN(n)&&!isNaN(r)&&r>=1&&r<=12)if(null==t.tt)t.time||(n=0);else switch(t.tt.toUpperCase()){case e.DateTimeFormat.AMDesignator.toUpperCase():n=r%12;break;case e.DateTimeFormat.PMDesignator.toUpperCase():n=r%12+12}var i=parseInt(t.mm||t.m||t.time||0),o=parseInt(t.ss||t.s||0);return isNaN(n)||isNaN(i)?NaN:1e3*(60*(60*n+i)+o)}Date.prototype.toFormatString=function(t,e){var n=this;return null==n||null==t||null==e?null:t.split(i).map((function(t){switch(t){case"d":case"dd":return o(n.getDate(),t.length);case"ddd":return e.DateTimeFormat.AbbreviatedDayNames[n.getDay()];case"M":case"MM":return o(n.getMonth()+1,t.length);case"MMM":return e.DateTimeFormat.AbbreviatedMonthNames[n.getMonth()];case"yy":var r=n.getFullYear(),i=o(r,4);return r>e.Calendar.TwoDigitYearMax-100&&r<=e.Calendar.TwoDigitYearMax?i.slice(2):i;case"yyy":case"yyyy":case"yyyyy":return o(n.getFullYear(),t.length);case"H":case"HH":return o(n.getHours(),t.length);case"h":case"hh":return o((n.getHours()+11)%12+1,t.length);case"m":case"mm":return o(n.getMinutes(),t.length);case"s":case"ss":return o(n.getSeconds(),t.length);case"t":case"tt":var s=n.getHours()<12?e.DateTimeFormat.AMDesignator:e.DateTimeFormat.PMDesignator;return 1===t.length?s.charAt(0):s;default:return c(t)}})).join("")},Date.prototype.toDateShortString=function(t){return this.toFormatString(t.DateTimeFormat.ShortDatePattern,t)},Date.prototype.toTimeShortString=function(t){return this.toFormatString(t.DateTimeFormat.ShortTimePattern,t)};var a=n(5);Date.parseDate=function(t,e,n){var r=s(t,e,n),i=parseInt(r.yyyy||r.yyy),o=parseInt(r.yy);if(isNaN(i)&&!isNaN(o))if(o>=100)i=o;else{var c=Object(a.a)().cultureInfo.Calendar.TwoDigitYearMax%100;i=o<=c?Object(a.a)().cultureInfo.Calendar.TwoDigitYearMax-c+o:Object(a.a)().cultureInfo.Calendar.TwoDigitYearMax-c-100+o}var f=parseInt(r.MM||r.M),l=r.MMM;isNaN(f)&&l&&(f=n.DateTimeFormat.AbbreviatedMonthNames.indexOf(l)+1);var h=parseInt(r.dd||r.d),d=u(r,n);if(!(isNaN(i)||isNaN(f)||isNaN(h)||isNaN(d))){var m=new Date(i,f-1,h,0,0,0,d);if(m.getFullYear()===i&&m.getMonth()+1===f&&m.getDate()===h)return m}return null},Date.parseTime=function(t,e,n){var r=s(t,e,n);return r.time=!0,u(r,n)};n(135),n(136);n(132).polyfill();n(139);var f=n(9),l=n(72),h=n(2),d=n(76),m=n(67),b=n(62),v=n(3),g=n(41);function p(){if(window.performance&&window.performance.getEntriesByType){for(var t=function(){for(var t=[],e=window.performance.getEntriesByType("navigation"),n=0,r=e;n<r.length;n++){var i=r[n],o=O(i);o.redirectStart=Math.round(i.redirectStart),o.redirectEnd=Math.round(i.redirectEnd),o.domainLookupEnd=Math.round(i.domainLookupEnd),o.secureConnectionStart=Math.round(i.secureConnectionStart),o.connectEnd=Math.round(i.connectEnd),o.type=i.type,o.initiatorType=i.initiatorType,o.domComplete=Math.round(i.domComplete),o.domContentLoadedEventStart=Math.round(i.domContentLoadedEventStart),o.domContentLoadedEventEnd=Math.round(i.domContentLoadedEventEnd),o.domInteractive=Math.round(i.domInteractive),o.duration=Math.round(i.duration),t.push(o)}return t}(),e=0,n=window.performance.getEntriesByType("resource");e<n.length;e++){var r=n[e];r&&r.name&&(/(basics|design|response).+\.js/.test(r.name.toLowerCase())&&t.push(O(r)))}return t}}function O(t){return{connectStart:Math.round(t.connectStart),decodedBodySize:t.decodedBodySize||-1,domainLookupStart:Math.round(t.domainLookupStart),encodedBodySize:t.encodedBodySize||-1,fetchStart:Math.round(t.fetchStart),name:(e=t.name,e.substring(e.lastIndexOf("/")+1,e.indexOf("?")>0?e.indexOf("?"):e.length)),requestStart:Math.round(t.requestStart),responseEnd:Math.round(t.responseEnd),responseStart:Math.round(t.responseStart),transferSize:t.transferSize||-1};var e}var j,w={};function S(t,e){w[t]=e}!function(t){t.FP_CreateFormMaster="forms.boot.create.fm",t.FP_ParseFormResponse="forms.boot.parse.rf",t.FP_RenderResponseForm="forms.boot.render.rf",t.FP_ParseResourceString="forms.boot.parse.rs"}(j||(j={}));var I=window.performance;function F(t){I&&I.mark&&I.mark(t)}function y(t,e){I&&I.measure&&I.measure(t,e)}var N=n(17),k=n(56),T=n(46),C=n(15),P=n(28),x=n(96),M=function(t){function e(e,n,r,i){var o=t.call(this,window.FormPrefetchCache.formCache)||this;return o.formMaster=e,o.eventName=n,o.Hu=r,o.Vu=i,o.init(),o}Object(h.c)(e,t);var n=e.prototype;return n.onPrefetchSucceed=function(){var t=this;this.Gu(),setTimeout((function(){F("forms.boot.parse.rf.start"),t.updateFormModel(),y(j.FP_ParseFormResponse,"forms.boot.parse.rf.start"),t.prefetchDeferred.resolve()}),0),this.Wu(!0,null)},n.updateFormModel=function(){var t=this.cache.data,e="object"==typeof t?t:JSON.parse(t);if(this.Vu){var n=this.Hu.Resolve("IIncrementalQuestionLoader");n.initialize(e,this.formMaster),e=n.getFormForFirstRender()}this.formMaster.Synchronizer.onSourceDataReceived(e)},n.onPrefetchFaied=function(){var t=this;this.Gu(),this.Vu&&this.Hu.Resolve("IIncrementalQuestionLoader").initialize(null,this.formMaster);var e=this.cache.error;this.Wu(!1,e),e&&e.response&&401===e.response.statusCode?Object(k.b)().done((function(n){null==n?t.Ju(e):t.fallBackToNormalBoot()})):this.fallBackToNormalBoot()},n.fallBackToNormalBoot=function(){var t=this;this.formMaster.ensureReadyToResponse().done((function(){return t.prefetchDeferred.resolve()})).fail((function(e){return t.prefetchDeferred.reject(e)}))},n.Ju=function(t){var e=this;if(Object(k.c)(t))Object(k.d)().done((function(){Object(T.e)((function(){return e.fallBackToNormalBoot()}),P.d)}));else{var n=Object(b.b)(t);if(!Object(b.e)(n)){switch(n.innerCode){case 10001:Object(f.b)("PrefetchFormAuthFix")?this.fallBackToNormalBoot():this.prefetchDeferred.reject(n);break;case 15003:return void this.prefetchDeferred.reject(n)}this.fallBackToNormalBoot()}}},n.Wu=function(t,e){var n,r=e&&Object(m.b)(Object(a.a)().prefetchFormUrl,e);n=t?"Success":Object(d.b)(r)?"ExpectedFailure":"Failure";var i=Object(f.b)("PrefetchFormAuthFix"),o="";!t&&i&&(o=Object(C.c)());var c={correlationId:this.cache.logData.correlationId,duration:this.cache.logData.duration,eventName:this.eventName+"."+n,eventType:"qos_event",extraData:{flightQueries:o,prefetch:!0,prefetchAuthFix:i}};r&&(c.extraData.ServiceError=r),Object(N.a)(c)},n.Gu=function(){this.cache.errorCallback&&(this.cache.errorCallback=null),this.cache.successCallback&&(this.cache.successCallback=null)},e}(x.a);var L=n(6),D=function(t){function e(){var e=t.call(this,window.FormPrefetchCache.stringCache)||this;return e.init(),e}Object(h.c)(e,t);var n=e.prototype;return n.onPrefetchSucceed=function(){try{F("forms.boot.parse.rs.start"),Object(L.d)(JSON.parse(this.cache.data).d),y(j.FP_ParseResourceString,"forms.boot.parse.rs.start"),this.prefetchDeferred.resolve(Object(L.a)())}catch(t){this.fallBackToNormalBoot()}},n.onPrefetchFaied=function(){this.fallBackToNormalBoot()},n.fallBackToNormalBoot=function(){var t=this;Object(L.c)().done((function(){return t.prefetchDeferred.resolve()})).fail((function(e){return t.prefetchDeferred.reject(e)}))},e}(x.a),R=n(10),E=n(110),A=n(11),_=n(33);var U,B,q,Q=function(t){function e(e){var n=t.call(this,e)||this;return n.name="AuthNoStorageError",n}return Object(h.c)(e,t),e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e}(Error)),z=function(){function t(){}var e=t.prototype;return e.getFormApiToken=function(){return Object(k.b)(U)},e.handleAuthForContentPage=function(t){var e=this;return B||(B=H().then((function(n){if(n.HasUserSignedIn)G();else if(t)return e.redirectToLogin()}))),B.promise()},e.handleAuthForAddinPage=function(){return B||(B=H().then((function(t){if(!t.HasUserSignedIn)return $.Deferred().reject().promise();G()}))),B},e.hasUserLoggedIn=function(){return!!U.getCachedUser()},e.isValid=function(){return!Object(f.b)("CookieAuth")},e.redirectToLogin=function(){if(U.login(),q)return q;throw Error("redirectForAuthContextLogin not called.")},e.refreshToken=function(){},e.signIn=function(){return this.redirectToLogin()},e.signOut=function(){return U.config.postLogoutRedirectUri=window.location.href,U.logOut(),$.Deferred().resolve().promise()},t}();function H(){var t=Object(_.d)(),e=Object(_.e)();if(t||Object(N.a)({eventName:"Auth.LocalStorageNotSupported",eventType:"engagement_event",extraData:{supportsSessionStorage:e}}),!t&&!e)return $.Deferred().reject(new Q("local storage or session storage can't be used")).promise();var n,r=(n=Object(_.a)().getItem("officeforms.userAccountNameKey"))&&JSON.parse(n),i="response_mode=form_post&msafed=0";r&&(i+="&username="+(r=JSON.stringify(r))),Object(f.b)("WorkAroundImplicitGrantBreak")&&(i+="&response_type=id_token+token&resource="+Object(A.i)());var o=window.location.origin,c={cacheLocation:t?"localStorage":"sessionStorage",clientId:Object(A.a)(),displayCall:V,extraQueryParameter:i,instance:Object(A.b)(),postLogoutRedirectUri:o,redirectUri:o,tenant:""};Object(f.b)("WorkAroundImplicitGrantBreak")&&v.extend(c,{loginResource:Object(A.i)()});var s=new AuthenticationContext(c),u=s.isCallback(window.location.hash);if(s.handleWindowCallback(),u)return $.Deferred().promise();if(!(U=s).getCachedUser())return $.Deferred().resolve({HasUserSignedIn:!1,UserSignedInBefore:!1}).promise();var a=$.Deferred();return U.acquireToken(Object(A.a)(),(function(t,e){var n=!t&&!!e;n?"live.com"===U.getCachedUser().profile.idp&&(U.clearCache(),n=!1,Object(N.a)({eventName:"UnexpectedLiveId",eventType:"error_event"})):U.clearCache();a.resolve({HasUserSignedIn:n,UserSignedInBefore:!0})})),a.promise()}function V(t){if(q)throw Error("login in progress.");Object(P.f)(t);var e=$.Deferred();q=e.promise();window.setTimeout((function(){return e.reject()}),3e3)}function G(){var t=U.getCachedUser();if(t){var e=t.profile.oid,n=Object(a.a)();n.userInfo={DisplayName:t.profile.name,Email:t.profile.unique_name,GivenName:t.profile.given_name||t.profile.name&&t.profile.name.split(" ")[0],IsMsa:!1,PUID:e.replace(/-/g,"").substring(16),TenantId:t.profile.tid,Upn:t.profile.upn,UserId:e},Object(a.b)(n)}}var W=n(124),J=function(){function t(){}var e=t.prototype;return e.getFormApiToken=function(){return this.Ku().getFormApiToken()},e.handleAuthForContentPage=function(t){return this.Ku().handleAuthForContentPage(t)},e.handleAuthForAddinPage=function(){return this.Ku().handleAuthForAddinPage()},e.hasUserLoggedIn=function(){return this.Ku().hasUserLoggedIn()},e.isValid=function(){return this.Ku().isValid()},e.redirectToLogin=function(){return this.Ku().redirectToLogin()},e.refreshToken=function(){return this.Ku().refreshToken()},e.signIn=function(){return this.Ku().signIn()},e.signOut=function(){return this.Ku().signOut()},e.Ku=function(){return this.Xu||(Object(f.b)("CookieAuth")?this.Xu=new W.a:this.Xu=new z),this.Xu},t}(),K=function(){function t(t){this.Yu=null,this.Zu=t?t.concat():[new J]}var e=t.prototype;return e.signIn=function(){return this.ea().then((function(t){return t.signIn()}))},e.getFormApiToken=function(){return this.ea().then((function(t){return t.getFormApiToken()}))},e.handleAuthForContentPage=function(t){return this.ea().then((function(e){return e.handleAuthForContentPage(t)}))},e.handleAuthForAddinPage=function(){return this.ea().then((function(t){return t.handleAuthForAddinPage()}))},e.hasUserLoggedIn=function(){var t=this.na();return t&&t.hasUserLoggedIn()},e.redirectToLogin=function(){return this.ea().then((function(t){return t.redirectToLogin()}))},e.refreshToken=function(){return this.ea().then((function(t){return t.refreshToken()}))},e.signOut=function(){return this.ea().then((function(t){return t.signOut()}))},e.ea=function(){var t=this;if(this.Yu)return this.Yu;var e=function(n){var r=t.Zu[n];return r?$.when(r.isValid()).then((function(t){return t?r:e(n+1)})):$.Deferred().reject(new Error("No valid authenticator")).promise()};return this.Yu=e(0),this.Yu},e.na=function(){return this.Zu.filter((function(t){return t.isValid()}))[0]},t}(),X=function(){function t(t){var e=this;this.ra={},this.ia=t.then((function(t){e.oa=it(t)})),"pending"===this.ia.state()&&(this.ua=it(Object(a.a)().flights))}var e=t.prototype;return e.isEnabled=function(t){return this.aa(t)},e.isEnabledAsync=function(t){var e=this;if(!(t&&t in Z))throw Error("Checking uninitialized flight "+t+".");return this.ia.then((function(){return e.aa(t)}))},e.isEnabled_Deprecated=function(t){return this.aa(t)},e.aa=function(t){var e=tt[t];if("tenant"===e){if(!this.oa){if(Object(a.a)().useDebugVersionScript)throw Error('Checking flight "'+t+'" before ready.');rt(t)}e="environment"}switch(e){case"environment":if(t in this.ra)return this.ra[t];break;case"deprecated":this.oa||rt(t);break;default:throw Error("Checking uninitialized flight "+t+".")}var n=this.la(t);return"environment"===e&&(this.ra[t]=n),n},e.la=function(t){var e=this;if(et[t]&&et[t].some((function(t){return e.aa(t)})))return!1;if(nt[t]&&!nt[t].every((function(t){return e.aa(t)})))return!1;var n=t.toUpperCase(),r=function(){if(ot)return ot;var t={};if(!Object(A.s)()||Object(A.r)()){var e=Object(C.c)().fo;Array.isArray(e)&&(e=e[e.length-1]),e&&e.split(";").forEach((function(e){"!"!==e[0]?t[e.toUpperCase()]=!0:(e=e.substr(1).toUpperCase(),t[e]=!1)}))}return ot=t,t}();if(n in r)return r[n];var i=this.oa||this.ua;return t in i?i[t]:Z[t]},t}(),Y=function(){switch(Object(A.d)()){case"DevHost":return 1;case"Daily":case"Drill":case"Pilot":case"Trial":return 2;case"Weekly":case"Hotfix":case"ProDaily":return 3;case"Int":case"MSInt":return 4;case"WWProd":case"MSProd":case"ProTip":case"USGovProd":case"USDoDProd":case"USGovGccProd":default:return 5}}(),Z={},tt={},et={},nt={};function rt(t){var e=new Error('Checking flight "'+t+'" before ready.');Object(N.a)({eventName:"UnstableFlightChecking",eventType:"error_event",extraData:{flightName:t,flightType:tt[t],stack:e.stack}})}function it(t){var e={};return t&&t.split(";").forEach((function(t){"!"!==t[0]?e[t]=!0:(t=t.substr(1),e[t]=!1)})),e}var ot=null;function ct(t,e){Z[t]=e>=Y,tt[t]="environment"}function st(t,e){Z[t]=e>=Y,tt[t]="tenant"}function ut(t,e){Z[t]=e>=Y,tt[t]="deprecated"}var at=function(t,e){et[t]=e},ft=function(t,e){nt[t]=e};st("TestTenantFlight",5),ct("TestEnvironmentFlight",5),ct("TestEnvironmentFlight_Blocker",0),ut("TestDeprecatedFlight",0),ct("CookieAuth",0),ct("SubmitTimeDistributionInsight",0),ct("EnableNPSKeywordsInsight",0),ct("EnablePartialOrderInsight",0),ct("EnableResponseSentimentInsight",0),ut("EnableMsaContentValidation",0),st("ResponseInApp",4),st("MathIncorrectAnswerSuggestions",2),st("MathQuestionGeneration",2),ut("EnableOnlineExcelForMSA",0),st("DesignerFileUpload",2),st("ResponderFileUpload",5),st("EnableAnonymousUploadLink",0),ut("FormInsight",4),ut("PartialPut",1),ct("PPTContentAddinSSO",4),ut("MsaPreviewLabel",5),st("PrintForm",1),st("AssignmentsIFrameLimitParentHeaders",4),ut("EnableExperimentation",4),ct("FormInsightFeedbackV2",4),ut("EmailHrdFallback",4),ct("WordCloudMultipleRatio",4),ut("LogDownloadExcelErrorMessage",4),ut("DisableBrandingForMSA",0),st("EnableNonAnonymousForMSA",4),ut("MSAIntroductionForResponder",4),st("QuestionTagForIntelligence",0),ut("Question200Limit",4),ct("DataClassification",4),ut("EnableFormsProRoute",4),st("ExcelSurveyIntroductionDialog",4),st("TemplateSuggestionModelExp",4),st("OptionToOptionSuggestionExp",4),st("GetMeetingInfo",0),ct("DataClassificationRuntime",4),ct("GetShareInvitationKeyFromQuery",4),ct("LogShareInvitationKeyFromQuery",4),st("EditorOnContextMenuLog",4),st("SignalRConnectV2",4),st("BranchingExperiment",4),st("SuiteHeaderFPS",4),st("HistorySuggestion",4),st("IntelligenceUseMemoryCache",4),st("IntelligenceScenarioProcess",4),st("FormCustomizedMessage",4),st("TagTemplateSuggestionExp",4),st("EstimationTimeExp",0),st("FrontDoorOptionToOption",4),st("UnpinSharedForm",0),st("StrictAnalyzeTokenEdit",4),st("MSATemplateFPS",4),st("MobileEnablePreivew",0),ct("RemoveRuntimeWarningbarReportAbuse",4),ct("ShareAssistant",4),st("BlockRestrictUser",0),st("ImmersiveReaderInForms",4),st("ImmersiveReaderMobileToggle",4),st("ThemeTeachingCallout",4),ct("O365ShellSuiteHeader",4),ct("LeverageServerRingLogic",4),st("BaseProFRE",0),ct("MultiLingualMVP1",5),ct("FirstTimePhishingDetectionWarning",4),st("FormsProAvailableTeachingCallout",0),st("MenuItemForAddBranch",4),ct("DataIdeasUxState",4),ct("LinkifyEscape",4),st("SupportStreamVideo",4),st("XLUnsyncedDialog",4),st("AddUPNToAdminPhishingReviewPage",4),st("MobileScriptsPreload",4),st("MobilePrefetchResourceStrings",4),st("MobileUseIdFromQuery",4),st("RemovePreviewLabelForSurvey",0),st("PreferUserInfoFromAspx",4),st("AddBranchInSection",4),ct("WorkAroundImplicitGrantBreak",0),st("RetryTransientFailure",4),ct("UserFeatureSettings",0),ct("EnableUnblockRestrictedUserPage",4),st("QuizHistorySuggestion",4),st("YouTubeAdminControl",4),st("PersonalContextSuggestion",0),st("FromsSpinnerControl",4),ct("EnableEmailSharingFixForTeams",4),st("DisplayOptionSetting",0),st("ProgressBar",0),ct("IntelligenceCardAutoScroll",0),ct("CopyFormByAPI",4),st("QuickPollTeachingUIControl",4),st("ShowPeoplePicker",4),st("PermissionControlV2",4),st("RemoveBranchInNavi",4),st("AddBranchAndTeachUI",4),st("BranchingEntryPointInServer",4),ct("ResponseTimeEstimationStorage",4),st("QuickPollDisableEws",0),st("ChangeWithPaste",4),st("BingImageAdminControl",4),st("DisableCoauthorEditPermission",0),st("MobileResponseDetail",4),ct("FormsProEnable",0),ct("FormsPro",5),ft("FormsPro",["FormsProEnable"]),ct("ProRedirectInWeb",0),ct("PrefetchForm",0),ct("MobilePrefetchForm",0),ct("MobilePrefetchCommon",0),ct("PrefetchUserLicenseInfo",0),ft("PrefetchForm",["CookieAuth"]),ft("MobilePrefetchForm",["CookieAuth"]),ft("MobilePrefetchCommon",["CookieAuth"]),ft("PrefetchUserLicenseInfo",["CookieAuth"]),at("MobilePrefetchForm",["FormsProEnable"]),at("MobilePrefetchCommon",["FormsProEnable"]),ct("CustomizeFabric",3),ct("CustomizeBootstrap",3),ct("ReduceLibJsSize",3),ct("MobilePrefetchOtherJs",3),ct("PrefetchFormAuthFix",0),ft("PrefetchFormAuthFix",["PrefetchForm"]),ct("PrefetchFormInServer",3),ft("PrefetchFormInServer",["PrefetchForm"]),ct("FilterHashMapping",0),ct("FilterServerFlights",0),ct("IncrementalLoadForms",0),ft("IncrementalLoadForms",["PrefetchForm"]),ct("DelayLoadThirdPartyJs",0),ct("SplitBasicsJs",0),ft("TestTenantFlight",["TestEnvironmentFlight"]),at("TestTenantFlight",["TestEnvironmentFlight_Blocker"]),ft("SuiteHeaderFPS",["O365ShellSuiteHeader"]),ft("BaseProFRE",["ProRedirectInWeb"]);var lt=function(){function t(t){this.ha=$.Deferred(),t=t||{},this.ma=new K(t.authenticators),this.ba=new X(this.ha.promise()),t.addinAccessTokenGetter&&Object(E.b)(t.addinAccessTokenGetter)}var e=t.prototype;return Object.defineProperty(e,"AuthContext",{get:function(){return this.ma},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Flighting",{get:function(){return this.ba},enumerable:!0,configurable:!0}),e.setFlightsBasingOnAuth_Deprecated=function(t){this.ha.resolve(t)},Object.defineProperty(e,"RetryingRecoverableError",{get:function(){return this.va},set:function(t){this.va=t},enumerable:!0,configurable:!0}),t}(),ht=n(29),dt=n(34),mt=n(78),bt=function(){function t(){this.ne=null,this.ga=null}var e=t.prototype;return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},e.getMuid=function(){return this.ga},e.ensureMuid=function(){var e=this;if(null==this.ne)if(this.ne=$.Deferred(),this.ga=Object(R.d)("MUID"),null==this.ga){var n=new mt.a("Function.GetMuid");n.start(),t.loadMuid((function(){e.ga=Object(R.d)("MUID"),null!=e.ga?(e.ne.resolve(e.ga),n.end({resultType:"Success"})):(e.ne.reject(),n.end({resultType:navigator.cookieEnabled?"Failure":"ExpectedFailure"}))}))}else this.ne.resolve(this.ga);return this.ne.promise()},t.loadMuid=function(t){var e=Object(A.m)();if(e){var n=document.createElement("img");n.style.display="none",n.src=e+"/c.gif",n.hidden=!0,n["aria-hidden"]="true",n.onload=n.onerror=t}else t()},t.instance=null,t}(),vt=function(){function t(){this.Oa=[]}var e=t.prototype;return e.setFunctionToCall=function(t){var e=this;if(this.Wn!==t)if(this.Wn=t,t){var n=this.Oa;delete this.Oa,n&&n.length&&n.forEach((function(t){return e.Wn.apply(void 0,t)}))}else this.Oa=this.Oa||[]},Object.defineProperty(e,"queue",{get:function(){return this.Wn?this.Wn:this.wa},enumerable:!0,configurable:!0}),e.wa=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.Oa.push(t)},t}(),gt=n(30),pt=n(53),Ot=n(25),jt=n(7),wt=n(102);function St(){var t=Object(wt.a)();return"OneNoteUwp"===t||"PowerPointTaskpane"===t}function It(){switch(Object(A.d)()){case"Int":case"MSInt":return"Int";case"WWProd":case"USGovProd":case"MSProd":case"ProTip":return"Prod";default:return"DevEnv"}}function Ft(t){return isNaN(t)?"0":t.toString()}var yt=function(){function t(){this.Sa=Object(a.a)().serverSessionId||Object(gt.b)(),this.Ia="",this.Fa="",this.in=!1}var e=t.prototype;return e.logData=function(e){t.BUFFER.queue(e)},Object.defineProperty(e,"SessionId",{get:function(){return this.Sa},enumerable:!0,configurable:!0}),e.flush=function(t){this.in?AWTLogManager.flush(t):t()},e.initialize=function(){var e=this;bt.getInstance().ensureMuid(),this.ya=Object(A.k)().toUpperCase(),this.Na=function(){switch(Object(A.n)()){case"Design":return 0;case"Response":return 1;case"Analyze":return 3;case"TeamsConfig":return 4;default:return 2}}(),this.Ta=0,this.Ca=window.location.pathname.toLowerCase(),Object(A.q)()&&"OneNoteUwp"!==Object(wt.a)()&&Object(pt.c)().done((function(t){return e.Ta=t})).always((function(){var n={disableCookiesUsage:!0};switch(Object(A.d)()){case"USGovProd":n.collectorUri="https://tb.pipe.aria.microsoft.com/Collector/3.0";break;case"USDoDProd":n.collectorUri="https://pf.pipe.aria.microsoft.com/Collector/3.0"}var r=function(){switch(Object(A.d)()){case"Int":case"MSInt":return"79beea9c4fdb49a5adab4843729e1fa0-19b42cd4-5bd4-4bf8-8e49-05dc0f7f97f8-7484";case"WWProd":case"MSProd":case"ProTip":return Object(pt.f)()||Object(dt.c)()?"5f4ebf0f9a11474199e89f94bc7e2f50-61b8420a-22b1-4220-b531-4a4b96e4edb9-7406":Object(A.u)()?"d34df8693d35452c98f0e1cdfde6d6a8-44cd1abe-6b6d-4edc-a342-46ba159633a4-7645":Object(jt.c)((function(){return"2ddc7e5f54754fc68f3ae1c5b7f3eb20-1883aa8c-4c7b-42d1-b3d6-c9cdb5956783-7092"}),jt.e);case"USGovGccProd":return"aa96061debfd4ec7b9704f62060b4ca6-a498d428-fdba-43da-bc8b-4fe51865cb7f-7984";case"USGovProd":return"577e32a3275e48c5a639a92c9a8af033-4028cb75-b5f4-4ad0-835e-0e26d79ff209-6823";case"USDoDProd":return"291cebec6b9a4cbf9489bc8cf3a0cc50-06f4c682-bd49-4f88-a8c2-ac582180b7f9-7725";default:return"e132e188c609439ab47cd7b06511fc0a-433f81b3-fab9-415a-882a-ba9e2f91abea-6917"}}();AWTLogManager.initialize(r,n),e.in=!0,e.Pa=AWTLogManager.getLogger(r),t.BUFFER.setFunctionToCall(e.xa.bind(e))}))},t.enrichEngagementInfo=function(t){var e={},n={};t.properties&&(e=JSON.parse(t.properties)),v.extend(n,e,{IsMobileView:Object(R.k)()}),t.properties=JSON.stringify(n)},e.xa=function(e){"session_start"===e.eventType&&this.Ma(e),"engagement_event"===e.eventType&&Object(R.k)()&&t.enrichEngagementInfo(e),this.La(e)},e.Ma=function(t){if(t.properties){var e=JSON.parse(t.properties);e&&(this.Ia=e.DbId,this.Fa=e.DeviceId)}var n,r,i={BuildVersion:Object(a.a)().version,DbId:this.Ia,DeviceId:this.Fa,Flights:(n={},r=Object(Ot.a)().Flighting,n.PrefetchForm=r.isEnabled("PrefetchForm")&&(!Object(R.m)()||r.isEnabled("PrefetchFormAuthFix")),n.IsCdnEnabled=Object(a.a)().isCdnEnabled,n.PrefetchFormAuthFix=r.isEnabled("PrefetchFormAuthFix"),n.PrefetchFormInServer=r.isEnabled("PrefetchFormInServer"),n.MobilePrefetchForm=r.isEnabled("MobilePrefetchForm"),n.MobilePrefetchCommon=r.isEnabled("MobilePrefetchCommon"),n.MobilePrefetchResourceStrings=r.isEnabled("MobilePrefetchResourceStrings"),n.MobilePrefetchOtherJs=r.isEnabled("MobilePrefetchOtherJs"),n.FilterHashMapping=r.isEnabled("FilterHashMapping"),n.FilterServerFlights=r.isEnabled("FilterServerFlights"),n.PrefetchUserLicenseInfo=r.isEnabled("PrefetchUserLicenseInfo"),n.IsAFDEnabled=Object(a.a)().isAFDEnabled,n.IncrementalLoadForms=Object(f.c)(),n.DelayLoadThirdPartyJs=Object(f.a)(),n.SplitBasicsJs=r.isEnabled("SplitBasicsJs"),n),IsMobile:Object(R.k)(),JQueryLoaded:!!window.$,SessionRing:It(),SessionUrlPath:window.location.origin+window.location.pathname,UserAgent:navigator.userAgent},o=Object(wt.a)(),c=navigator.connection;o&&(i.Origin=o);var s=Object(ht.f)();s&&(i.StartPageRoute=s),c&&(i.Connection={downLink:c.downLink||-1,effectiveType:c.effectiveType||"unsupported",rtt:c.rtt||-1}),i.IsMobile&&(i.IsMobileView=Object(R.l)()),t.eventName=t.eventType,t.duration=0,t.properties=JSON.stringify(i),t.timeStamp=Object(g.b)()},e.La=function(t){var e=new AWTEventProperties;e.setName(t.eventType),e.setProperty("event_name",t.eventName),e.setProperty("event_correlation_id",t.eventCorrelationId),e.setProperty("duration",Ft(t.duration)),e.setProperty("timestamp",Ft(t.timeStamp)),e.setProperty("properties",t.properties),t.eventName&&t.eventName.indexOf("IntelligenceStatistic")>=0||t.withoutUserInfo?this.Da(e):this.Ra(e)},e.Da=function(t){St()||(t.setProperty("source_application",Object(jt.c)((function(){return"Office Forms BrowserApp"}),jt.e)),t.setProperty("user_role",this.Na),t.setProperty("user_type",this.Ta),t.setProperty("page_type",this.Ca),this.Pa.logEvent(t))},e.Ra=function(t){if(!St()){var e=Object(a.a)().userInfo.UserId,n=Object(a.a)().userInfo.TenantId,r=Object(dt.a)();if(r&&t.setProperty("form_id",r),t.setProperty("source_application",Object(jt.c)((function(){return"Office Forms BrowserApp"}),jt.e)),t.setProperty("user_id",e),t.setProperty("user_tenant_id",n),t.setProperty("user_role",this.Na),t.setProperty("user_type",this.Ta),t.setProperty("session_id",this.Sa),t.setProperty("page_type",this.Ca),t.setProperty("server_build_version",Object(a.a)().serverBuild),t.setProperty("server_dc",Object(a.a)().datacenter),t.setProperty("server_ring",Object(a.a)().ring),Object(a.a)()&&Object(a.a)().serverInfoFromPageHeaders&&(t.setProperty("server_instance",Object(a.a)().serverInfoFromPageHeaders.serverInstance),t.setProperty("routing_build",Object(a.a)().serverInfoFromPageHeaders.routingBuild),t.setProperty("routing_dc",Object(a.a)().serverInfoFromPageHeaders.routingDataCenter),t.setProperty("routing_instance",Object(a.a)().serverInfoFromPageHeaders.routingInstance)),n)if(n.toUpperCase()===this.ya){var i=Object(a.a)().userInfo.PUID;t.setProperty("UserInfo.Id",i),t.setProperty("UserInfo.IdType","MSAPUID")}else t.setProperty("UserInfo.Id",e),t.setProperty("UserInfo.IdType","UserObjectId"),t.setProperty("UserInfo.OMSTenantId",n);else e||t.setProperty("MUID",bt.getInstance().getMuid());this.Pa.logEvent(t)}},t.BUFFER=new vt,t}(),Nt=n(125),kt=n(58),Tt=function(){function t(){this.initialVisibility=document.visibilityState,this.initializeTime=new Date,this.Ea=this.Ea.bind(this),document.addEventListener("visibilitychange",this.Ea)}var e=t.prototype;return e.stop=function(){document.removeEventListener("visibilitychange",this.Ea)},e.Ea=function(){this.visiToggleTime=new Date},t}(),Ct={engagement_event:Lt,error_event:Lt,formspro_event:Lt,nav_perf_event:function(t){var e=Lt(t);t.extraData&&(!function(t){if(Dt){var e=0;"hidden"===Dt.initialVisibility?e=Dt.initializeTime.getTime():Dt.visiToggleTime&&(e=Dt.visiToggleTime.getTime());t.extraData.VisiToggled=e,Dt.stop(),Dt=null}}(t),e.properties=JSON.stringify(t.extraData));return e},qos_event:function(t){var e={duration:t.duration,eventCorrelationId:t.correlationId,eventName:(t.eventName||Pt[t.eventType]).replace(" ",""),eventType:t.eventType,properties:"",timeStamp:Object(g.b)()};t.extraData&&(e.properties=JSON.stringify(t.extraData));return e},session_start:function(t){return t.extraData={DbId:"",DeviceId:""},Lt(t)}},Pt={engagement_event:"no_EngagementName",error_event:"no_ErrorName",formspro_event:"formspro_event",nav_perf_event:"no_NavPerfName",qos_event:"no_QosName",session_start:"session_start"},xt=function(){function t(){}var e=t.prototype;return e.log=function(t){Mt(t,!1)},e.logWithoutUserInfo=function(t){Mt(t,!0)},e.logFormsProEvent=function(t){t.eventInfo.timeStamp=Date.now()-60*(new Date).getTimezoneOffset()*1e3;var e={eventName:t.type,eventType:"formspro_event",extraData:t.eventInfo};Object(kt.a)().logData(Lt(e))},e.logForTeamsTab=function(t){Object(ht.l)()&&(t?Object(d.a)(t)?microsoftTeams.appInitialization.notifySuccess():microsoftTeams.appInitialization.notifyFailure({message:Object(Nt.a)(t),reason:"Other"}):microsoftTeams.appInitialization.notifySuccess())},t}();function Mt(t,e){var n,r=Ct[t.eventType];r?n=r(t):n=Lt({eventName:"no_ErrorName",eventType:"error_event",extraData:{initData:t,message:"Unsupported event"}});Object(kt.a)().logData(v.extend(n,{withoutUserInfo:e}))}function Lt(t){var e={duration:0,eventCorrelationId:t.correlationId||Object(gt.b)(),eventName:(t.eventName||Pt[t.eventType]).replace(" ",""),eventType:t.eventType,properties:"",timeStamp:Object(g.b)()};return t.extraData&&(e.properties=JSON.stringify(t.extraData)),e}var Dt=new Tt,Rt=n(20);var Et=n(4),At=n(101),_t=function(){function t(t){this.Aa=[],this._a=!1,this.Ua=t}var e=t.prototype;return e.initialize=function(t,e){this.O=t,this.An=e,t&&!function(t){var e=function(t){return Et.a.convertFromSourceData(JSON.parse(t.settings),At.a.Schema)}(t);return t.allQuestions.length<4||e.ShuffleQuestionOrder}(t)&&(this.Aa=t.questions.sort((function(t,e){return t.order-e.order})),this.O.questions=this.$a(1))},e.getFormForFirstRender=function(){return this.O},e.getQuestionsForNextLoad=function(){var t=this.Ba()?this.Aa.length:1;return this.$a(t)},e.onFirstRenderCompleted=function(){this.Ba()},e.hasMore=function(){return this.Aa.length>0},e.Ba=function(){return!!this._a||!!this.qa()&&(this._a=!0,this.Ua.raiseBootComplete(),!0)},e.qa=function(){if(0===this.Aa.length||(t=document.getElementById("form-bottom-sentinel"),(e=t&&t.getBoundingClientRect())&&e.height+e.top>=window.innerHeight))return!0;var t,e,n=this.Qa();if(!n)return!1;if(function(t){if(t){var e=t.Model.Choices;return e&&e.length>0&&v.some(e,(function(t){return t.BranchInfo&&!(!t.BranchInfo.TargetQuestionId&&!t.BranchInfo.ToTheEnd)}))}}(n))return!0;var r=n.Model.BranchInfo;if(r.ToTheEnd)return!0;var i=this.za(r.TargetQuestionId)||this.Ha();return!this.Va(i)},e.Qa=function(){var t=this.An.FormElementManager.TopQuestionMasters;return t&&t.length>0&&t[t.length-1]},e.Va=function(t){var e=this.An.FormElementManager.SectionMasters;return!e||e.length<2||t&&t.order<e[1].Model.Order},e.za=function(t){return v.find(this.Aa,(function(e){return e.id===t}))},e.$a=function(t){return this.Aa.splice(0,Math.min(t,this.Aa.length))},e.Ha=function(){return this.Aa.length>0&&this.Aa[0]},t}();var Ut=n(21),$t=function(){function t(t){this.Ga=t,this.Wa=[],this.Ja=!1}var e=t.prototype;return e.initialize=function(t,e){this.Ga.initialize(t,e),this.An=e,this.Ja=!!t},e.isInitializedWithFormData=function(){return this.Ja},e.normalizeResponses=function(t){return this.Ka=t,this.An.normalizeResponses(t)},e.setQuizRenderer=function(t){this.Xa=t},e.getFormForFirstRender=function(){return this.Ga.getFormForFirstRender()},e.onFirstRenderCompleted=function(){var t=this;this.Ja&&setTimeout((function(){t.Ga.onFirstRenderCompleted(),t.Ya()}),0)},e.Ya=function(){var t=this,e=function(){var n=t.Ga.getQuestionsForNextLoad();n&&n.length>0&&(t.Za(n),setTimeout(e,0))};e()},e.tf=function(){var t=this,e=function(){t.Wa.length>0?(t.ef(t.Wa.shift()),Bt(e)):t.nf()};e()},e.Za=function(t){var e;(e=this.Wa).push.apply(e,t),this.tf()},e.nf=function(){var t=this;this.Ga.hasMore()||Bt((function(){return t.rf()}))},e.rf=function(){if(this.Ka&&this.Ka.length>0&&this.Xa){var t=this.An.normalizeResponses(this.Ka);this.Xa.updateWithResponse(t[t.length-1])}},e.ef=function(t){Et.a.Collection.itemsAddedInSource(this.An.Model.Questions,[Et.a.convertFromSourceData(t,Object(Ut.i)().Schema)])},t}();function Bt(t){window.requestAnimationFrame?requestAnimationFrame(t):setTimeout(t,17)}var qt=n(80),Qt=n(48),zt=function(){function t(t,e){this.serviceUrl=t,this.ownerServiceUrl=e,this.partialUpdateHttpMethod=Object(Ot.a)().Flighting.isEnabled_Deprecated("PartialPut")?"PUT":"PATCH"}var e=t.prototype;return t.getQueryParameters=function(t,e,n){if(!e)return t+"$expand=questions";var r="$select="+(e=v.union(["id"],e)).join(","),i={permissions:"permissions",questions:"questions($expand=choices)",permissionTokens:"permissionTokens"},o=e.map((function(t){return i[t]})).filter((function(t){return t}));return o.length&&(r+="&$expand="+o.join(",")),n&&(r+="&$filter="+n.name+"+"+n.operator+"+"+n.value),r&&t+r},e.getImmersiveReaderToken=function(){return this.sendRequest({method:"GET",qosEventName:"Decomposition.GetImmersiveReaderToken",requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=ImmersiveReader"}).then((function(t){return t||$.Deferred().reject(new Error("Failed to get ImmersiveReader token via GetTokenForResource")).promise()}))},e.getPrivacySettings=function(t,e){var n={};return t&&(n.ownerTenantId=t),e&&(n.currentUserTenantId=e),this.sendRequest({method:"GET",qosEventName:"Function.GetPrivacy",requestUri:this.getSurveyWebServiceUrl()+"privacy?"+$.param(n)})},e.reportAbuse=function(t){return this.sendRequest({data:t,method:"POST",qosEventName:"OnlineSafety.ReportAbuse",qosExtraData:{Category:t.Category},requestUri:this.getSurveyWebServiceUrl()+"contentvalidation/report"+window.location.search})},e.getRuntimeResponses=function(t,e){var n=e?"&$filter=responder+eq+'"+encodeURIComponent(e.replace(/\'/g,"''"))+"'":"",r=this.getSurveyWebOwnerServiceUrl();return this.sendRequest({qosEventName:"RuntimeResponses.Get",requestUri:r+"forms('"+t+"')/runtimeresponses?$expand=comments"+n})},e.getRuntimeResponse=function(t,e){var n=Object(C.c)(),r={};return n.GetResponseToken&&(r={GetResponseToken:n.GetResponseToken}),this.sendRequest({headers:r,qosEventName:"RuntimeResponse.Get",requestUri:this.getSurveyWebOwnerServiceUrl()+"light/forms('"+t+"')/runtimeresponses("+e+")?$expand=comments"})},e.submitFormResponse=function(t,e){var n=Object(Qt.a)(t),r="AAD";return null==n.OrgId?r="Unknown":n.OrgId.toLowerCase()===Object(A.k)()&&(r="MSA"),this.sendRequest({data:e,method:"POST",qosEventName:"Response.Submit",qosExtraData:{OwnerSource:r},requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responses"})},e.getToken=function(){return Object(Ot.a)().AuthContext.getFormApiToken()},e.getRuntimeForm=function(e,n){var r=this,i=this.getSurveyWebOwnerServiceUrl()+"light/runtimeForms('"+e+"')";return i+=t.getQueryParameters("?",n),new Promise((function(t,e){r.sendRequest({qosEventName:"ResponseForm.Get",requestUri:i}).then(t,e)}))},e.getResponseDetailRuntimeForm=function(e,n){var r=this,i=Object(C.c)();if(i.GetResponseToken&&i.rid){var o={GetResponseToken:i.GetResponseToken},c=this.getSurveyWebOwnerServiceUrl()+"light/responseDetailRuntimeForms('"+e+"')/"+i.rid;return c+=t.getQueryParameters("?",n),new Promise((function(t,e){r.sendRequest({headers:o,qosEventName:"QosEvent.ServiceEndpoints.Form.GetResponseDetailRuntimeForm",requestUri:c}).then(t,e)}))}return Promise.resolve(null)},e.getLocaleResource=function(t,e){var n=this.getMultilingualBaseUrl(t)+"/'"+e+"'";return this.sendRequest({headers:{ValidationToken:""},method:"GET",qosEventName:"Locale.Get",requestUri:n})},e.createUploadSession=function(t,e,n){var r=this.getSurveyWebOwnerServiceUrl()+"runtimeForms('"+t+"')/questions('"+e+"')/CreateUploadSession";return this.sendRequest({data:{value:n},method:"POST",qosEventName:"Question.CreateUploadSession",requestUri:r})},e.cancelOrDeleteUploadFile=function(t){return this.sendRequest({method:"DELETE",qosEventName:"FileUpload.CancelOrDeleteUploadFile",requestUri:t})},e.getUserInfo=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userInfo",method:"GET",qosEventName:"Function.GetUserInfo"})},e.getSharedForm=function(t){var e=this;return new Promise((function(n,r){e.sendRequest({body:'{"value" : "'+Object(C.c)().sharetoken+'"}',headers:{"Content-Type":"application/json;odata.metadata=minimal"},method:"GET",qosEventName:"SharedForm.Get",requestUri:e.getSurveyWebOwnerServiceUrl()+"GetSharedForm(formid='"+t+"',token='"+Object(C.c)().sharetoken+"')"}).then(n,r)}))},e.getDataClassificationLabelDetail=function(t,e){return this.if({method:"GET",qosEventName:"Function.GetDataClassificationLabelDetails",requestUri:this.getSurveyWebServiceUrl()+"/dataClassificationLabelInfo/"+t+"/"+encodeURIComponent(e)})},e.getMultilingualBaseUrl=function(t){return this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/localeResource"},e.getSurveyWebOwnerServiceUrl=function(){return this.ownerServiceUrl},e.getSurveyWebServiceUrl=function(){return this.serviceUrl},e.sendRequest=function(t,e){return this.sendRequestInner((function(t){return t&&t.value}),t,e)},e.sendRequestInner=function(t,e,n){var r=this;return this.getToken().then((function(t){return e.headers=$.extend(!0,e.headers,r.getCommonHeaders(t)),Object(m.a)(e,n).then(b.a,b.c)})).then(t)},e.getCommonHeaders=function(e){var n={__RequestVerificationToken:Object(a.a)().antiForgeryToken,Accept:"application/json",AnalyzerToken:Object(C.c)().AnalyzerToken,Authorization:e?"Bearer "+e:"",ContextParams:Object(C.c)().ctx,ValidationToken:Object(C.c)().vt},r=Object(C.b)().Token;return Object(f.b)("GetShareInvitationKeyFromQuery")?n.ShareInvitationKey=r||Object(C.c)().Token:n.ShareInvitationKey=r,n=v.extend({},n,t.customizedHeaders)},e.if=function(t,e){return t.headers=$.extend(!0,t.headers,this.getCommonHeaders("")),Object(m.a)(t,e).then(b.d,b.c)},t.customizedHeaders={},t}(),Ht=function(){function t(){}return t.prototype.getMixinFormApi=function(){return zt},t}(),Vt=n(1),Gt={Action:Vt.a.reference(),AllFormList:Vt.a.collectionOf(Vt.a.reference()),AllFormListLoadState:Vt.a.reference(),AllSharedFormList:Vt.a.collectionOf(Vt.a.reference()),Analysis:Vt.a.boolean(),BranchingElementId:Vt.a.string(),CdsInfoAvailableInUrl:Vt.a.boolean(),CdsList:Vt.a.reference(),CdsValidationMap:Vt.a.reference(),CopyFormId:Vt.a.string(),CriticalError:Vt.a.reference(),DataIdeas:Vt.a.boolean(),DefaultCdsId:Vt.a.string(),DefaultCdsInfoLoadState:Vt.a.reference(),DefaultCdsUrl:Vt.a.string(),DelegateInactiveUser:Vt.a.reference(),EnvironmentListLoadState:Vt.a.reference(),ErrorBarMessage:Vt.a.string(),ExperienceType:Vt.a.reference(),FlexPane:Vt.a.reference(),ForceDesktopView:Vt.a.boolean(),FormCollectionType:Vt.a.reference(),FormId:Vt.a.string(),FormList:Vt.a.collectionOf(Vt.a.reference()),FormListLoadState:Vt.a.reference(),FormMaster:Vt.a.reference(),FormsProBranchingData:Vt.a.string(),FormsProToken:Vt.a.string(),FormsTenantSettings:Vt.a.reference(),Grading:Vt.a.reference(),GroupMaster:Vt.a.reference(),GroupMruFormListLoadState:Vt.a.reference(),Host:Vt.a.string(),InfoBarMessageType:Vt.a.string(),IsDefaultCds:Vt.a.boolean(),LastUsedEnv:Vt.a.reference(),Locale:Vt.a.string(),MeetingInfo:Vt.a.reference(),pendingCalls:Vt.a.reference(),PlaceholderList:Vt.a.collectionOf(Vt.a.reference()),Preview:Vt.a.reference(),PreviousFlexPane:Vt.a.reference(),RecycleBin:Vt.a.collectionOf(Vt.a.reference()),RelativeScrolHeight:Vt.a.number(),Scenario:Vt.a.string(),SearchContent:Vt.a.string(),SectionElementId:Vt.a.string(),SelectedCdsId:Vt.a.string(),SelectedCdsRegion:Vt.a.string(),SelectedCdsUrl:Vt.a.string(),SelectedPortalForm:Vt.a.reference(),SenderList:Vt.a.reference(),SharedWithMeFormList:Vt.a.collectionOf(Vt.a.reference()),SharedWithMeFormListLoadState:Vt.a.reference(),SharingToken:Vt.a.string(),ShouldDisableAllClick:Vt.a.boolean(),ShowExcelSurveyIntroductionDialog:Vt.a.boolean(),ShowXLUnsyncedDialog:Vt.a.boolean(),Store:Vt.a.boolean(),TenantCountryCode:Vt.a.string(),Title:Vt.a.string(),Token:Vt.a.string(),TopView:Vt.a.reference(),ValidationChecked:Vt.a.reference(),XlWorkbookId:Vt.a.string()},Wt=function(t){function e(){var e=t.call(this)||this;return e.bulkEdit((function(){var t=e.Model;t.Analysis=!1,t.BranchingElementId=null,t.DataIdeas=!1,t.Store=!1,t.Grading=null,t.FormListLoadState="NotStarted",t.SharedWithMeFormListLoadState="NotStarted",t.GroupMruFormListLoadState="NotStarted",t.FormCollectionType="OwnedForms",t.MeetingInfo=null,t.SectionElementId=null,t.CopyFormId=null,t.SharingToken=null,t.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0}})),e}Object(h.c)(e,t);e.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e}(Et.a.createObjectMasterClass("DesignPageUxState",Gt)),Jt=n(12),Kt=n(85),Xt=n(18),Yt=n(32),Zt=n(40),te={Action:Vt.a.reference(),Analysis:Vt.a.boolean(),BottomView:Vt.a.reference(),CopyFormId:Vt.a.string(),CriticalError:Vt.a.reference(),ErrorBarMessage:Vt.a.string(),FormCollectionType:Vt.a.reference(),FormId:Vt.a.string(),FormList:Vt.a.collectionOf(Vt.a.reference()),FormListLoadState:Vt.a.reference(),FormMaster:Vt.a.reference(),FormsTenantSettings:Vt.a.reference(),InfoBarMessageType:Vt.a.string(),Locale:Vt.a.string(),QuestionId:Vt.a.string(),QuestionInDesign:Vt.a.reference(),SelectedPortalForm:Vt.a.reference(),SharingToken:Vt.a.string(),ShouldDisableAllClick:Vt.a.boolean(),ShowHeadBar:Vt.a.boolean(),SurveyResults:Vt.a.boolean(),Title:Vt.a.string(),Token:Vt.a.string()},ee=function(t){function e(){var e=t.call(this)||this;return e.bulkEdit((function(t){t.Action="None",t.BottomView="None",t.FormListLoadState="NotStarted",t.FormCollectionType="OwnedForms",t.ShowHeadBar=!0,t.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0}})),e.addRule({InterestedFields:[e.Schema.FormMaster],Name:"ClearRouting",onChange:function(t){e.Model.FormMaster||e.cf()}}),e.addRule({InterestedFields:[e.Schema.QuestionInDesign],Name:"DesignQuestion",onChange:function(t){e.Model.QuestionInDesign?e.Model.QuestionId=e.Model.QuestionInDesign.Model.Id:e.Model.QuestionId=null}}),e}Object(h.c)(e,t);var n=e.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},n.cf=function(){var t=this;this.bulkEdit((function(){var e=t.Model;e.FormMaster=void 0,e.Analysis=!1,e.BottomView="None",e.ShowHeadBar=!0,e.SurveyResults=!1}))},e}(Et.a.createObjectMasterClass("MobileDesignPageUxState",te));function ne(t){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=t.apply(this,e)||this;return r.initializing.resolve(),r}return Object(h.c)(e,t),e}(t)}var re=function(){function t(){}var e=t.prototype;return e.getMixinFormMaster=function(){return t.FormMasterClass||(t.FormMasterClass=ne(Jt.a)),t.FormMasterClass},e.getMixinImageInfoMaster=function(){return t.ImageInfoMasterClass||(t.ImageInfoMasterClass=ne(Yt.a)),t.ImageInfoMasterClass},e.getMixinQuestionMaster=function(){return t.QuestionMasterClass||(t.QuestionMasterClass=ne(Xt.d)),t.QuestionMasterClass},e.getMixinFormElementManager=function(){return t.FormElementManagerClass||(t.FormElementManagerClass=Kt.a),t.FormElementManagerClass},e.getMixinImageSettingsMaster=function(){return t.ImageSettingsMasterClass||(t.ImageSettingsMasterClass=Zt.b),t.ImageSettingsMasterClass},e.getMixinDesignPageUxStateMaster=function(){return Wt},e.getMobileDesignPageUxStateMaster=function(){return ee},e.getFileUploadConfirmDialog=function(){return null},t}(),ie=n(0),oe=n(16),ce=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sf="",e}Object(h.c)(e,t);var n=e.prototype;return n.render=function(){for(var t=[],e=0;e<this.props.NumStar;e++)t.push(ie.createElement("span",{style:{margin:this.uf()}},this.sf));return ie.createElement("div",{className:"rateit-empty",style:{fontSize:this.props.Config.FontSize}},t)},n.uf=function(){return"0px "+this.props.Config.MarginRight+"px 0px "+this.props.Config.MarginLeft+"px"},e}(oe.a),se=function(){function t(){}return t.prototype.createRatingStar=function(t){return ie.createElement(ce,Object(h.a)({},t))},t}(),ue=n(89),ae=function(){function t(){this.ff=new ue.a.CallbackManager,this._a=!1}var e=t.prototype;return e.addBootCompleteListener=function(t){this._a?t():this.ff.register(t)},e.raiseBootComplete=function(){this._a=!0,this.ff.trigger("BootCompleted"),this.ff.clear()},t}(),fe=function(){function t(){}t.prototype;return t.logData=function(t){Object(N.a)({eventName:t.name,eventType:"nav_perf_event",extraData:t.extraData})},t}();function le(){if(window.performance){var t=function(){if(!window.performance)return{};var t=window.performance.timing.navigationStart,e=Object(g.b)(),n=window.NavKeyPoints,r=w;return r.navigationStart=t,r.serverPageTime=n?n.ServerPageTime:0,r.pageLoaded=n?n.PageStartTime:0,r.basicJsLoaded=n?n.BasicJsLoadedTime:0,r.mainJsLoaded=n?n.MainJsLoadedTime:0,r.formRenderEnd=e,r.timeToContentReady=e-t,r.timeToSpin=r.pageLoaded-t,r.resourceTiming=p(),r.page=window.location.pathname,r}();t.measures=(e=[],I&&I.getEntriesByName&&Object.keys(j).forEach((function(t){var n=I.getEntriesByName(j[t]);n&&1===n.length&&e.push({duration:Math.round(n[0].duration),name:n[0].name,startTime:Math.round(n[0].startTime)})})),e),fe.logData({extraData:t,name:"Endpoint.ResponsePage"})}var e}var he=n(14);function de(t,e){var n=Date.now(),r=window.setTimeout((function(){Object(N.a)({eventName:"PageLoadingTimeout."+e,eventType:"engagement_event",extraData:{actualDuration:Date.now()-n,timeoutLimit:15e3}})}),15e3),i=t;i.always?i.always((function(){window.clearTimeout(r)})):t.then((function(){window.clearTimeout(r)}),(function(){window.clearTimeout(r)}))}var me=n(104);function be(t){return t.SyncContext===he.a.AdminPhishingReviewForm}var ve=function(){function t(){}var e=t.prototype;return e.createAdminPhishingReviewNavBar=function(t,e){return be(t)?Object(me.a)({FormMaster:t,SetErrorStateCallback:e}):null},e.createPhishingWarningPage=function(t,e){return Object(dt.c)()&&!e&&!be(t)&&t.SyncContext===he.a.ResponseTimeForm&&(1===t.Model.OnlineSafetyLevel||128===t.Model.OnlineSafetyLevel||129===t.Model.OnlineSafetyLevel)?Object(me.b)({}):null},t}(),ge=n(26),pe=n(88),Oe=n(42);function je(){if(!Object(Oe.d)())return $.Deferred().reject();var t=$.Deferred(),e=!Object(Oe.a)();e&&function(){Object(Oe.e)(!0),Object(Oe.f)(!1);var t=function(){var t=we;Object(f.b)("CookieAuth")&&(t+="cookieAuth.");return t+Object(gt.b)()}(),e={client_id:Object(A.a)(),msafed:0,prompt:"none",redirect_uri:window.location.origin,resource:Object(A.i)(),response_mode:"form_post",response_type:"token",state:t};Object(_.a)().setItem(Se,t);var n=new pe.a("Auth.DetectUserLoggedInAAD");n.start(),window.formDetectUserLoggedInAADCallback=function(t){n.end({resultType:t?"ExpectedFailure":"Success"}),Object(Oe.e)(!1),Object(Oe.f)(!t)};var r=Object(A.b)()+"common/oauth2/authorize?"+jQuery.param(e);$("body").append('<iframe id="detectAADAuthFrame" style="display:none;" src='+r+"><iframe>")}();var n=window.setInterval((function(){if(!Object(Oe.a)())if(window.clearInterval(n),Object(Oe.b)())if(e)t.resolve();else{setTimeout(P.d,2e3)}else t.reject()}),100);return t.promise()}var we="form.detectUserLoggedInAAD.",Se="officeforms.auth.state",Ie=n(64),Fe=n(45),ye=n(103),Ne=n(60);function ke(t){var e=$.Deferred();if(Object(Ot.a)().Flighting.isEnabled_Deprecated("EnableFormsProRoute")){var n=window.location.pathname;if(!t!=!n.toLowerCase().startsWith("/FormsPro".toLowerCase()))return n=t?"/FormsPro"+n:n.substring("/FormsPro".length),Object(P.e)(n),e.promise()}return e.resolve().promise()}var Te=n(97),Ce=n(55),Pe=n(107),xe=n(108),Me=n(8),Le=n(87),De=n(22),Re=n(24),Ee=n(70),Ae=n(83),_e=n(65),Ue=n(94),$e=n(118),Be=n(92),qe=n(79);var Qe=function(t){function e(e){var n=t.call(this,e)||this;return n.lf="#008272",n.state={IsRefreshing:!1},n}Object(h.c)(e,t);var n=e.prototype;return n.componentDidMount=function(){De.a.logData({name:"ResponsePage.PollResultView.Navigate"})},n.componentDidUpdate=function(){var t=ge.findDOMNode(this.refs["vote-detail"]);t&&t.focus()},n.render=function(){var t=this,e=Object(qe.a)({HTMLAttributes:{className:"poll-top-view-back-button light-background-button",onClick:function(){return t.props.submitAnother()}},Icon:"Back",IconClassName:"poll-top-view-back-icon forms-icon-size16x16",Text:Object(L.a)().Response_Poll_Result_Back,TextClassName:"poll-top-view-back-text"});return ie.createElement("div",{className:"office-poll-result-container"},ie.createElement("div",{className:"office-poll office-form office-form-theme-shadow office-poll-info-container",role:"main"},ie.createElement("div",{className:"office-poll-title-container office-form-theme-primary-background"},e),ie.createElement("div",{className:"poll-result-container office-form-padding-align"},this.Fc(),this.hf(),ie.createElement("div",{className:"office-form-info-other"},this.df()))),ie.createElement(Ue.a,{TopExtraContent:this.mf()}))},n.Fc=function(){var t=this.props.Form;return ie.createElement("div",{className:"office-form-question-title"},t.Model.Questions[0]&&t.Model.Questions[0].Title)},n.hf=function(){var t=this,e=this.props.Form,n=e.Model.Questions[0].ChoiceType===Xt.a.MultiChoice,r=e.Model.Questions[0].AllowOtherAnswer,i=v.map(e.Model.Questions[0].Choices,(function(t){return{option:t.Description,voteCount:0,names:[],voted:!1}}));r&&i.push({option:"Other",voteCount:0,names:[],otherOptions:[],voted:!1}),v.each(e.Model.Responses,(function(t){var e=t.Answers,o=[];n?v.each(Object(R.u)(e[0].Answer),(function(t){return o.push(t)})):o.push(e[0].Answer);var c=t.ResponderName||t.Responder||Object(L.a)().Response_Poll_Result_Anonymous;c&&v.each(o,(function(t){var e=v.findIndex(i,(function(e){return e.option===t}));r&&-1===e&&(e=i.length-1),-1!==e&&(i[e].voteCount+=1,i[e].names.push(c),"otherOptions"in i[e]&&i[e].otherOptions.push(t),c===Object(a.a)().userInfo.Email&&(i[e].voted=!0))}))})),i.sort((function(t,e){return e.voteCount-t.voteCount}));var o=v.first(i).voteCount,c=i.map((function(e,n){var r=e.voteCount||0,i=0===o?0:80*r/o,c=String(i)+"%",s=String(100-i)+"%",u=ie.createElement("span",{className:"office-poll-vote-count-container"},ie.createElement("span",{className:"poll-result-vote-count"},Object(L.a)().Response_Poll_Result_VoteCount.format(r))),a=ie.createElement("div",{className:"poll-result-progressbar-container"},ie.createElement("div",{className:"poll-result-progressbar-cell",style:{width:c}},ie.createElement("a",{className:"poll-result-progressbar",style:{backgroundColor:t.lf}})),ie.createElement("div",{className:"poll-result-progressbar-cell",style:{width:s}},ie.createElement("a",{className:"poll-result-progressbar"})));return ie.createElement("div",{className:"poll-result-option-container",key:e.option},ie.createElement("div",null,e.option,e.voted?ie.createElement("span",{className:"poll-result-voted"},Object(L.a)().Response_Poll_Voted):void 0,u),a)}));return ie.createElement("div",{className:"poll-result-options-container"},c)},n.df=function(){var t=this;return ie.createElement("div",{className:"poll-result-refresh-link"},ie.createElement("a",{className:"office-form-info-reload office-form-info-children",href:"javascript:void(0)",onClick:function(){var e=t.props.Form;t.setState({IsRefreshing:!0}),$.when(e.ensureFieldsReady([Jt.a.Schema.Questions,Jt.a.Schema.DescriptiveElements,Jt.a.Schema.Responses]),e.syncRuntimeResponses()).then((function(){t.setState({IsRefreshing:!1})}))}},Object(L.a)().Response_Poll_Result_Refresh),this.Vi())},n.mf=function(){var t=this;if(!Object(Fe.d)()){var e={className:"office-form-info-premotion office-form-info-children",href:"DesignPage.aspx",onClick:function(){return t.props.beforePromotion&&t.props.beforePromotion(),!0}};return(Object(R.m)()||Object(R.n)()||Object(ht.c)())&&(e.href="javascript:void(0)",e.onClick=function(){t.props.beforePromotion&&t.props.beforePromotion();var e=Object(R.e)(),n=Object(ht.c)()?"../Pages/DesignPage.aspx":"../Pages/DesignPage.aspx?"+jQuery.param(e);return Object(ye.a)(Object(C.a)(n)),!0}),ie.createElement("div",null,ie.createElement("a",e,Object(L.a)().Renderer_PromotionMessage))}},n.Vi=function(){if(this.state.IsRefreshing)return ie.createElement("div",{className:"poll-submit-spinner"},ie.createElement("div",{className:"spinner-tile-animation"}))},e}(oe.a),ze=n(43);function He(t){return ie.createElement(Je,t)}var Ve,Ge,We,Je=function(t){function e(e){var n=t.call(this,e)||this;return n.bf=function(){return n.Er()},n.state={IsSmallScreen:$(window).width()<768,SubmitState:"DetailResult"===Object(C.c)().view?3:0,ShowErrorPage:!1,ResponderEmail:Object(a.a)().userInfo.Email},n}Object(h.c)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.Ee=new Le.a(this.props.Master),this.Xr(),window.addEventListener("resize",this.bf)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.bf)},n.render=function(){var t,e=this;if(this.state.ShowErrorPage)return Object(Te.a)({Error:this.vf,FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var n,r={className:"office-poll office-form-content office-form-page-padding"};if((this.props.ViewMode===ze.a.Mobile||this.state.IsSmallScreen)&&(r.className=Object(Me.a)(r.className,"small-screen")),this.Xs()&&(r.className=Object(Me.a)(r.className,"mobile-view")),3===this.state.SubmitState){var i=void 0;this.props.Master.Model.Settings.RequiresUniqueResponse||(i=function(){return e.li()}),n={ShowPromotionMessage:!0,submitAnother:i,beforePromotion:function(){De.a.logData({name:"ResponsePage.PollResultView.NavigateToPortal"})},Form:this.props.Master},t=ie.createElement(Qe,n)}else t=ie.createElement("div",null,ie.createElement("div",{"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.Ie(),ie.createElement("div",{className:"office-form-body"},this.mi(),ie.createElement("div",null,this.Ei()),this.gf(),this.ji(),this.pf(),this.Si(),this.Ii())),ie.createElement(Ue.a,{FormMaster:this.props.Master,FooterType:"ShowStatementWithNotice",FooterText:!1}));return ie.createElement("div",{className:"form-content-container"},ie.createElement("div",r,ie.createElement(Be.a,{ThemeMaster:this.props.Master.ThemeMaster}),t))},n.mi=function(){return ie.createElement("div",{className:"office-form-notice-container"},this.Ai(),this._i())},n.Ai=function(){var t=this.props.Master.Model.Settings;if(!t.IsAnonymous&&!t.NotRecordIdentity){var e=Object(a.a)().userInfo.GivenName;return ie.createElement("div",{},ie.createElement("span",{className:"office-form-notice-long-text"},Object(L.a)().Response_NonAnonymous_Notice.format(e)))}},n._i=function(){return v.some(this.props.Master.Model.Questions,(function(t){return t.Required}))?ie.createElement("div",null,ie.createElement("span",{className:"office-form-required-notice-star"}),ie.createElement("span",null,Object(L.a)().Answer_Required_Notice)):void 0},n.Si=function(){var t=this.Ee.getQuestionsWithWrongAnswer(this.Ee.TopQuestionRuntimeMasters()),e=t.map((function(t){return Object(L.a)().Form_QuestionWithOrdinal.format(t)})).join(Object(L.a)().Common_ItemSeperator),n=Object(L.a)().Form_Question_Error_Message.format(t.length,e),r=Object(Re.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),i=!!this.state.ShowValidationStyle&&!!t.length;return ie.createElement("div",{className:Object(Me.a)("office-form-submit-error",i?"":"NotVisible"),role:"alert"},r,ie.createElement("span",{className:"error-message"},i?n:""))},n.Ie=function(){return ie.createElement("div",{className:"office-poll-title-container office-form-theme-primary-background"})},n.Ei=function(){var t=this,e=this.state.ShowValidationStyle;return Et.a.convertToArray(this.Ee.Model.QuestionRuntimeMasters).map((function(n,r){var i=n.Question.Model.Id,o={Master:n,LocalizedStrings:Object(L.a)(),Ordinal:r+1,Disabled:!1,ExpandAll:!0,key:i,IsMobile:t.Xs(),ShowValidationStyle:e,ShowQuizResult:!1,HideMedia:!1,IsStudentViewMode:!1};return Object($e.a)(o)}))},n.Ii=function(){var t=Object(Re.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),e=2===this.state.SubmitState;return ie.createElement("div",{className:Object(Me.a)("office-form-submit-error",e?"":"NotVisible"),role:"alert"},t,ie.createElement("span",{className:"error-message"},e?this.state.ErrorMessage:""))},n.gf=function(){var t=this;return ie.createElement("div",{className:"design-question-choice-label"},ie.createElement("div",{className:"poll-email-label"},Object(L.a)().Response_Poll_Email_Label,ie.createElement("span",{className:"required-star"})),Object(Ae.a)({Value:this.state.ResponderEmail,AutoSelection:!0,Placeholder:Object(L.a)().Response_Poll_Email_Placeholder,HTMLAttributes:{className:"inline-display poll-email-textbox"},onValueChange:function(e){var n=!e||!e.trim();t.setState({ResponderEmail:e,ShowValidationStyle:n})}}),this.state.ShowValidationStyle?ie.createElement("div",{className:"poll-email-validation-error"},Object(Ee.a)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:Object(L.a)().Response_Poll_Email_ValidationError,Alert:!0})):void 0)},n.pf=function(){var t=this;return ie.createElement("span",{className:"poll-view-result-link"},ie.createElement("a",{className:"office-form-info-premotion office-form-info-children",href:"javascript:void(0)",onClick:function(){t.setState({SubmitState:1});var e=t.props.Master;$.when(e.ensureFieldsReady([Jt.a.Schema.Questions,Jt.a.Schema.DescriptiveElements,Jt.a.Schema.Responses]),e.syncRuntimeResponses()).then((function(){t.setState({SubmitState:3})}))}},Object(L.a)().Response_Poll_ViewResult),this.Vi())},n.ji=function(){var t=this,e=1===this.state.SubmitState;return ie.createElement("div",{className:"office-form-bottom-button-div"},Object(_e.b)({HTMLAttributes:{className:"office-poll-submit-button office-form-theme-primary-background",disabled:e,onClick:function(){t.Of();var e=t.props.Master.Model,n=t.Ee.Answers?Et.a.convertToArray(t.Ee.Answers):[];De.a.logData({name:"ResponsePage.Form.Submit",extraData:{isPoll:!0,allQuestionCount:e.Questions.length,allAnswersLength:v.reduce(n,(function(t,e){return t+(e&&e.Answer?JSON.stringify(e.Answer).length:0)}),0)}})}},ButtonStyle:"LightBackground",Text:Object(L.a)().Response_Poll_VoteButtonText}))},n.Vi=function(){if(1===this.state.SubmitState)return ie.createElement("div",{className:"poll-submit-spinner"},ie.createElement("div",{className:"spinner-tile-animation"}))},n.jf=function(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)},n.Of=function(){var t=this;if(this.Ee.getQuestionsWithWrongAnswer(this.Ee.TopQuestionRuntimeMasters()).length>0)this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError);else if(this.state.ResponderEmail&&this.state.ResponderEmail.trim()&&this.jf(this.state.ResponderEmail.trim())){this.setState({SubmitState:1});var n={StartDate:this.Gn,SubmitDate:new Date,Answers:this.Ee.Answers,Responder:this.state.ResponderEmail,ResponderName:this.state.ResponderEmail},r=this.props.Master;r.submitResponse(n).done((function(e){$.when(r.ensureFieldsReady([Jt.a.Schema.Questions,Jt.a.Schema.DescriptiveElements,Jt.a.Schema.Responses]),r.syncRuntimeResponses()).then((function(){t.setState({SubmitState:3,ErrorMessage:void 0})}))})).fail((function(e){var n=Object(L.a)(),r="";if(e.innerCode){if(r=Object(xe.a)(""+e.innerCode)||n.Error_Inline_DefaultMessage,5e3===e.innerCode){var i="";if(Object(f.b)("FormCustomizedMessage"))i=e.customizedMessage;else{var o=e.innerMessage.indexOf("Inner Message:");-1!==o&&(i=e.innerMessage.substring(o+"Inner Message:".length,e.innerMessage.length).trim())}r=n.Error_Message_5000_title.format(i)}10001===e.innerCode&&(r=n.Error_Inline_RefreshMessage),631!==e.innerCode&&6503!==e.innerCode||(r=n.Error_Inline_DelayTryMessage)}t.setState({SubmitState:2,ErrorMessage:r}),5e3===e.innerCode&&(r=Object(L.a)().Error_Message_FormClosed),De.a.logData({name:Object(d.a)(e)?"Error.InlineError.ShowAtSubmitResponse.Expected":"Error.InlineError.ShowAtSubmitResponse.Unexpected",extraData:{Error:Object(d.c)(e),ErrorMessage:r||void 0},correlationId:e&&e.correlationId})}))}else this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError)},n.li=function(){De.a.logData({name:"ResponsePage.PollResultView.SubmitAnother"}),this.Xr(),this.Ee.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,SubmitState:0},e.scrollToTop)},n.Xr=function(t){this.Gn=new Date,this.Ee.Answers=t||[]},n.Xs=function(){switch(this.props.ViewMode){case ze.a.Desktop:return!1;case ze.a.Mobile:return!0;case ze.a.Auto:return Object(R.k)();default:throw Error("unknown view mode")}},n.Er=function(){$(window).width()<=768!==this.state.IsSmallScreen&&this.setState({IsSmallScreen:!this.state.IsSmallScreen})},e.scrollToTop=function(){Object(Me.h)($(".office-form-form-title"),$(".office-form-content"),void 0,void 0,!0)},e.scrollToShowSubmitError=function(){Object(Me.h)($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},e}(oe.a),Ke=(n(123),function(){function t(t,e){void 0===e&&(e=!0),this.wf=e?Object(_.b)():Object(_.c)(),this.To=t}var e=t.prototype;return e.Sf=function(){return t.KeyPrefix_AnswerMap+this.To+"."+Object(a.a)().userInfo.UserId},Object.defineProperty(e,"Answers",{get:function(){var t=this.wf.getItem(this.Sf());if(t){var e=JSON.parse(t);return Array.isArray(e)?e:void(this.Answers=void 0)}},set:function(t){t?this.wf.setItem(this.Sf(),JSON.stringify(t)):this.wf.removeItem(this.Sf())},enumerable:!0,configurable:!0}),e.If=function(){return t.KeyPrefix_ActiveSection+this.To+"."+Object(a.a)().userInfo.UserId},Object.defineProperty(e,"SectionId",{get:function(){var t=this.If();return this.wf.getItem(t)||null},set:function(t){var e=this.If();t?this.wf.setItem(e,t):this.wf.removeItem(e)},enumerable:!0,configurable:!0}),t.KeyPrefix_AnswerMap="officeforms.answermap.",t.KeyPrefix_ActiveSection="officeforms.activesection",t}());function Xe(t,e,n,r,i,o){var c=t.Model.Id;Object(dt.g)((function(){return c})),Object(dt.f)((function(){return t}));Object(gt.b)();var s,u,h,d=Object(l.b)("loadForm",e()),m=i;if(m||(m=Object(l.b)("responseStrings",Object(L.c)())),n?(s=Object(a.a)().useDebugVersionScript?["BootStrap","JQuery_RateIt","Linkify","Linkify_JQuery","JQuery_Picker","JQuery_Picker_Date"]:["combined-response"],u=Object(l.b)("scripts",Object(qt.b)(s))):u=$.Deferred().resolve().promise(),m.fail((function(t){Object(Ne.a)({message:"LoadLocalizedStrings failure, error: "+(t&&t.message)})})).done((function(){return S("resourceStringLoaded",Object(g.b)())})),u.fail((function(t){Object(Ne.a)({message:"LoadDependencies failure, error: "+(t&&t.message)})})).done((function(){return S("otherJsLoaded",Object(g.b)())})),Object(f.b)("RetryTransientFailure")){h=window.setTimeout((function(){Object(Ot.a)().RetryingRecoverableError&&$(".page-loading-messagebox").append("<div>"+Object(L.a)().RetryRecoverableErrorMessage_OpeningForm+"</div>")}),1e4)}d.fail(en).fail((function(){})).done((function(){return S("formApiFinished",Object(g.b)())})).then((function(){return ke("survey"===t.Model.Type)})).then((function(){return function(t){Object(Ne.b)(t);var e=t.SyncContext===he.a.SharedTimeForm;if(function(t){if(!Object(f.b)("ResponseInApp")||!t.Model.Settings.RespondInAppOnly)return!1;var e=!1;if(void 0===window.browser){if(Object(R.t)()){Object(ye.a)("ms-edu-secureassessment:".concat(window.location.href).concat("!enforceLockdown"),"_self","directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no"),Ye(!1,Error(Object(L.a)().TakeATest_Win10),"Information")}else Ye(!1,Error(Object(L.a)().TakeATest_NotWin10),"Information");e=!0}else De.a.logData({name:"ResponsePage.Form.OpenInTakeATest"});return e}(t))return $.Deferred().reject();var n=Object(ht.k)()||Object(ht.h)()||Object(R.n)();if(window.parent!==window&&!n&&(window.innerWidth<320||window.innerHeight<320||Object(R.f)()))return De.a.logData({name:"ResponsePage.EmbedView.BlockEmbed",extraData:{iFrameWidth:window.innerWidth,iFrameHeight:window.innerHeight,isAndroid:Object(R.f)()}}),Ze(),$.Deferred().reject();if(document.title=Object(jt.c)((function(){return t.Model.Title}),jt.e),e)De.a.logData({name:"ShareFormPage.Copy.Navigate"});else if(Object(f.b)("ProgressBar")&&t.isFieldReady(Jt.a.Schema.ProgressBarEnabled)){var r=!!t.Model.ProgressBarEnabled&&"true"===t.Model.ProgressBarEnabled;r=t.FormElementManager.SectionMasters.length>1&&r,De.a.logData({name:"ResponsePage.Form.Navigate",extraData:{IsProgressBarVisible:r}})}else De.a.logData({name:"ResponsePage.Form.Navigate"})}(t)})).then((function(){return!o&&function(t){var e=$.Deferred();t.SettingMaster.Model.IsAnonymous||Object(a.a)().userInfo.UserId?e.resolve():(De.a.logData({name:"Auth.NoUserInfoForNonanonymousForm"}),Object(P.d)());return e.promise()}(t)})).then((function(){return function(t){var e=Object(C.c)().rid;return null!=e?t.getRuntimeResponse(e).then((function(t){return[t]})):t.Model.Settings.IsQuizMode&&t.SyncContext===he.a.ResponseTimeForm?Object(l.b)("releasedResponses",t.getReleasedResponsesByResponder(Object(a.a)().userInfo.Email)).done((function(){return S("responseApiFinished",Object(g.b)())})):$.Deferred().resolve().promise()}(t).fail(en)})).done((function(e){$.when(m,u).done((function(){Object(l.a)(),function(t){if(t&&t.Model.Questions){var e=t.Model.Questions,n={};v.forEach(e,(function(t){var e=t.Type;e&&(e=e.substr(e.indexOf(".")+1),n[e]?n[e]++:n[e]=1)})),n.Total=e.length,S("questionCount",n)}}(t),t.Model.LocaleList.length&&t.Synchronizer.setFieldsQueryJob([Jt.a.Schema.LocalizedResources],$.Deferred().resolve({localizedResources:[]}).promise()),e&&e.length?function(t,e,n){null!=Object(C.c)().rid?De.a.logData({name:"ResponsePage.ViewResultView.Navigate"}):De.a.logData({name:"ResponsePage.StudentView.Navigate"});var r=t[t.length-1],i=null;Object(f.c)()&&(i=Rt.a.Resolve("IIncrementalQuestionLoader"));var o={Master:e,ViewMode:ze.a.Auto,Response:r,PhishingReviewUXFactory:n,IncrementalQuestionLoader:i};tn(Object(Pe.b)(o))}(e,t,r):function(t,e,n,r){var i=!t.Model.Settings.IsAnonymous,o=new Ke(t.Model.Id,i),c={PersistedAnswers:o.Answers,PrintView:n,PersistedSectionId:o.SectionId,Master:t,DisableSubmitButton:!1,ViewMode:ze.a.Auto,persistAnswer:function(e){Object(jt.c)((function(){o.Answers=e}),jt.e),t.SyncContext===he.a.ResponseTimeForm&&(window.onbeforeunload=e?function(){return""}:null)},persistSectionId:function(t){Object(jt.c)((function(){o.SectionId=t}),jt.e)},ForcedLocaleId:r,PhishingReviewUXFactory:e};Object(Ie.b)(t.Model.Category,Ie.a.ResponsePagePollView)?"DetailResult"===Object(C.c)().view?$.when(t.ensureFieldsReady([Jt.a.Schema.Questions,Jt.a.Schema.DescriptiveElements,Jt.a.Schema.Responses]),t.syncRuntimeResponses()).then((function(){Object(jt.c)((function(){return tn(He(c))}),jt.e)}),en):Object(jt.c)((function(){return tn(He(c))}),jt.e):Object(jt.c)((function(){return tn(Object(Pe.b)(c))}),jt.e)}(t,r),Object(Fe.e)()&&function t(e){e.Synchronizer.query(Object(Ce.d)()).done((function(){setTimeout((function(){return t(e)}),1e4)})).fail((function(){setTimeout((function(){return t(e)}),1e4)}))}(t),Object(N.b)()}))})),$.when(u,m,d).always((function(){Object(f.b)("RetryTransientFailure")&&(window.clearTimeout(h),Object(Ot.a)().RetryingRecoverableError=!1)})),de($.when(u,m,d),"ResponsePage_Load")}function Ye(t,e,n){void 0===t&&(t=!0),Object(L.c)().done((function(){var r=Object(Te.a)({Error:e,ErrorType:n,FormId:Object(C.c)().id,IsResponsePage:!0,ShowCreateFormLink:t});Object(jt.d)(),Object(R.n)()&&t?ge.render(ie.createElement("div",{className:"embed-view-spo"},ie.createElement(Be.a),r),document.getElementById("content-root")):ge.render(r,document.getElementById("content-root")),Object(N.b)(e)}))}function Ze(){Object(L.c)().done((function(){De.a.logData({name:"ResponsePage.EmbedView.Navigate"});var t=Object(R.n)()?"embed-view office-form-theme-primary-background":"embed-view",e=ie.createElement("div",{className:t},ie.createElement("div",{className:"embed-view-container"},Object(Re.b)({HTMLAttributes:{className:"embed-view-icon"},IconName:"OfficeFormsLogo"}),ie.createElement("span",{className:"embed-view-content"},Object(L.a)().Page_Title),ie.createElement("a",{className:"embed-view-content",onClick:function(){De.a.logData({name:"ResponsePage.EmbedView.OpenInBrowser"});var t=Object(R.e)(),e=window.location.pathname+"?";Object(jt.c)((function(){e+=jQuery.param(t)}),jt.e),Object(ye.a)(Object(C.a)(e),"_blank","toolbar=yes, menubar=yes")}},Object(L.a)().EmbedPage_Link)));Object(R.n)()&&(e=ie.createElement("div",{className:"embed-view-spo"},ie.createElement(Be.a),e)),Object(jt.d)(),ge.render(e,document.getElementById("content-root"))}))}function tn(t){var e;e=Object(R.n)()?"office-form-theme-page-background office-form-spo-embed":"office-form-theme-page-background",Object(jt.d)(),F("forms.boot.render.rf.start"),ge.render(ie.createElement("div",{id:"form-container",className:e},ie.createElement("div",{className:"form-content"},t)),document.getElementById("content-root")),y(j.FP_RenderResponseForm,"forms.boot.render.rf.start"),function(){var t=!0;if(Object(f.c)()){var e=Rt.a.Resolve("IIncrementalQuestionLoader");e.isInitializedWithFormData()&&(e.onFirstRenderCompleted(),t=!1)}t&&Rt.a.Resolve("IBootEvent").raiseBootComplete()}()}function en(t){if(t)switch(Object(Ne.a)(t),t.innerCode){case 639:var e=Object(C.d)(window.location.href,"id",t.innerMessage);e!==window.location.href&&Object(P.c)(e);break;case 5e3:Ye(!0,t);break;case 10001:De.a.logData({name:"ResponsePage.EmbedView.NeedAuth"}),je().done((function(){setTimeout((function(){Object(Ot.a)().AuthContext.signIn().then(P.b)}))})).fail(Ze);break;case 15001:Ye(!1,t);break;default:Ye(!0,t)}else Ye(!0,null,"Error")}function nn(){return Object(f.b)("PrefetchForm")&&(!Object(R.m)()||Object(f.b)("PrefetchFormAuthFix"))}Object(f.d)(he.a.ResponseTimeForm),Rt.a.Register("IPageContext").UsingSingleton((function(){return new lt(Ve)})),Rt.a.Register("IAWTLogger").UsingSingleton((function(){return new yt})),Rt.a.Register("ILogger").UsingSingleton((function(){return new xt})),Rt.a.Register("IMixin").UsingSingleton((function(){return new re})),Rt.a.Register("IFormApiMixin").UsingSingleton((function(){return new Ht})),Rt.a.Register("IRatingStarsFactory").UsingSingleton((function(){return new se})),(Ge=new ae).addBootCompleteListener(le),Rt.a.Register("IBootEvent").UsingSingleton((function(){return Ge})),function(){if(Object(f.a)()){var t=new Promise((function(t,e){Rt.a.Resolve("IBootEvent").addBootCompleteListener((function(){Object(qt.a)("combined-response").then(t,e)}))})),e=function(){return t};Rt.a.Register("IThirdPartyRateIt").UsingSingleton(e),Rt.a.Register("IThirdPartyLinkify").UsingSingleton(e),Rt.a.Register("IThirdPartyDateTimePicker").UsingSingleton(e)}else!function(){var t=Promise.resolve($),e=function(){return t};Rt.a.Register("IThirdPartyRateIt").UsingSingleton(e),Rt.a.Register("IThirdPartyLinkify").UsingSingleton(e),Rt.a.Register("IThirdPartyDateTimePicker").UsingSingleton(e)}()}(),Rt.a.Register("IIncrementalLoadStrategy").UsingSingleton((function(){return new _t(Rt.a.Resolve("IBootEvent"))})),Rt.a.Register("IIncrementalQuestionLoader").UsingSingleton((function(){return new $t(Rt.a.Resolve("IIncrementalLoadStrategy"))})),Object(Ot.a)().setFlightsBasingOnAuth_Deprecated(Object(a.a)().flights),Object(kt.c)(),(We=Object(l.b)("pre-auth",Object(Ot.a)().AuthContext.handleAuthForContentPage(!1))).done((function(){S("authEnd",Object(g.b)()),Object(N.a)({eventName:"session_start",eventType:"session_start"}),F("forms.boot.create.fm.start");var t,e,n=(t=Object(C.c)().id,e=Object(Qt.a)(t),new(Object(Ut.j)())(he.a.ResponseTimeForm,{ExistingInDataSource:!0,InitialData:{Id:t,OwnerId:e.OwnerId,OwnerTenantId:e.OrgId,TableId:e.TableId}},e.IsGroupOwner,!1,null,Object(f.c)()&&Rt.a.Resolve("IIncrementalQuestionLoader")));if(y(j.FP_CreateFormMaster,"forms.boot.create.fm.start"),Xe(n,(function(){return function(t){return nn()?new M(t,"ResponseForm.Get",Rt.a,Object(f.c)()).getPromise():t.ensureReadyToResponse()}(n)}),!Object(f.b)("ReduceLibJsSize")&&!Object(f.a)(),new ve,function(){if(nn())return(new D).getPromise()}()),Object(C.c)().qrcode&&Object(N.a)({eventName:"ResponsePage.Form.QRCode",eventType:"engagement_event"}),Object(C.c)().nocdn&&Object(N.a)({eventName:"ResponsePage.CdnFallback",eventType:"error_event"}),Object(R.m)()){var r=Object(C.c)().platform,i=Object(C.c)().host,o=void 0;(r||i)&&(o={host:i,platform:r}),Object(N.a)({eventName:"ResponsePage.EmbedView.IsEmbeddedSession",eventType:"engagement_event",extraData:o})}})).fail((function(t){Ye(!1,t)})),de(We,"ResponsePage_HandleAuth")}]);